"use strict";var _=Object.defineProperty;var o=(t,n)=>_(t,"name",{value:n,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),x=require("../../_hooks/useNamespace/index.cjs"),C=require("../types/index.cjs"),g=require("../../_constants/prviewType/index.cjs"),h=require("../../_utils/check/index.cjs"),v=e.defineComponent({name:"LSDocx"}),k=e.defineComponent({...v,props:C.docxProps,emits:g.previewEmits,setup(t,{emit:n}){const s=x.useNamespace("docx"),i=s.b(),l=o(()=>Promise.resolve().then(()=>require("../../../../../node_modules/.pnpm/docx-preview@0.3.2/node_modules/docx-preview/dist/docx-preview/index.cjs")),"docxPromise"),c=t,a=n,u=e.ref();e.watch(()=>c.source,r=>{d(r)},{immediate:!0,deep:!0});async function d(r){if(!r||!h.isArrayBuffer(r))return;(await l()).renderAsync(r,u.value,u.value,{className:"docx",inWrapper:!0,ignoreWidth:!1,ignoreHeight:!0,ignoreFonts:!1,breakPages:!0,ignoreLastRenderedPageBreak:!0,experimental:!1,trimXmlDeclaration:!0,useBase64URL:!1,renderChanges:!1,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,debug:!1}).then(()=>{a("loadComplete")}).catch(()=>{a("loadError")})}o(d,"updateDocx");const m=o(()=>{c.onClose&&c.onClose(),a("update:source",[])},"closeFunc");return(r,p)=>{const f=e.resolveComponent("LSIcon");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(i))},[e.createElementVNode("span",{class:e.normalizeClass([e.unref(s).e("btn"),e.unref(s).e("close")]),onClick:m},[e.createVNode(f,{name:"Close",size:24,color:"#FFF"})],2),e.createElementVNode("div",{ref_key:"docxRef",ref:u},null,512)],2)}}});exports.default=k;
