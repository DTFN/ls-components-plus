"use strict";var x=Object.defineProperty;var n=(p,T)=>x(p,"name",{value:T,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});;/* empty css                                                                                                                                            */;/* empty css                                                                                                                                                */;/* empty css                                                                                                                                                     */;/* empty css                                                                                                                                                  */;/* empty css                                                                                                                                              */;/* empty css                                                                                                                                               */;/* empty css                                                                                                                                              */;/* empty css                                                                                                                                                    */;/* empty css                                                                                                                                                */;/* empty css                                                                                                                                           */const e=require("vue"),_=,/* empty css                                    */r=require("element-plus"),ee=,/* empty css               */te=,/* empty css                          */le=,/* empty css                            */ae=,/* empty css                                 */oe=,/* empty css                                                                                                                                            */ne=,/* empty css                                                                                                                                                 */ie=,/* empty css                                                                                                                                               */re={key:0,class:"animate_fadeIn transition-all-300 ls-list-wrap"},se={class:"flex items-center"},de=e.defineComponent({name:"LSList"}),ue=e.defineComponent({...de,props:ee.lsListProps,emits:["submitForm","handleLoading","handleCurrentPage","handlePageSize"],setup(p,{expose:T,emit:V}){const{jumpRouteCom:g,currentRouter:D}=ae.default(),t=p,h=V,v=e.useSlots(),C=e.ref(),E=e.ref(),N=e.computed(()=>Object.keys(v).filter(l=>l.toString().endsWith("-form-slot"))),A=e.computed(()=>Object.keys(v).filter(l=>l.toString().endsWith("-table-slot")));function P(l,a=!1){if(l){const i=l.toString().lastIndexOf(`${a?"-form-slot":"-table-slot"}`);return i!==-1?l.toString().slice(0,i):l}return""}n(P,"getSlotName");const{isFirst:B,loading:f,tableData:R,total:$,pageSize:c,currentPage:b,handleReset:q,loadData:w}=_.default(t.listApi,t.formData,{dealData:t==null?void 0:t.dealData,dealParams:t==null?void 0:t.dealParams,...t==null?void 0:t.listHookConfig});e.watch(f,l=>{h("handleLoading",l)}),e.watch(b,l=>{h("handleCurrentPage",l)}),e.watch(c,l=>{h("handlePageSize",l)});function L(l){h("submitForm",l),t!=null&&t.queryFn?t.queryFn(l):w()}n(L,"submitForm");function z(l){console.warn("resetForm",l),q()}n(z,"resetForm");const y=e.computed(()=>D?D.value.path:"");function O(){t!=null&&t.addFn?t.addFn():g({path:t!=null&&t.addRoutePath?t.addRoutePath:`${y.value}/add`},1)}n(O,"onAdd");function K(l,a){t!=null&&t.tableDetailFn?t.tableDetailFn(a):g({path:`${t!=null&&t.detailRoutePath?t.detailRoutePath:`${y.value}/detail`}/${l}`},1)}n(K,"onDetail");function H(l,a){t!=null&&t.tableEditFn?t.tableEditFn(a):g({path:`${t!=null&&t.editRoutePath?t.editRoutePath:`${y.value}/edit`}/${l}`},1)}n(H,"onEdit");const k=e.ref(void 0),m=e.ref(!1);function I(l,a){if(t.delApi){k.value=l,m.value=!0;let i=l;t!=null&&t.dealDelParams&&(i=t.dealDelParams(a)),t.delApi(i).then(()=>{r.ElMessage.success("删除成功"),w()}).catch(d=>{console.warn(d)}).finally(()=>{m.value=!1})}}n(I,"onDel");const F=e.ref(),S=e.ref(!1);function M(l,a,i){F.value=l;const d=n((u,o)=>{if(t.switchApi){S.value=!0;let s=l;t!=null&&t.dealSwitchParams&&(s=t.dealSwitchParams(i)),t.switchApi(s).then(()=>{w(!1),u(!0)}).catch(()=>{o(new Error("Error"))}).finally(()=>{S.value=!1})}else o(new Error("Error"))},"onSwitch");return new Promise((u,o)=>{a?r.ElMessageBox.confirm('<strong class="text-14px">请问是否关闭？</strong>',{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,customStyle:{width:"240px"}}).then(()=>{d(u,o)}).catch(()=>{o(new Error("Error"))}):d(u,o)})}n(M,"switchBeforeChange");function U(l){let a=!1;return t!=null&&t.disabledTableSwitch&&(typeof t.disabledTableSwitch=="boolean"?a=t.disabledTableSwitch:typeof t.disabledTableSwitch=="function"&&(a=t.disabledTableSwitch(l))),!!a}n(U,"disabledTableSwitch");function j(l){let a=!1;return t!=null&&t.showTableDetail&&(typeof t.showTableDetail=="boolean"?a=t.showTableDetail:typeof t.showTableDetail=="function"&&(a=t.showTableDetail(l))),!!a}n(j,"showTableDetail");function W(l){let a=!1;return t!=null&&t.disabledTableDetail&&(typeof t.disabledTableDetail=="boolean"?a=t.disabledTableDetail:typeof t.disabledTableDetail=="function"&&(a=t.disabledTableDetail(l))),!!a}n(W,"disabledTableDetail");function G(l){let a=!1;return t!=null&&t.showTableEdit&&(typeof t.showTableEdit=="boolean"?a=t.showTableEdit:typeof t.showTableEdit=="function"&&(a=t.showTableEdit(l))),!!a}n(G,"showTableEdit");function J(l){let a=!1;return t!=null&&t.disabledTableEdit&&(typeof t.disabledTableEdit=="boolean"?a=t.disabledTableEdit:typeof t.disabledTableEdit=="function"&&(a=t.disabledTableEdit(l))),!!a}n(J,"disabledTableEdit");function Q(l){let a=!1;return t!=null&&t.showTableDel&&(typeof t.showTableDel=="boolean"?a=t.showTableDel:typeof t.showTableDel=="function"&&(a=t.showTableDel(l))),!!a}n(Q,"showTableDel");function X(l){let a=!1;return t!=null&&t.disabledTableDel&&(typeof t.disabledTableDel=="boolean"?a=t.disabledTableDel:typeof t.disabledTableDel=="function"&&(a=t.disabledTableDel(l))),!!a}n(X,"disabledTableDel");const Y=e.h(r.ElDivider,{direction:"vertical"}),Z=e.computed(()=>t.showSkeleton?!B.value:!0);return T({loadData:w,handleReset:q,isFirst:B,loading:f,currentPage:b,pageSize:c,total:$,FormRef:C,TableRef:E}),(l,a)=>{const i=oe.ElTableColumn,d=ne.ElPopconfirm,u=ie.ElSkeleton;return e.unref(Z)?(e.openBlock(),e.createElementBlock("div",re,[l.showForm?(e.openBlock(),e.createBlock(te.default,e.mergeProps({key:0,ref_key:"FormRef",ref:C,class:["mb-6px ls-form-cpo",l.formClass],"label-position":"top","show-btn-loading":!1,colon:!1,inline:!0,"form-data":l.formData,"form-items":l.formItems,loading:e.unref(f),"confirm-text":"查询"},l.formAttrs,{onSubmit:L,onReset:z}),e.createSlots({default:e.withCtx(o=>[e.renderSlot(l.$slots,"form-append",e.normalizeProps(e.guardReactiveProps(o)),void 0,!0)]),_:2},[e.renderList(e.unref(N),o=>({name:P(o,!0),fn:e.withCtx(s=>[e.renderSlot(l.$slots,o,e.normalizeProps(e.guardReactiveProps(s)),void 0,!0)])}))]),1040,["class","form-data","form-items","loading"])):e.createCommentVNode("",!0),l.showOperate?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[l.$slots.operate?e.renderSlot(l.$slots,"operate",{key:0},void 0,!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[l.showOperateDivider?(e.openBlock(),e.createBlock(e.unref(r.ElDivider),{key:0,"border-style":"dashed"})):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["mt-24px flex items-center justify-start",l.operateClass])},[e.renderSlot(l.$slots,"operate-prepend",{},void 0,!0),l.showAdd?(e.openBlock(),e.createBlock(e.unref(r.ElButton),e.mergeProps({key:0,type:"primary",disabled:e.unref(f)||l.disabledAddBtn},l.addBtnAttrs,{onClick:O}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.addBtnText),1)]),_:1},16,["disabled"])):e.createCommentVNode("",!0),e.renderSlot(l.$slots,"operate-append",{},void 0,!0)],2)],64))],64)):e.createCommentVNode("",!0),e.createVNode(le.default,e.mergeProps({ref_key:"TableRef",ref:E,class:["ls-table-cpo",[l.showOperate?"mt-16px":"mt-24px"]],"show-overflow-tooltip":!0,loading:e.unref(f),total:e.unref($),"table-data":e.unref(R),"table-column":l.tableColumn,"current-page":e.unref(b),"onUpdate:currentPage":a[0]||(a[0]=o=>e.isRef(b)?b.value=o:null),"page-size":e.unref(c),"onUpdate:pageSize":a[1]||(a[1]=o=>e.isRef(c)?c.value=o:null)},l.tableAttrs,e.toHandlers(l.tableListeners||{})),e.createSlots({default:e.withCtx(()=>[l.showTableSwitch?(e.openBlock(),e.createBlock(i,e.mergeProps({key:0,prop:l.switchProp,label:"是否开启",width:"100"},l.tableSwitchColumn),{default:e.withCtx(({row:o})=>[e.createVNode(e.unref(r.ElSwitch),{class:"ls-list-table__switch","model-value":o[l.switchProp]?1:0,"active-value":1,"inactive-value":0,loading:e.unref(S)&&o[l.tableRowKey]===e.unref(F),"before-change":n(()=>M(o[l.tableRowKey],o[l.switchProp],o),"before-change"),disabled:U(o)},null,8,["model-value","loading","before-change","disabled"])]),_:1},16,["prop"])):e.createCommentVNode("",!0),l.showTableOperate?(e.openBlock(),e.createBlock(i,e.mergeProps({key:1,fixed:"right",prop:"operate",label:"操作","show-overflow-tooltip":!1},l.tableOperateColumn),{default:e.withCtx(({row:o})=>[e.createElementVNode("div",se,[e.createVNode(e.unref(r.ElSpace),{size:0,spacer:e.unref(Y)},{default:e.withCtx(()=>[e.renderSlot(l.$slots,"table-operate-prepend",{row:o},void 0,!0),j(o)?(e.openBlock(),e.createBlock(e.unref(r.ElButton),{key:0,disabled:W(o),link:"",type:"primary",onClick:n(s=>K(o[l.tableRowKey],o),"onClick")},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.tableDetailText||"查看"),1)]),_:2},1032,["disabled","onClick"])):e.createCommentVNode("",!0),G(o)?(e.openBlock(),e.createBlock(e.unref(r.ElButton),{key:1,disabled:J(o),link:"",type:"primary",onClick:n(s=>H(o[l.tableRowKey],o),"onClick")},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.tableEditText||"编辑"),1)]),_:2},1032,["disabled","onClick"])):e.createCommentVNode("",!0),Q(o)?(e.openBlock(),e.createBlock(d,{key:2,"hide-icon":"",placement:"top",width:"180","confirm-button-text":"确认","cancel-button-text":"取消",title:`是否${l.tableDelText||"删除"}当前列数据？`,onConfirm:n(s=>I(o[l.tableRowKey],o),"onConfirm")},{reference:e.withCtx(()=>[e.createVNode(e.unref(r.ElButton),{link:"",type:"danger",disabled:e.unref(m)||X(o),loading:e.unref(m)&&e.unref(k)===o[l.tableRowKey]},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(m)&&e.unref(k)===o[l.tableRowKey]?"":l.tableDelText||"删除"),1)]),_:2},1032,["disabled","loading"])]),_:2},1032,["title","onConfirm"])):e.createCommentVNode("",!0),e.renderSlot(l.$slots,"table-operate-append",{row:o},void 0,!0)]),_:2},1032,["spacer"])])]),_:3},16)):e.createCommentVNode("",!0),e.renderSlot(l.$slots,"table-append",{tableData:e.unref(R)},void 0,!0)]),_:2},[e.renderList(e.unref(A),o=>({name:P(o,!1),fn:e.withCtx(s=>[e.renderSlot(l.$slots,o,e.normalizeProps(e.guardReactiveProps(s)),void 0,!0)])}))]),1040,["class","loading","total","table-data","table-column","current-page","page-size"])])):(e.openBlock(),e.createBlock(u,e.mergeProps({key:1,rows:5,animated:""},l.skeletonAttrs),null,16))}}});exports.default=ue;
