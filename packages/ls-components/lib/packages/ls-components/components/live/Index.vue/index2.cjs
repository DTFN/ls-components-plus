"use strict";var q=Object.defineProperty;var i=(f,p)=>q(f,"name",{value:p,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),A=,/* empty css                                */d=,/* empty css                                                                                  */C=;/* empty css               */;/* empty css                                                                                                                                            */;/* empty css                                                                                                                                             */;/* empty css                                                                                                                                               */const M=,/* empty css                                                                                                                                              */P=["autoplay","controls","muted"],g=e.defineComponent({name:"LSLive"}),R=e.defineComponent({...g,props:C.lsLiveProps,setup(f,{expose:p}){const s=f,L=e.useAttrs(),S=A.useNamespace("live").b(),l=e.ref(""),n=e.ref(0),t=e.ref(null),o=e.ref(),y=e.ref({autoplay:!1,controls:!0,muted:!0}),v=e.ref(L.autoplay==null?!0:L.autoplay),m=e.computed(()=>s.type==="flv");function _(){var u,a,r,E;n.value=0,t.value&&((u=t.value)==null||u.pause(),(a=t.value)==null||a.unload(),(r=t.value)==null||r.detachMediaElement(),(E=t.value)==null||E.destroy(),t.value=null)}i(_,"destoryPlayer");function b(){v.value&&t.value&&m.value&&(t.value.on(d.default.Events.ERROR,()=>{l.value&&c(l.value)}),t.value.on(d.default.Events.STATISTICS_INFO,function(u){const{decodedFrames:a}=u||{};if(n.value===0){n.value=a;return}n.value!=a?n.value=a:l.value&&c(l.value)}))}i(b,"listenPlayer");async function c(u){var a,r;_(),d.default.isSupported()&&u?(l.value=u,t.value=d.default.createPlayer({type:s.type,isLive:s.isLive,hasAudio:s.hasAudio,hasVideo:s.hasVideo,url:u},{autoCleanupSourceBuffer:!0,enableWorker:!1,enableStashBuffer:!0,isLive:s.isLive,lazyLoad:!1}),t.value&&o.value&&(t.value.attachMediaElement(o.value),t.value.load(),v.value?(a=t.value)==null||a.play():(r=t.value)==null||r.pause(),b())):M.ElMessage.error("不支持播放视频")}i(c,"createPlayer");function h(){document.visibilityState==="visible"?l.value&&m.value&&c(l.value):m.value&&_()}return i(h,"updateVisibilityStatus"),e.onMounted(()=>{document.addEventListener("visibilitychange",h),o.value.addEventListener("play",()=>{v.value=!0}),o.value.addEventListener("pause",()=>{v.value=!1})}),e.onUnmounted(()=>{document.removeEventListener("visibilitychange",h)}),p({createPlayer:c}),(u,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(S))},[e.createElementVNode("video",{autoplay:e.unref(y).autoplay,controls:e.unref(y).controls,muted:e.unref(y).muted,width:"100%",class:"ls-video",ref_key:"lsLiveRef",ref:o},null,8,P)],2))}});exports.default=R;
