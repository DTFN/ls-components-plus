"use strict";var x=Object.defineProperty;var u=(c,v)=>x(c,"name",{value:v,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const A=require("../useDelayLoader/index.cjs"),t=require("vue");function E(c,v,M){const{currentPageProp:N=1,pageSizeProp:R=10,isDelayLoader:y=!1,delayLoaderTime:q=300,isFullDose:P=!1,autoFetch:F=!0,hasPanigation:D=!0,dealParams:S,dealData:i,callbackAfter:h}=M||{},b=t.ref(!0),d=t.ref(!1),n=t.ref(N),r=t.ref(R),s=t.ref([]),T=t.ref([]),g=t.ref(0),w=u(e=>{if(D){if(P){let a=e||[],l=a.length;if(i&&typeof i=="function"){const{data:o,total:f=0}=i(e);a=o||[],l=Number(f||0)}T.value=a,g.value=l,m()}else if(i&&typeof i=="function"){const{data:a,total:l=0}=i(e);s.value=a||[],g.value=Number(l||0)}else{const{records:a=[],total:l}=e||{};s.value=a||[],g.value=Number(l)}h&&h(e,{tableData:s,total:g})}else s.value=e,h&&h(e,{})},"disposeResponseData"),z=u(()=>new Promise((e,a)=>{if(!c){a(new Error("requestFn is required"));return}const l=(typeof v=="function"?v():v)||{};let o={};D?o={currentPage:n.value,pageSize:r.value,...l}:o={...l},S&&(o=S(o)),c(o).then(f=>{y||w(f),e(f)}).catch(f=>{a(f)}).finally(()=>{d.value=!1,setTimeout(()=>{b.value=!1},400)})}),"requestData"),L=A.default(q||300,e=>{w(e)});function m(){s.value=T.value.slice((n.value-1)*r.value,n.value*r.value)}u(m,"sliceTableData");const p=u((e=!0,a=!1)=>{if(c&&!(e&&d.value)){if(e&&(d.value=!0),a&&(b.value=!0),y){L.loadData(z);return}z().finally(()=>{d.value=!1})}},"loadData"),k=u(e=>{n.value=e,P?m():p()},"handleCurrentPageChange"),C=u(e=>{r.value=e,n.value=1,P?m():p()},"handleSizeChange");t.watch(n,e=>{k(e)}),t.watch(r,e=>{C(e)});const _=u(()=>{n.value=1,t.nextTick(()=>{p()})},"handleReset");return t.onMounted(()=>{F&&(b.value=!0,p())}),{isFirst:b,loading:y?L.loading:d,pageSize:r,currentPage:n,tableData:s,total:g,handleCurrentPageChange:k,handleSizeChange:C,handleReset:_,loadData:p}}u(E,"useTableListHook");exports.default=E;
