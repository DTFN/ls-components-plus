"use strict";var k=Object.defineProperty;var t=(a,c)=>k(a,"name",{value:c,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),C=require("../../_hooks/useNamespace/index.cjs"),w=require("../types/index.cjs"),g=require("../../_constants/prviewType/index.cjs"),o=require("../../_utils/utils/index.cjs"),b=require("../../_utils/check/index.cjs"),_=require("luckyexcel"),v=e.defineComponent({name:"LSXlsx"}),B=e.defineComponent({...v,props:w.xlsxProps,emits:g.previewEmits,setup(a,{emit:c}){const u=[{id:"luckysheet1",src:"/luckysheet/plugins/js/plugin.js"},{id:"luckysheet2",src:"/luckysheet/luckysheet.umd.js"}],f=[{id:"luckysheetCss1",src:"/luckysheet/plugins/css/pluginsCss.css"},{id:"luckysheetCss2",src:"/luckysheet/plugins/plugins.css"},{id:"luckysheetCss3",src:"/luckysheet/css/luckysheet.css"},{id:"luckysheetCss4",src:"/luckysheet/assets/iconfont/iconfont.css"}],n=C.useNamespace("xlsx"),m=n.b(),r=a,i=c;e.watch(()=>r.source,l=>{y(l)},{immediate:!0,deep:!0});function d(){const l=document.scripts;for(let s=0;s<l.length;s++)if(l[s].src.includes("luckysheet"))return!0;return!1}t(d,"isLuckySheet");const p=t(()=>{r.onClose&&r.onClose(),i("update:source",[])},"closeFunc");async function y(l){if(!(!l||!b.isFile(l)))try{d()||(await o.loadCss(f),await o.loadJs(u)),_.transformExcelToLucky(l,function(s){s.sheets!=null&&(window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",data:s.sheets,title:s.info.name,lang:"zh",gridKey:new Date().getTime(),showinfobar:!1,allowEdit:!1,allowCopy:!1,allowUpdate:!1,showtoolbar:!1,enableAddRow:!1,enableAddBackTop:!1,sheetFormulaBar:!1,showstatisticBar:!1,showsheetbar:!1,forceCalculation:!0,showConfigWindowResize:!1,showsheetbarConfig:{sheet:!0},sheetRightClickConfig:{delete:!1,copy:!1,rename:!1,color:!1,hide:!1,move:!1},cellRightClickConfig:{copy:!1,copyAs:!1,paste:!1,insertRow:!1,insertColumn:!1,deleteRow:!1,deleteColumn:!1,deleteCell:!1,hideRow:!1,hideColumn:!1,rowHeight:!1,columnWidth:!1,clear:!1,matrix:!1,sort:!1,filter:!1,chart:!1,image:!1,link:!1,data:!1,cellFormat:!1},hook:{cellUpdateBefore:t(()=>!1,"cellUpdateBefore"),imageDeleteBefore:t(()=>!1,"imageDeleteBefore"),imageUpdateBefore:t(()=>!1,"imageUpdateBefore")}}))}),i("loadComplete")}catch{i("loadError")}}return t(y,"initXlsx"),e.onBeforeUnmount(()=>{d()||(o.removeCss(f),o.removeJs(u))}),(l,s)=>{const h=e.resolveComponent("LSIcon");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(m))},[e.createElementVNode("span",{class:e.normalizeClass([e.unref(n).e("btn"),e.unref(n).e("close")]),onClick:p},[e.createVNode(h,{name:"Close",size:24,color:"#FFF"})],2),s[0]||(s[0]=e.createElementVNode("div",{id:"luckysheet",class:"luckysheet-wrap"},null,-1))],2)}}});exports.default=B;
