"use strict";var L=Object.defineProperty;var c=(d,f)=>L(d,"name",{value:f,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const n=require("vue"),S=require("../../../../../node_modules/.pnpm/@amap_amap-jsapi-loader@1.0.1/node_modules/@amap/amap-jsapi-loader/dist/index/index.cjs"),z=require("../../_hooks/useNamespace/index.cjs"),D=require("../types/index.cjs"),I=require("../mark_icon.png/index.cjs"),b=["id"],x=n.defineComponent({name:"LSMap"}),P=n.defineComponent({...x,props:D.lsMapProps,setup(d){const k=z.useNamespace("map").b(),e=d,h=n.ref(`lsMapContainer${new Date().getTime()}`),r=n.ref(null),m=n.ref(null),v=n.computed(()=>({width:`${e.width}`,height:`${e.height}`}));n.watch(()=>e.securityCode,t=>{window._AMapSecurityConfig={securityJsCode:t}},{immediate:!0,deep:!0});function y(){e.mapKey&&S.default.load({key:e.mapKey,version:"2.0",plugins:["AMap.DistrictSearch"]}).then(t=>{m.value=t,e.searchWord?new t.DistrictSearch({subdistrict:0,level:"district",extensions:"all"}).search(e.searchWord,function(a,i){g(t,i)}):g(t)})}c(y,"initMap");function g(t,o){r.value=new t.Map(h.value,{center:e.center,zoom:e.zoom,zooms:e.zooms,expandZoomRange:!0}),r.value&&C(t,r,o)}c(g,"createMap");function C(t,o,a){var i;if(a){const s=[new t.LngLat(-360,90,!0),new t.LngLat(-360,-90,!0),new t.LngLat(360,-90,!0),new t.LngLat(360,90,!0)],u=((i=a==null?void 0:a.districtList[0])==null?void 0:i.boundaries)||[],l=[s];l.push.apply(l,u);const w=new t.Polygon({pathL:l,strokeColor:e.areaColor,strokeWeight:0,fillColor:e.areaColor,fillOpacity:1});w.setPath(l),o.value.add(w)}e.showMarker&&p(t,o)}c(C,"createArea");function _(t){const o=new t.Size(e.markerIconSize[0],e.markerIconSize[1]);return new t.Icon({size:o,image:e.markerIcon||I.default,imageSize:o})}c(_,"createMarkerIcon");function p(t,o){const a=_(t);(e.markerList||[]).forEach(i=>{const s=new t.Marker({position:i.lnglat,icon:a});if(e.showMarkerDialog&&e.markerDialogContent){const u=new t.InfoWindow({isCustom:!0,content:e.markerDialogContent,anchor:e.markerDialogAnchor,offset:new t.Pixel(e.markerDialogOffset[0],e.markerDialogOffset[1])});s.on("mouseover",()=>{u.open(o.value,s.getPosition())}),s.on("mouseout",()=>{u.close()})}o.value.add(s)})}return c(p,"addMarker"),n.watch(()=>e.markerList,async()=>{await n.nextTick(),m.value&&r.value&&e.showMarker&&p(m.value,r)},{deep:!0}),n.onMounted(()=>{y()}),n.onUnmounted(()=>{r.value&&r.value.destroy()}),(t,o)=>(n.openBlock(),n.createElementBlock("div",{id:n.unref(h),class:n.normalizeClass(n.unref(k)),style:n.normalizeStyle(n.unref(v))},null,14,b))}});exports.default=P;
