"use strict";var x=Object.defineProperty;var o=(t,n)=>x(t,"name",{value:n,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),C=require("../../../_hooks/useNamespace/index.cjs"),l=require("../../types/index.cjs"),g=require("../../../_utils/check/index.cjs"),h=e.defineComponent({name:"LSDocx"}),v=e.defineComponent({...h,props:l.docxProps,emits:l.previewEmits,setup(t,{emit:n}){const s=C.useNamespace("docx"),i=s.b(),d=o(()=>Promise.resolve().then(()=>require("../../../../../../node_modules/.pnpm/docx-preview@0.3.2/node_modules/docx-preview/dist/docx-preview/index.cjs")),"docxPromise"),c=t,a=n,u=e.ref();e.watch(()=>c.source,r=>{m(r)},{immediate:!0,deep:!0});async function m(r){if(!r||!g.isArrayBuffer(r))return;(await d()).renderAsync(r,u.value,u.value,{className:"docx",inWrapper:!0,ignoreWidth:!1,ignoreHeight:!0,ignoreFonts:!1,breakPages:!0,ignoreLastRenderedPageBreak:!0,experimental:!1,trimXmlDeclaration:!0,useBase64URL:!1,renderChanges:!1,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,debug:!1}).then(()=>{a("loadComplete")}).catch(()=>{a("loadError")})}o(m,"updateDocx");const f=o(()=>{c.onClose&&c.onClose(),a("update:source",[])},"closeFunc");return(r,p)=>{const _=e.resolveComponent("LSIcon");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(i))},[e.createElementVNode("span",{class:e.normalizeClass([e.unref(s).e("btn"),e.unref(s).e("close")]),onClick:f},[e.createVNode(_,{name:"Close",size:24,color:"#FFF"})],2),e.createElementVNode("div",{ref_key:"docxRef",ref:u},null,512)],2)}}});exports.default=v;
