"use strict";var Q=Object.defineProperty;var s=(n,a)=>Q(n,"name",{value:a,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const W=require("../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),P=require("../../util/number/index.cjs"),t=require("../../util/time/index.cjs"),U=require("../helper/index.cjs"),Z=require("../Interval/index.cjs"),$=require("../Scale/index.cjs"),I=require("../../util/log/index.cjs"),L=require("../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs");var T=s(function(n,a,e,r){for(;e<r;){var u=e+r>>>1;n[u][1]<a?e=u+1:r=u}return e},"bisect"),X=function(n){W.__extends(a,n);function a(e){var r=n.call(this,e)||this;return r.type="time",r}return s(a,"TimeScale"),a.prototype.getLabel=function(e){var r=this.getSetting("useUTC");return t.format(e.value,t.fullLeveledFormatter[t.getDefaultFormatPrecisionOfInterval(t.getPrimaryTimeUnit(this._minLevelUnit))]||t.fullLeveledFormatter.second,r,this.getSetting("locale"))},a.prototype.getFormattedLabel=function(e,r,u){var c=this.getSetting("useUTC"),o=this.getSetting("locale");return t.leveledFormat(e,r,u,o,c)},a.prototype.getTicks=function(){var e=this._interval,r=this._extent,u=[];if(!e)return u;u.push({value:r[0],level:0});var c=this.getSetting("useUTC"),o=ae(this._minLevelUnit,this._approxInterval,c,r);return u=u.concat(o),u.push({value:r[1],level:0}),u},a.prototype.calcNiceExtent=function(e){var r=this._extent;if(r[0]===r[1]&&(r[0]-=t.ONE_DAY,r[1]+=t.ONE_DAY),r[1]===-1/0&&r[0]===1/0){var u=new Date;r[1]=+new Date(u.getFullYear(),u.getMonth(),u.getDate()),r[0]=r[1]-t.ONE_DAY}this.calcNiceTicks(e.splitNumber,e.minInterval,e.maxInterval)},a.prototype.calcNiceTicks=function(e,r,u){e=e||10;var c=this._extent,o=c[1]-c[0];this._approxInterval=o/e,r!=null&&this._approxInterval<r&&(this._approxInterval=r),u!=null&&this._approxInterval>u&&(this._approxInterval=u);var _=q.length,y=Math.min(T(q,this._approxInterval,0,_),_-1);this._interval=q[y][1],this._minLevelUnit=q[Math.max(y-1,0)][0]},a.prototype.parse=function(e){return L.isNumber(e)?e:+P.parseDate(e)},a.prototype.contain=function(e){return U.contain(this.parse(e),this._extent)},a.prototype.normalize=function(e){return U.normalize(this.parse(e),this._extent)},a.prototype.scale=function(e){return U.scale(e,this._extent)},a.type="time",a}(Z.default),q=[["second",t.ONE_SECOND],["minute",t.ONE_MINUTE],["hour",t.ONE_HOUR],["quarter-day",t.ONE_HOUR*6],["half-day",t.ONE_HOUR*12],["day",t.ONE_DAY*1.2],["half-week",t.ONE_DAY*3.5],["week",t.ONE_DAY*7],["month",t.ONE_DAY*31],["quarter",t.ONE_DAY*95],["half-year",t.ONE_YEAR/2],["year",t.ONE_YEAR]];function C(n,a,e,r){var u=P.parseDate(a),c=P.parseDate(e),o=s(function(w){return t.getUnitValue(u,w,r)===t.getUnitValue(c,w,r)},"isSame"),_=s(function(){return o("year")},"isSameYear"),y=s(function(){return _()&&o("month")},"isSameMonth"),S=s(function(){return y()&&o("day")},"isSameDay"),v=s(function(){return S()&&o("hour")},"isSameHour"),N=s(function(){return v()&&o("minute")},"isSameMinute"),M=s(function(){return N()&&o("second")},"isSameSecond"),i=s(function(){return M()&&o("millisecond")},"isSameMilliSecond");switch(n){case"year":return _();case"month":return y();case"day":return S();case"hour":return v();case"minute":return N();case"second":return M();case"millisecond":return i()}}s(C,"isUnitValueSame");function x(n,a){return n/=t.ONE_DAY,n>16?16:n>7.5?7:n>3.5?4:n>1.5?2:1}s(x,"getDateInterval");function ee(n){var a=30*t.ONE_DAY;return n/=a,n>6?6:n>3?3:n>2?2:1}s(ee,"getMonthInterval");function te(n){return n/=t.ONE_HOUR,n>12?12:n>6?6:n>3.5?4:n>2?2:1}s(te,"getHourInterval");function B(n,a){return n/=a?t.ONE_MINUTE:t.ONE_SECOND,n>30?30:n>20?20:n>15?15:n>10?10:n>5?5:n>2?2:1}s(B,"getMinutesAndSecondsInterval");function re(n){return P.nice(n)}s(re,"getMillisecondsInterval");function ne(n,a,e){var r=new Date(n);switch(t.getPrimaryTimeUnit(a)){case"year":case"month":r[t.monthSetterName(e)](0);case"day":r[t.dateSetterName(e)](1);case"hour":r[t.hoursSetterName(e)](0);case"minute":r[t.minutesSetterName(e)](0);case"second":r[t.secondsSetterName(e)](0),r[t.millisecondsSetterName(e)](0)}return r.getTime()}s(ne,"getFirstTimestampOfUnit");function ae(n,a,e,r){var u=1e4,c=t.timeUnits,o=0;function _(h,l,D,A,R,d,Y){for(var b=new Date(l),f=l,m=b[A]();f<D&&f<=r[1];)Y.push({value:f}),m+=h,b[R](m),f=b.getTime();Y.push({value:f,notAdd:!0})}s(_,"addTicksInSpan");function y(h,l,D){var A=[],R=!l.length;if(!C(t.getPrimaryTimeUnit(h),r[0],r[1],e)){R&&(l=[{value:ne(new Date(r[0]),h,e)},{value:r[1]}]);for(var d=0;d<l.length-1;d++){var Y=l[d].value,b=l[d+1].value;if(Y!==b){var f=void 0,m=void 0,g=void 0,p=!1;switch(h){case"year":f=Math.max(1,Math.round(a/t.ONE_DAY/365)),m=t.fullYearGetterName(e),g=t.fullYearSetterName(e);break;case"half-year":case"quarter":case"month":f=ee(a),m=t.monthGetterName(e),g=t.monthSetterName(e);break;case"week":case"half-week":case"day":f=x(a),m=t.dateGetterName(e),g=t.dateSetterName(e),p=!0;break;case"half-day":case"quarter-day":case"hour":f=te(a),m=t.hoursGetterName(e),g=t.hoursSetterName(e);break;case"minute":f=B(a,!0),m=t.minutesGetterName(e),g=t.minutesSetterName(e);break;case"second":f=B(a,!1),m=t.secondsGetterName(e),g=t.secondsSetterName(e);break;case"millisecond":f=re(a),m=t.millisecondsGetterName(e),g=t.millisecondsSetterName(e);break}_(f,Y,b,m,g,p,A),h==="year"&&D.length>1&&d===0&&D.unshift({value:D[0].value-f})}}for(var d=0;d<A.length;d++)D.push(A[d]);return A}}s(y,"addLevelTicks");for(var S=[],v=[],N=0,M=0,i=0;i<c.length&&o++<u;++i){var w=t.getPrimaryTimeUnit(c[i]);if(t.isPrimaryTimeUnit(c[i])){y(c[i],S[S.length-1]||[],v);var J=c[i+1]?t.getPrimaryTimeUnit(c[i+1]):null;if(w!==J){if(v.length){M=N,v.sort(function(h,l){return h.value-l.value});for(var z=[],O=0;O<v.length;++O){var F=v[O].value;(O===0||v[O-1].value!==F)&&(z.push(v[O]),F>=r[0]&&F<=r[1]&&N++)}var k=(r[1]-r[0])/a;if(N>k*1.5&&M>k/1.5||(S.push(z),N>k||n===c[i]))break}v=[]}}}process.env.NODE_ENV!=="production"&&o>=u&&I.warn("Exceed safe limit.");for(var G=L.filter(L.map(S,function(h){return L.filter(h,function(l){return l.value>=r[0]&&l.value<=r[1]&&!l.notAdd})}),function(h){return h.length>0}),E=[],K=G.length-1,i=0;i<G.length;++i)for(var V=G[i],H=0;H<V.length;++H)E.push({value:V[H].value,level:K-i});E.sort(function(h,l){return h.value-l.value});for(var j=[],i=0;i<E.length;++i)(i===0||E[i].value!==E[i-1].value)&&j.push(E[i]);return j}s(ae,"getIntervalTicks");$.default.registerClass(X);exports.default=X;
