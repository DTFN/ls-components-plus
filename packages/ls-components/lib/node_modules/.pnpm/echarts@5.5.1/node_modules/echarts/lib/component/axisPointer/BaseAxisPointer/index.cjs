"use strict";var P=Object.defineProperty;var u=(i,e)=>P(i,"name",{value:e,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const p=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),g=require("../../../util/graphic/index.cjs"),w=require("../modelHelper/index.cjs"),S=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/event/index.cjs"),y=require("../../../util/throttle/index.cjs"),T=require("../../../util/model/index.cjs"),z=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Group/index.cjs"),M=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Text/index.cjs"),q=require("../../../animation/basicTransition/index.cjs");var d=T.makeInner(),m=p.clone,c=p.bind,I=function(){function i(){this._dragging=!1,this.animationThreshold=15}return u(i,"BaseAxisPointer"),i.prototype.render=function(e,t,a,r){var n=t.get("value"),l=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=a,!(!r&&this._lastValue===n&&this._lastStatus===l)){this._lastValue=n,this._lastStatus=l;var o=this._group,s=this._handle;if(!l||l==="hide"){o&&o.hide(),s&&s.hide();return}o&&o.show(),s&&s.show();var h={};this.makeElOption(h,n,e,t,a);var v=h.graphicKey;v!==this._lastGraphicKey&&this.clear(a),this._lastGraphicKey=v;var x=this._moveAnimation=this.determineAnimation(e,t);if(!o)o=this._group=new z.default,this.createPointerEl(o,h,e,t),this.createLabelEl(o,h,e,t),a.getZr().add(o);else{var _=p.curry(b,t,x);this.updatePointerEl(o,h,_),this.updateLabelEl(o,h,_,t)}E(o,t,!0),this._renderHandle(n)}},i.prototype.remove=function(e){this.clear(e)},i.prototype.dispose=function(e){this.clear(e)},i.prototype.determineAnimation=function(e,t){var a=t.get("animation"),r=e.axis,n=r.type==="category",l=t.get("snap");if(!l&&!n)return!1;if(a==="auto"||a==null){var o=this.animationThreshold;if(n&&r.getBandWidth()>o)return!0;if(l){var s=w.getAxisInfo(e).seriesDataCount,h=r.getExtent();return Math.abs(h[0]-h[1])/s>o}return!1}return a===!0},i.prototype.makeElOption=function(e,t,a,r,n){},i.prototype.createPointerEl=function(e,t,a,r){var n=t.pointer;if(n){var l=d(e).pointerEl=new g[n.type](m(t.pointer));e.add(l)}},i.prototype.createLabelEl=function(e,t,a,r){if(t.label){var n=d(e).labelEl=new M.default(m(t.label));e.add(n),A(n,r)}},i.prototype.updatePointerEl=function(e,t,a){var r=d(e).pointerEl;r&&t.pointer&&(r.setStyle(t.pointer.style),a(r,{shape:t.pointer.shape}))},i.prototype.updateLabelEl=function(e,t,a,r){var n=d(e).labelEl;n&&(n.setStyle(t.label.style),a(n,{x:t.label.x,y:t.label.y}),A(n,r))},i.prototype._renderHandle=function(e){if(!(this._dragging||!this.updateHandleTransform)){var t=this._axisPointerModel,a=this._api.getZr(),r=this._handle,n=t.getModel("handle"),l=t.get("status");if(!n.get("show")||!l||l==="hide"){r&&a.remove(r),this._handle=null;return}var o;this._handle||(o=!0,r=this._handle=g.createIcon(n.get("icon"),{cursor:"move",draggable:!0,onmousemove:u(function(h){S.stop(h.event)},"onmousemove"),onmousedown:c(this._onHandleDragMove,this,0,0),drift:c(this._onHandleDragMove,this),ondragend:c(this._onHandleDragEnd,this)}),a.add(r)),E(r,t,!1),r.setStyle(n.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=n.get("size");p.isArray(s)||(s=[s,s]),r.scaleX=s[0]/2,r.scaleY=s[1]/2,y.createOrUpdate(this,"_doDispatchAxisPointer",n.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,o)}},i.prototype._moveHandleToValue=function(e,t){b(this._axisPointerModel,!t&&this._moveAnimation,this._handle,f(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},i.prototype._onHandleDragMove=function(e,t){var a=this._handle;if(a){this._dragging=!0;var r=this.updateHandleTransform(f(a),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=r,a.stopAnimation(),a.attr(f(r)),d(a).lastProp=null,this._doDispatchAxisPointer()}},i.prototype._doDispatchAxisPointer=function(){var e=this._handle;if(e){var t=this._payloadInfo,a=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:a.axis.dim,axisIndex:a.componentIndex}]})}},i.prototype._onHandleDragEnd=function(){this._dragging=!1;var e=this._handle;if(e){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},i.prototype.clear=function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),a=this._group,r=this._handle;t&&a&&(this._lastGraphicKey=null,a&&t.remove(a),r&&t.remove(r),this._group=null,this._handle=null,this._payloadInfo=null),y.clear(this,"_doDispatchAxisPointer")},i.prototype.doClear=function(){},i.prototype.buildLabel=function(e,t,a){return a=a||0,{x:e[a],y:e[1-a],width:t[a],height:t[1-a]}},i}();function b(i,e,t,a){H(d(t).lastProp,a)||(d(t).lastProp=a,e?q.updateProps(t,a,i):(t.stopAnimation(),t.attr(a)))}u(b,"updateProps");function H(i,e){if(p.isObject(i)&&p.isObject(e)){var t=!0;return p.each(e,function(a,r){t=t&&H(i[r],a)}),!!t}else return i===e}u(H,"propsEqual");function A(i,e){i[e.get(["label","show"])?"show":"hide"]()}u(A,"updateLabelShowHide");function f(i){return{x:i.x||0,y:i.y||0,rotation:i.rotation||0}}u(f,"getHandleTransProps");function E(i,e,t){var a=e.get("z"),r=e.get("zlevel");i&&i.traverse(function(n){n.type!=="group"&&(a!=null&&(n.z=a),r!=null&&(n.zlevel=r),n.silent=t)})}u(E,"updateMandatoryProps");exports.default=I;
