"use strict";var A=Object.defineProperty;var c=(r,e)=>A(r,"name",{value:e,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const l=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),I=require("../../../data/SeriesData/index.cjs"),N=require("../../../data/helper/createDimensions/index.cjs"),x=require("../../../data/helper/dimensionHelper/index.cjs"),E=require("../../../util/model/index.cjs"),M=require("../../../core/CoordinateSystem/index.cjs"),R=require("../../../model/referHelper/index.cjs"),F=require("../../../data/helper/dataStackHelper/index.cjs"),_=require("../../../data/helper/sourceHelper/index.cjs"),S=require("../../../util/types/index.cjs");function k(r,e){var i=r.get("coordinateSystem"),t=M.default.get(i),a;return e&&e.coordSysDims&&(a=l.map(e.coordSysDims,function(n){var s={name:n},u=e.axisMap.get(n);if(u){var o=u.get("type");s.type=x.getDimensionTypeByAxis(o)}return s})),a||(a=t&&(t.getDimensionsInfo?t.getDimensionsInfo():t.dimensions.slice())||["x","y"]),a}c(k,"getCoordSysDimDefs");function G(r,e,i){var t,a;return i&&l.each(r,function(n,s){var u=n.coordDim,o=i.categoryAxisMap.get(u);o&&(t==null&&(t=s),n.ordinalMeta=o.getOrdinalMeta(),e&&(n.createInvertedIndices=!0)),n.otherDims.itemName!=null&&(a=!0)}),!a&&t!=null&&(r[t].otherDims.itemName=0),t}c(G,"injectOrdinalMeta");function H(r,e,i){i=i||{};var t=e.getSourceManager(),a,n=!1;a=t.getSource(),n=a.sourceFormat===S.SOURCE_FORMAT_ORIGINAL;var s=R.getCoordSysInfoBySeries(e),u=k(e,s),o=i.useEncodeDefaulter,y=l.isFunction(o)?o:o?l.curry(_.makeSeriesEncodeForAxisCoordSys,u,e):null,C={coordDimensions:u,generateCoord:i.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:y,canOmitUnusedDimensions:!n},d=N.default(a,C),f=G(d.dimensions,i.createInvertedIndices,s),D=n?null:t.getSharedDataStore(d),O=F.enableDataStack(e,{schema:d,store:D}),m=new I.default(d,e);m.setCalculationInfo(O);var h=f!=null&&T(a)?function(p,q,v,g){return g===f?v:this.defaultDimValueGetter(p,q,v,g)}:null;return m.hasItemOption=!1,m.initData(n?a:D,null,h),m}c(H,"createSeriesData");function T(r){if(r.sourceFormat===S.SOURCE_FORMAT_ORIGINAL){var e=b(r.data||[]);return!l.isArray(E.getDataItemValue(e))}}c(T,"isNeedCompleteOrdinalData");function b(r){for(var e=0;e<r.length&&r[e]==null;)e++;return r[e]}c(b,"firstDataNotNull");exports.default=H;
