"use strict";var b=Object.defineProperty;var v=(r,o)=>b(r,"name",{value:o,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const w=require("../../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),H=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/Eventful/index.cjs"),f=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/event/index.cjs"),c=require("../interactionMutex/index.cjs"),a=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs");var O=function(r){w.__extends(o,r);function o(e){var i=r.call(this)||this;i._zr=e;var n=a.bind(i._mousedownHandler,i),t=a.bind(i._mousemoveHandler,i),u=a.bind(i._mouseupHandler,i),l=a.bind(i._mousewheelHandler,i),h=a.bind(i._pinchHandler,i);return i.enable=function(s,g){this.disable(),this._opt=a.defaults(a.clone(g)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),s==null&&(s=!0),(s===!0||s==="move"||s==="pan")&&(e.on("mousedown",n),e.on("mousemove",t),e.on("mouseup",u)),(s===!0||s==="scale"||s==="zoom")&&(e.on("mousewheel",l),e.on("pinch",h))},i.disable=function(){e.off("mousedown",n),e.off("mousemove",t),e.off("mouseup",u),e.off("mousewheel",l),e.off("pinch",h)},i}return v(o,"RoamController"),o.prototype.isDragging=function(){return this._dragging},o.prototype.isPinching=function(){return this._pinching},o.prototype.setPointerChecker=function(e){this.pointerChecker=e},o.prototype.dispose=function(){this.disable()},o.prototype._mousedownHandler=function(e){if(!f.isMiddleOrRightButtonOnMouseUpDown(e)){for(var i=e.target;i;){if(i.draggable)return;i=i.__hostTarget||i.parent}var n=e.offsetX,t=e.offsetY;this.pointerChecker&&this.pointerChecker(e,n,t)&&(this._x=n,this._y=t,this._dragging=!0)}},o.prototype._mousemoveHandler=function(e){if(!(!this._dragging||!d("moveOnMouseMove",e,this._opt)||e.gestureEvent==="pinch"||c.isTaken(this._zr,"globalPan"))){var i=e.offsetX,n=e.offsetY,t=this._x,u=this._y,l=i-t,h=n-u;this._x=i,this._y=n,this._opt.preventDefaultMouseMove&&f.stop(e.event),_(this,"pan","moveOnMouseMove",e,{dx:l,dy:h,oldX:t,oldY:u,newX:i,newY:n,isAvailableBehavior:null})}},o.prototype._mouseupHandler=function(e){f.isMiddleOrRightButtonOnMouseUpDown(e)||(this._dragging=!1)},o.prototype._mousewheelHandler=function(e){var i=d("zoomOnMouseWheel",e,this._opt),n=d("moveOnMouseWheel",e,this._opt),t=e.wheelDelta,u=Math.abs(t),l=e.offsetX,h=e.offsetY;if(!(t===0||!i&&!n)){if(i){var s=u>3?1.4:u>1?1.2:1.1,g=t>0?s:1/s;p(this,"zoom","zoomOnMouseWheel",e,{scale:g,originX:l,originY:h,isAvailableBehavior:null})}if(n){var m=Math.abs(t),M=(t>0?1:-1)*(m>3?.4:m>1?.15:.05);p(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:M,originX:l,originY:h,isAvailableBehavior:null})}}},o.prototype._pinchHandler=function(e){if(!c.isTaken(this._zr,"globalPan")){var i=e.pinchScale>1?1.1:1/1.1;p(this,"zoom",null,e,{scale:i,originX:e.pinchX,originY:e.pinchY,isAvailableBehavior:null})}},o}(H.default);function p(r,o,e,i,n){r.pointerChecker&&r.pointerChecker(i,n.originX,n.originY)&&(f.stop(i.event),_(r,o,e,i,n))}v(p,"checkPointerAndTrigger");function _(r,o,e,i,n){n.isAvailableBehavior=a.bind(d,null,e,i),r.trigger(o,n)}v(_,"trigger");function d(r,o,e){var i=e[r];return!r||i&&(!a.isString(i)||o.event[i+"Key"])}v(d,"isAvailableBehavior");exports.default=O;
