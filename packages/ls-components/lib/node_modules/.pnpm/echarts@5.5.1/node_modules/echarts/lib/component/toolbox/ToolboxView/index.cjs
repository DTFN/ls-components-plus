"use strict";var W=Object.defineProperty;var C=(d,p)=>W(d,"name",{value:p,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const O=require("../../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),v=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),U=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/contain/text/index.cjs"),V=require("../../../util/graphic/index.cjs"),q=require("../../../util/states/index.cjs"),j=require("../../../model/Model/index.cjs"),H=require("../../../data/DataDiffer/index.cjs"),B=require("../../helper/listComponent/index.cjs"),G=require("../../../view/Component/index.cjs"),F=require("../featureManager/index.cjs"),J=require("../../../util/component/index.cjs"),z=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Text/index.cjs"),K=require("../../../label/labelStyle/index.cjs");var L=function(d){O.__extends(p,d);function p(){return d!==null&&d.apply(this,arguments)||this}return C(p,"ToolboxView"),p.prototype.render=function(i,c,e,S){var l=this.group;if(l.removeAll(),!i.get("show"))return;var T=+i.get("itemSize"),k=i.get("orient")==="vertical",E=i.get("feature")||{},I=this._features||(this._features={}),w=[];v.each(E,function(r,h){w.push(h)}),new H.default(this._featureNames||[],w).add(b).update(b).remove(v.curry(b,null)).execute(),this._featureNames=w;function b(r,h){var s=w[r],m=w[h],n=E[s],o=new j.default(n,i,i.ecModel),t;if(S&&S.newTitle!=null&&S.featureName===s&&(n.title=S.newTitle),s&&!m){if(Q(s))t={onclick:o.option.onclick,featureName:s};else{var f=F.getFeature(s);if(!f)return;t=new f}I[s]=t}else if(t=I[m],!t)return;t.uid=J.getUID("toolbox-feature"),t.model=o,t.ecModel=c,t.api=e;var g=t instanceof F.ToolboxFeature;if(!s&&m){g&&t.dispose&&t.dispose(c,e);return}if(!o.get("show")||g&&t.unusable){g&&t.remove&&t.remove(c,e);return}R(o,t,s),o.setIconStatus=function(x,y){var a=this.option,u=this.iconPaths;a.iconStatus=a.iconStatus||{},a.iconStatus[x]=y,u[x]&&(y==="emphasis"?q.enterEmphasis:q.leaveEmphasis)(u[x])},t instanceof F.ToolboxFeature&&t.render&&t.render(o,c,e,S)}C(b,"processFeature");function R(r,h,s){var m=r.getModel("iconStyle"),n=r.getModel(["emphasis","iconStyle"]),o=h instanceof F.ToolboxFeature&&h.getIcons?h.getIcons():r.get("icon"),t=r.get("title")||{},f,g;v.isString(o)?(f={},f[s]=o):f=o,v.isString(t)?(g={},g[s]=t):g=t;var x=r.iconPaths={};v.each(f,function(y,a){var u=V.createIcon(y,{},{x:-T/2,y:-T/2,width:T,height:T});u.setStyle(m.getItemStyle());var A=u.ensureState("emphasis");A.style=n.getItemStyle();var _=new z.default({style:{text:g[a],align:n.get("textAlign"),borderRadius:n.get("textBorderRadius"),padding:n.get("textPadding"),fill:null,font:K.getFont({fontStyle:n.get("textFontStyle"),fontFamily:n.get("textFontFamily"),fontSize:n.get("textFontSize"),fontWeight:n.get("textFontWeight")},c)},ignore:!0});u.setTextContent(_),V.setTooltipConfig({el:u,componentModel:i,itemName:a,formatterParamsExtra:{title:g[a]}}),u.__title=g[a],u.on("mouseover",function(){var P=n.getItemStyle(),D=k?i.get("right")==null&&i.get("left")!=="right"?"right":"left":i.get("bottom")==null&&i.get("top")!=="bottom"?"bottom":"top";_.setStyle({fill:n.get("textFill")||P.fill||P.stroke||"#000",backgroundColor:n.get("textBackgroundColor")}),u.setTextConfig({position:n.get("textPosition")||D}),_.ignore=!i.get("showTitle"),e.enterEmphasis(this)}).on("mouseout",function(){r.get(["iconStatus",a])!=="emphasis"&&e.leaveEmphasis(this),_.hide()}),(r.get(["iconStatus",a])==="emphasis"?q.enterEmphasis:q.leaveEmphasis)(u),l.add(u),u.on("click",v.bind(h.onclick,h,c,e,a)),x[a]=u})}C(R,"createIconPaths"),B.layout(l,i,e),l.add(B.makeBackground(l.getBoundingRect(),i)),k||l.eachChild(function(r){var h=r.__title,s=r.ensureState("emphasis"),m=s.textConfig||(s.textConfig={}),n=r.getTextContent(),o=n&&n.ensureState("emphasis");if(o&&!v.isFunction(o)&&h){var t=o.style||(o.style={}),f=U.getBoundingRect(h,z.default.makeFont(t)),g=r.x+l.x,x=r.y+l.y+T,y=!1;x+f.height>e.getHeight()&&(m.position="top",y=!0);var a=y?-5-f.height:T+10;g+f.width/2>e.getWidth()?(m.position=["100%",a],t.align="right"):g-f.width/2<0&&(m.position=[0,a],t.align="left")}})},p.prototype.updateView=function(i,c,e,S){v.each(this._features,function(l){l instanceof F.ToolboxFeature&&l.updateView&&l.updateView(l.model,c,e,S)})},p.prototype.remove=function(i,c){v.each(this._features,function(e){e instanceof F.ToolboxFeature&&e.remove&&e.remove(i,c)}),this.group.removeAll()},p.prototype.dispose=function(i,c){v.each(this._features,function(e){e instanceof F.ToolboxFeature&&e.dispose&&e.dispose(i,c)})},p.type="toolbox",p}(G.default);function Q(d){return d.indexOf("my")===0}C(Q,"isUserFeatureName");exports.default=L;
