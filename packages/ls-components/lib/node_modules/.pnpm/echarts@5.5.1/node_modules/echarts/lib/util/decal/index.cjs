"use strict";var ue=Object.defineProperty;var h=(e,r)=>ue(e,"name",{value:r,configurable:!0});Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const he=require("../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/WeakMap/index.cjs"),ge=require("../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/LRU/index.cjs"),l=require("../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),V=require("../number/index.cjs"),se=require("../symbol/index.cjs"),ce=require("../../../../../../zrender@5.6.0/node_modules/zrender/lib/canvas/graphic/index.cjs"),fe=require("../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/platform/index.cjs");var D=new he.default,U=new ge.default(100),F=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function ve(e,r){if(e==="none")return null;var t=r.getDevicePixelRatio(),i=r.getZr(),o=i.painter.type==="svg";e.dirty&&D.delete(e);var W=D.get(e);if(W)return W;var a=l.defaults(e,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});a.backgroundColor==="none"&&(a.backgroundColor=null);var c={repeat:"repeat"};return J(c),c.rotation=a.rotation,c.scaleX=c.scaleY=o?1:1/t,D.set(e,c),e.dirty=!1,c;function J(d){for(var Y=[t],C=!0,T=0;T<F.length;++T){var b=a[F[T]];if(b!=null&&!l.isArray(b)&&!l.isString(b)&&!l.isNumber(b)&&typeof b!="boolean"){C=!1;break}Y.push(b)}var L;if(C){L=Y.join(",")+(o?"-svg":"");var P=U.get(L);P&&(o?d.svgElement=P:d.image=P)}var f=Z(a.dashArrayX),m=me(a.dashArrayY),S=G(a.symbol),X=pe(f),H=$(m),s=!o&&fe.platformApi.createCanvas(),q=o&&{tag:"g",attrs:{},key:"dcl",children:[]},k=O(),A;s&&(s.width=k.width*t,s.height=k.height*t,A=s.getContext("2d")),Q(),C&&U.put(L,s||q),d.image=s,d.svgElement=q,d.svgWidth=k.width,d.svgHeight=k.height;function O(){for(var v=1,n=0,p=X.length;n<p;++n)v=V.getLeastCommonMultiple(v,X[n]);for(var g=1,n=0,p=S.length;n<p;++n)g=V.getLeastCommonMultiple(g,S[n].length);v*=g;var w=H*X.length*S.length;if(process.env.NODE_ENV!=="production"){var u=h(function(M){console.warn("Calculated decal size is greater than "+M+" due to decal option settings so "+M+" is used for the decal size. Please consider changing the decal option to make a smaller decal or set "+M+" to be larger to avoid incontinuity.")},"warn");v>a.maxTileWidth&&u("maxTileWidth"),w>a.maxTileHeight&&u("maxTileHeight")}return{width:Math.max(1,Math.min(v,a.maxTileWidth)),height:Math.max(1,Math.min(w,a.maxTileHeight))}}h(O,"getPatternSize");function Q(){A&&(A.clearRect(0,0,s.width,s.height),a.backgroundColor&&(A.fillStyle=a.backgroundColor,A.fillRect(0,0,s.width,s.height)));for(var v=0,n=0;n<m.length;++n)v+=m[n];if(v<=0)return;for(var p=-H,g=0,w=0,u=0;p<k.height;){if(g%2===0){for(var M=w/2%S.length,x=0,y=0,K=0;x<k.width*2;){for(var N=0,n=0;n<f[u].length;++n)N+=f[u][n];if(N<=0)break;if(y%2===0){var R=(1-a.symbolSize)*.5,_=x+f[u][y]*R,j=p+m[g]*R,I=f[u][y]*a.symbolSize,ee=m[g]*a.symbolSize,re=K/2%S[M].length;te(_,j,I,ee,S[M][re])}x+=f[u][y],++K,++y,y===f[u].length&&(y=0)}++u,u===f.length&&(u=0)}p+=m[g],++w,++g,g===m.length&&(g=0)}function te(ie,ae,ne,le,oe){var z=o?1:t,B=se.createSymbol(oe,ie*z,ae*z,ne*z,le*z,a.color,a.symbolKeepAspect);if(o){var E=i.painter.renderOneToVNode(B);E&&q.children.push(E)}else ce.brushSingle(A,B)}h(te,"brushSymbol")}h(Q,"brushDecal")}h(J,"setPatternnSource")}h(ve,"createOrUpdatePatternFromDecal");function G(e){if(!e||e.length===0)return[["rect"]];if(l.isString(e))return[[e]];for(var r=!0,t=0;t<e.length;++t)if(!l.isString(e[t])){r=!1;break}if(r)return G([e]);for(var i=[],t=0;t<e.length;++t)l.isString(e[t])?i.push([e[t]]):i.push(e[t]);return i}h(G,"normalizeSymbolArray");function Z(e){if(!e||e.length===0)return[[0,0]];if(l.isNumber(e)){var r=Math.ceil(e);return[[r,r]]}for(var t=!0,i=0;i<e.length;++i)if(!l.isNumber(e[i])){t=!1;break}if(t)return Z([e]);for(var o=[],i=0;i<e.length;++i)if(l.isNumber(e[i])){var r=Math.ceil(e[i]);o.push([r,r])}else{var r=l.map(e[i],function(c){return Math.ceil(c)});r.length%2===1?o.push(r.concat(r)):o.push(r)}return o}h(Z,"normalizeDashArrayX");function me(e){if(!e||typeof e=="object"&&e.length===0)return[0,0];if(l.isNumber(e)){var r=Math.ceil(e);return[r,r]}var t=l.map(e,function(i){return Math.ceil(i)});return e.length%2?t.concat(t):t}h(me,"normalizeDashArrayY");function pe(e){return l.map(e,function(r){return $(r)})}h(pe,"getLineBlockLengthX");function $(e){for(var r=0,t=0;t<e.length;++t)r+=e[t];return e.length%2===1?r*2:r}h($,"getLineBlockLengthY");exports.createOrUpdatePatternFromDecal=ve;
