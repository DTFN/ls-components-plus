"use strict";var M=Object.defineProperty;var m=(o,e)=>M(o,"name",{value:e,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const I=require("../../../util/graphic/index.cjs"),E=require("../Symbol/index.cjs"),P=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),G=require("../../../label/labelStyle/index.cjs"),A=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Group/index.cjs"),D=require("../../../animation/basicTransition/index.cjs");function g(o,e,t,r){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(r.isIgnore&&r.isIgnore(t))&&!(r.clipShape&&!r.clipShape.contain(e[0],e[1]))&&o.getItemVisual(t,"symbol")!=="none"}m(g,"symbolNeedsDraw");function b(o){return o!=null&&!P.isObject(o)&&(o={isIgnore:o}),o||{}}m(b,"normalizeUpdateOpt");function d(o){var e=o.hostModel,t=e.getModel("emphasis");return{emphasisItemStyle:t.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:t.get("focus"),blurScope:t.get("blurScope"),emphasisDisabled:t.get("disabled"),hoverScale:t.get("scale"),labelStatesModels:G.getLabelStatesModels(e),cursorStyle:e.get("cursor")}}m(d,"makeSeriesScope");var q=function(){function o(e){this.group=new A.default,this._SymbolCtor=e||E.default}return m(o,"SymbolDraw"),o.prototype.updateData=function(e,t){this._progressiveEls=null,t=b(t);var r=this.group,a=e.hostModel,l=this._data,p=this._SymbolCtor,n=t.disableAnimation,c=d(e),v={disableAnimation:n},y=t.getSymbolPoint||function(s){return e.getItemLayout(s)};l||r.removeAll(),e.diff(l).add(function(s){var u=y(s);if(g(e,u,s,t)){var i=new p(e,s,c,v);i.setPosition(u),e.setItemGraphicEl(s,i),r.add(i)}}).update(function(s,u){var i=l.getItemGraphicEl(u),h=y(s);if(!g(e,h,s,t)){r.remove(i);return}var _=e.getItemVisual(s,"symbol")||"circle",S=i&&i.getSymbolType&&i.getSymbolType();if(!i||S&&S!==_)r.remove(i),i=new p(e,s,c,v),i.setPosition(h);else{i.updateData(e,s,c,v);var f={x:h[0],y:h[1]};n?i.attr(f):D.updateProps(i,f,a)}r.add(i),e.setItemGraphicEl(s,i)}).remove(function(s){var u=l.getItemGraphicEl(s);u&&u.fadeOut(function(){r.remove(u)},a)}).execute(),this._getSymbolPoint=y,this._data=e},o.prototype.updateLayout=function(){var e=this,t=this._data;t&&t.eachItemGraphicEl(function(r,a){var l=e._getSymbolPoint(a);r.setPosition(l),r.markRedraw()})},o.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=d(e),this._data=null,this.group.removeAll()},o.prototype.incrementalUpdate=function(e,t,r){this._progressiveEls=[],r=b(r);function a(c){c.isGroup||(c.incremental=!0,c.ensureState("emphasis").hoverLayer=!0)}m(a,"updateIncrementalAndHover");for(var l=e.start;l<e.end;l++){var p=t.getItemLayout(l);if(g(t,p,l,r)){var n=new this._SymbolCtor(t,l,this._seriesScope);n.traverse(a),n.setPosition(p),this.group.add(n),t.setItemGraphicEl(l,n),this._progressiveEls.push(n)}}},o.prototype.eachRendered=function(e){I.traverseElements(this._progressiveEls||this.group,e)},o.prototype.remove=function(e){var t=this.group,r=this._data;r&&e?r.eachItemGraphicEl(function(a){a.fadeOut(function(){t.remove(a)},r.hostModel)}):t.removeAll()},o}();exports.default=q;
