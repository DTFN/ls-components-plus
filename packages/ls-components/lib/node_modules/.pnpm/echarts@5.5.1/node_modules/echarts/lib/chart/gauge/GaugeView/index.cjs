"use strict";var re=Object.defineProperty;var W=(G,c)=>re(G,"name",{value:c,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const ie=require("../../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),ne=require("../PointerPath/index.cjs"),J=require("../../../util/states/index.cjs"),X=require("../../../label/labelStyle/index.cjs"),le=require("../../../view/Chart/index.cjs"),h=require("../../../util/number/index.cjs"),$=require("../../../util/shape/sausage/index.cjs"),j=require("../../../util/symbol/index.cjs"),ve=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Image/index.cjs"),B=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),I=require("../../../util/innerStore/index.cjs"),ge=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/PathProxy/index.cjs"),ee=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/shape/Line/index.cjs"),Q=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Text/index.cjs"),te=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Group/index.cjs"),ae=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/shape/Sector/index.cjs"),R=require("../../../animation/basicTransition/index.cjs");function ue(G,c){var e=G.get("center"),E=c.getWidth(),f=c.getHeight(),o=Math.min(E,f),a=h.parsePercent(e[0],c.getWidth()),S=h.parsePercent(e[1],c.getHeight()),m=h.parsePercent(G.get("radius"),o/2);return{cx:a,cy:S,r:m}}W(ue,"parsePosition");function U(G,c){var e=G==null?"":G+"";return c&&(B.isString(c)?e=c.replace("{value}",e):B.isFunction(c)&&(e=c(G))),e}W(U,"formatLabel");var ce=function(G){ie.__extends(c,G);function c(){var e=G!==null&&G.apply(this,arguments)||this;return e.type=c.type,e}return W(c,"GaugeView"),c.prototype.render=function(e,E,f){this.group.removeAll();var o=e.get(["axisLine","lineStyle","color"]),a=ue(e,f);this._renderMain(e,E,f,o,a),this._data=e.getData()},c.prototype.dispose=function(){},c.prototype._renderMain=function(e,E,f,o,a){var S=this.group,m=e.get("clockwise"),k=-e.get("startAngle")/180*Math.PI,y=-e.get("endAngle")/180*Math.PI,_=e.getModel("axisLine"),N=_.get("roundCap"),C=N?$.default:ae.default,s=_.get("show"),z=_.getModel("lineStyle"),D=z.get("width"),g=[k,y];ge.normalizeArcAngles(g,!m),k=g[0],y=g[1];for(var r=y-k,P=k,A=[],q=0;s&&q<o.length;q++){var b=Math.min(Math.max(o[q][0],0),1);y=k+r*b;var x=new C({shape:{startAngle:P,endAngle:y,cx:a.cx,cy:a.cy,clockwise:m,r0:a.r-D,r:a.r},silent:!0});x.setStyle({fill:o[q][1]}),x.setStyle(z.getLineStyle(["color","width"])),A.push(x),P=y}A.reverse(),B.each(A,function(T){return S.add(T)});var M=W(function(T){if(T<=0)return o[0][1];var t;for(t=0;t<o.length;t++)if(o[t][0]>=T&&(t===0?0:o[t-1][0])<T)return o[t][1];return o[t-1][1]},"getColor");this._renderTicks(e,E,f,M,a,k,y,m,D),this._renderTitleAndDetail(e,E,f,M,a),this._renderAnchor(e,a),this._renderPointer(e,E,f,M,a,k,y,m,D)},c.prototype._renderTicks=function(e,E,f,o,a,S,m,k,y){for(var _=this.group,N=a.cx,C=a.cy,s=a.r,z=+e.get("min"),D=+e.get("max"),g=e.getModel("splitLine"),r=e.getModel("axisTick"),P=e.getModel("axisLabel"),A=e.get("splitNumber"),q=r.get("splitNumber"),b=h.parsePercent(g.get("length"),s),x=h.parsePercent(r.get("length"),s),M=S,T=(m-S)/A,t=T/q,u=g.getModel("lineStyle").getLineStyle(),p=r.getModel("lineStyle").getLineStyle(),d=g.get("distance"),n,l,i=0;i<=A;i++){if(n=Math.cos(M),l=Math.sin(M),g.get("show")){var v=d?d+y:y,w=new ee.default({shape:{x1:n*(s-v)+N,y1:l*(s-v)+C,x2:n*(s-b-v)+N,y2:l*(s-b-v)+C},style:u,silent:!0});u.stroke==="auto"&&w.setStyle({stroke:o(i/A)}),_.add(w)}if(P.get("show")){var v=P.get("distance")+d,V=U(h.round(i/A*(D-z)+z),P.get("formatter")),L=o(i/A),H=n*(s-b-v)+N,F=l*(s-b-v)+C,Y=P.get("rotate"),O=0;Y==="radial"?(O=-M+2*Math.PI,O>Math.PI/2&&(O+=Math.PI)):Y==="tangential"?O=-M-Math.PI/2:B.isNumber(Y)&&(O=Y*Math.PI/180),O===0?_.add(new Q.default({style:X.createTextStyle(P,{text:V,x:H,y:F,verticalAlign:l<-.8?"top":l>.8?"bottom":"middle",align:n<-.4?"left":n>.4?"right":"center"},{inheritColor:L}),silent:!0})):_.add(new Q.default({style:X.createTextStyle(P,{text:V,x:H,y:F,verticalAlign:"middle",align:"center"},{inheritColor:L}),silent:!0,originX:H,originY:F,rotation:O}))}if(r.get("show")&&i!==A){var v=r.get("distance");v=v?v+y:y;for(var K=0;K<=q;K++){n=Math.cos(M),l=Math.sin(M);var Z=new ee.default({shape:{x1:n*(s-v)+N,y1:l*(s-v)+C,x2:n*(s-x-v)+N,y2:l*(s-x-v)+C},silent:!0,style:p});p.stroke==="auto"&&Z.setStyle({stroke:o((i+K/q)/A)}),_.add(Z),M+=t}M-=t}else M+=T}},c.prototype._renderPointer=function(e,E,f,o,a,S,m,k,y){var _=this.group,N=this._data,C=this._progressEls,s=[],z=e.get(["pointer","show"]),D=e.getModel("progress"),g=D.get("show"),r=e.getData(),P=r.mapDimension("value"),A=+e.get("min"),q=+e.get("max"),b=[A,q],x=[S,m];function M(t,u){var p=r.getItemModel(t),d=p.getModel("pointer"),n=h.parsePercent(d.get("width"),a.r),l=h.parsePercent(d.get("length"),a.r),i=e.get(["pointer","icon"]),v=d.get("offsetCenter"),w=h.parsePercent(v[0],a.r),V=h.parsePercent(v[1],a.r),L=d.get("keepAspect"),H;return i?H=j.createSymbol(i,w-n/2,V-l,n,l,null,L):H=new ne.default({shape:{angle:-Math.PI/2,width:n,r:l,x:w,y:V}}),H.rotation=-(u+Math.PI/2),H.x=a.cx,H.y=a.cy,H}W(M,"createPointer");function T(t,u){var p=D.get("roundCap"),d=p?$.default:ae.default,n=D.get("overlap"),l=n?D.get("width"):y/r.count(),i=n?a.r-l:a.r-(t+1)*l,v=n?a.r:a.r-t*l,w=new d({shape:{startAngle:S,endAngle:u,cx:a.cx,cy:a.cy,clockwise:k,r0:i,r:v}});return n&&(w.z2=q-r.get(P,t)%q),w}W(T,"createProgress"),(g||z)&&(r.diff(N).add(function(t){var u=r.get(P,t);if(z){var p=M(t,S);R.initProps(p,{rotation:-((isNaN(+u)?x[0]:h.linearMap(u,b,x,!0))+Math.PI/2)},e),_.add(p),r.setItemGraphicEl(t,p)}if(g){var d=T(t,S),n=D.get("clip");R.initProps(d,{shape:{endAngle:h.linearMap(u,b,x,n)}},e),_.add(d),I.setCommonECData(e.seriesIndex,r.dataType,t,d),s[t]=d}}).update(function(t,u){var p=r.get(P,t);if(z){var d=N.getItemGraphicEl(u),n=d?d.rotation:S,l=M(t,n);l.rotation=n,R.updateProps(l,{rotation:-((isNaN(+p)?x[0]:h.linearMap(p,b,x,!0))+Math.PI/2)},e),_.add(l),r.setItemGraphicEl(t,l)}if(g){var i=C[u],v=i?i.shape.endAngle:S,w=T(t,v),V=D.get("clip");R.updateProps(w,{shape:{endAngle:h.linearMap(p,b,x,V)}},e),_.add(w),I.setCommonECData(e.seriesIndex,r.dataType,t,w),s[t]=w}}).execute(),r.each(function(t){var u=r.getItemModel(t),p=u.getModel("emphasis"),d=p.get("focus"),n=p.get("blurScope"),l=p.get("disabled");if(z){var i=r.getItemGraphicEl(t),v=r.getItemVisual(t,"style"),w=v.fill;if(i instanceof ve.default){var V=i.style;i.useStyle(B.extend({image:V.image,x:V.x,y:V.y,width:V.width,height:V.height},v))}else i.useStyle(v),i.type!=="pointer"&&i.setColor(w);i.setStyle(u.getModel(["pointer","itemStyle"]).getItemStyle()),i.style.fill==="auto"&&i.setStyle("fill",o(h.linearMap(r.get(P,t),b,[0,1],!0))),i.z2EmphasisLift=0,J.setStatesStylesFromModel(i,u),J.toggleHoverEmphasis(i,d,n,l)}if(g){var L=s[t];L.useStyle(r.getItemVisual(t,"style")),L.setStyle(u.getModel(["progress","itemStyle"]).getItemStyle()),L.z2EmphasisLift=0,J.setStatesStylesFromModel(L,u),J.toggleHoverEmphasis(L,d,n,l)}}),this._progressEls=s)},c.prototype._renderAnchor=function(e,E){var f=e.getModel("anchor"),o=f.get("show");if(o){var a=f.get("size"),S=f.get("icon"),m=f.get("offsetCenter"),k=f.get("keepAspect"),y=j.createSymbol(S,E.cx-a/2+h.parsePercent(m[0],E.r),E.cy-a/2+h.parsePercent(m[1],E.r),a,a,null,k);y.z2=f.get("showAbove")?1:0,y.setStyle(f.getModel("itemStyle").getItemStyle()),this.group.add(y)}},c.prototype._renderTitleAndDetail=function(e,E,f,o,a){var S=this,m=e.getData(),k=m.mapDimension("value"),y=+e.get("min"),_=+e.get("max"),N=new te.default,C=[],s=[],z=e.isAnimationEnabled(),D=e.get(["pointer","showAbove"]);m.diff(this._data).add(function(g){C[g]=new Q.default({silent:!0}),s[g]=new Q.default({silent:!0})}).update(function(g,r){C[g]=S._titleEls[r],s[g]=S._detailEls[r]}).execute(),m.each(function(g){var r=m.getItemModel(g),P=m.get(k,g),A=new te.default,q=o(h.linearMap(P,[y,_],[0,1],!0)),b=r.getModel("title");if(b.get("show")){var x=b.get("offsetCenter"),M=a.cx+h.parsePercent(x[0],a.r),T=a.cy+h.parsePercent(x[1],a.r),t=C[g];t.attr({z2:D?0:2,style:X.createTextStyle(b,{x:M,y:T,text:m.getName(g),align:"center",verticalAlign:"middle"},{inheritColor:q})}),A.add(t)}var u=r.getModel("detail");if(u.get("show")){var p=u.get("offsetCenter"),d=a.cx+h.parsePercent(p[0],a.r),n=a.cy+h.parsePercent(p[1],a.r),l=h.parsePercent(u.get("width"),a.r),i=h.parsePercent(u.get("height"),a.r),v=e.get(["progress","show"])?m.getItemVisual(g,"style").fill:q,t=s[g],w=u.get("formatter");t.attr({z2:D?0:2,style:X.createTextStyle(u,{x:d,y:n,text:U(P,w),width:isNaN(l)?null:l,height:isNaN(i)?null:i,align:"center",verticalAlign:"middle"},{inheritColor:v})}),X.setLabelValueAnimation(t,{normal:u},P,function(L){return U(L,w)}),z&&X.animateLabelValue(t,g,m,e,{getFormattedLabel:W(function(L,H,F,Y,O,K){return U(K?K.interpolatedValue:P,w)},"getFormattedLabel")}),A.add(t)}N.add(A)}),this.group.add(N),this._titleEls=C,this._detailEls=s},c.type="gauge",c}(le.default);exports.default=ce;
