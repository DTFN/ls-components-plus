"use strict";var K=Object.defineProperty;var v=(s,o)=>K(s,"name",{value:o,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const Z=require("../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),i=require("../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),d=require("../../util/model/index.cjs"),B=require("../Model/index.cjs"),g=require("../Component/index.cjs"),Q=require("../globalDefault/index.cjs"),W=require("../../data/helper/sourceHelper/index.cjs"),Y=require("../internalComponentCreator/index.cjs"),J=require("../mixin/palette/index.cjs"),A=require("../../util/log/index.cjs");var x,S,H,T="\0_ec_inner",G=1,X={grid:"GridComponent",polar:"PolarComponent",geo:"GeoComponent",singleAxis:"SingleAxisComponent",parallel:"ParallelComponent",calendar:"CalendarComponent",graphic:"GraphicComponent",toolbox:"ToolboxComponent",tooltip:"TooltipComponent",axisPointer:"AxisPointerComponent",brush:"BrushComponent",title:"TitleComponent",timeline:"TimelineComponent",markPoint:"MarkPointComponent",markLine:"MarkLineComponent",markArea:"MarkAreaComponent",legend:"LegendComponent",dataZoom:"DataZoomComponent",visualMap:"VisualMapComponent",xAxis:"GridComponent",yAxis:"GridComponent",angleAxis:"PolarComponent",radiusAxis:"PolarComponent"},$={line:"LineChart",bar:"BarChart",pie:"PieChart",scatter:"ScatterChart",radar:"RadarChart",map:"MapChart",tree:"TreeChart",treemap:"TreemapChart",graph:"GraphChart",gauge:"GaugeChart",funnel:"FunnelChart",parallel:"ParallelChart",sankey:"SankeyChart",boxplot:"BoxplotChart",candlestick:"CandlestickChart",effectScatter:"EffectScatterChart",lines:"LinesChart",heatmap:"HeatmapChart",pictorialBar:"PictorialBarChart",themeRiver:"ThemeRiverChart",sunburst:"SunburstChart",custom:"CustomChart"},I={};function ee(s){i.each(s,function(o,e){if(!g.default.hasClass(e)){var n=X[e];n&&!I[n]&&(A.error("Component "+e+` is used but not imported.
import { `+n+` } from 'echarts/components';
echarts.use([`+n+"]);"),I[n]=!0)}})}v(ee,"checkMissingComponents");var F=function(s){Z.__extends(o,s);function o(){return s!==null&&s.apply(this,arguments)||this}return v(o,"GlobalModel"),o.prototype.init=function(e,n,t,r,a,c){r=r||{},this.option=null,this._theme=new B.default(r),this._locale=new B.default(a),this._optionManager=c},o.prototype.setOption=function(e,n,t){process.env.NODE_ENV!=="production"&&(i.assert(e!=null,"option is null/undefined"),i.assert(e[T]!==G,"please use chart.getOption()"));var r=z(n);this._optionManager.setOption(e,t,r),this._resetOption(null,r)},o.prototype.resetOption=function(e,n){return this._resetOption(e,z(n))},o.prototype._resetOption=function(e,n){var t=!1,r=this._optionManager;if(!e||e==="recreate"){var a=r.mountOption(e==="recreate");process.env.NODE_ENV!=="production"&&ee(a),!this.option||e==="recreate"?H(this,a):(this.restoreData(),this._mergeOption(a,n)),t=!0}if((e==="timeline"||e==="media")&&this.restoreData(),!e||e==="recreate"||e==="timeline"){var c=r.getTimelineOption(this);c&&(t=!0,this._mergeOption(c,n))}if(!e||e==="recreate"||e==="media"){var p=r.getMediaOption(this);p.length&&i.each(p,function(l){t=!0,this._mergeOption(l,n)},this)}return t},o.prototype.mergeOption=function(e){this._mergeOption(e,null)},o.prototype._mergeOption=function(e,n){var t=this.option,r=this._componentsMap,a=this._componentsCount,c=[],p=i.createHashMap(),l=n&&n.replaceMergeMainTypeMap;W.resetSourceDefaulter(this),i.each(e,function(u,f){u!=null&&(g.default.hasClass(f)?f&&(c.push(f),p.set(f,!0)):t[f]=t[f]==null?i.clone(u):i.merge(t[f],u,!0))}),l&&l.each(function(u,f){g.default.hasClass(f)&&!p.get(f)&&(c.push(f),p.set(f,!0))}),g.default.topologicalTravel(c,g.default.getAllClassMainTypes(),C,this);function C(u){var f=Y.concatInternalOptions(this,u,d.normalizeToArray(e[u])),M=r.get(u),m=M?l&&l.get(u)?"replaceMerge":"normalMerge":"replaceAll",k=d.mappingToExists(M,f,m);d.setComponentTypeToKeyInfo(k,u,g.default),t[u]=null,r.set(u,null),a.set(u,0);var P=[],E=[],w=0,D,L;i.each(k,function(_,j){var h=_.existing,y=_.newOption;if(!y)h&&(h.mergeOption({},this),h.optionUpdated({},!1));else{var R=u==="series",N=g.default.getClass(u,_.keyInfo.subType,!R);if(!N){if(process.env.NODE_ENV!=="production"){var O=_.keyInfo.subType,b=$[O];I[O]||(I[O]=!0,b?A.error("Series "+O+` is used but not imported.
import { `+b+` } from 'echarts/charts';
echarts.use([`+b+"]);"):A.error("Unknown series "+O))}return}if(u==="tooltip"){if(D){process.env.NODE_ENV!=="production"&&(L||(A.warn("Currently only one tooltip component is allowed."),L=!0));return}D=!0}if(h&&h.constructor===N)h.name=_.keyInfo.name,h.mergeOption(y,this),h.optionUpdated(y,!1);else{var q=i.extend({componentIndex:j},_.keyInfo);h=new N(y,this,this,q),i.extend(h,q),_.brandNew&&(h.__requireNewView=!0),h.init(y,this,this),h.optionUpdated(null,!0)}}h?(P.push(h.option),E.push(h),w++):(P.push(void 0),E.push(void 0))},this),t[u]=P,r.set(u,E),a.set(u,w),u==="series"&&x(this)}v(C,"visitComponent"),this._seriesIndices||x(this)},o.prototype.getOption=function(){var e=i.clone(this.option);return i.each(e,function(n,t){if(g.default.hasClass(t)){for(var r=d.normalizeToArray(n),a=r.length,c=!1,p=a-1;p>=0;p--)r[p]&&!d.isComponentIdInternal(r[p])?c=!0:(r[p]=null,!c&&a--);r.length=a,e[t]=r}}),delete e[T],e},o.prototype.getTheme=function(){return this._theme},o.prototype.getLocaleModel=function(){return this._locale},o.prototype.setUpdatePayload=function(e){this._payload=e},o.prototype.getUpdatePayload=function(){return this._payload},o.prototype.getComponent=function(e,n){var t=this._componentsMap.get(e);if(t){var r=t[n||0];if(r)return r;if(n==null){for(var a=0;a<t.length;a++)if(t[a])return t[a]}}},o.prototype.queryComponents=function(e){var n=e.mainType;if(!n)return[];var t=e.index,r=e.id,a=e.name,c=this._componentsMap.get(n);if(!c||!c.length)return[];var p;return t!=null?(p=[],i.each(d.normalizeToArray(t),function(l){c[l]&&p.push(c[l])})):r!=null?p=U("id",r,c):a!=null?p=U("name",a,c):p=i.filter(c,function(l){return!!l}),V(p,e)},o.prototype.findComponents=function(e){var n=e.query,t=e.mainType,r=c(n),a=r?this.queryComponents(r):i.filter(this._componentsMap.get(t),function(l){return!!l});return p(V(a,e));function c(l){var C=t+"Index",u=t+"Id",f=t+"Name";return l&&(l[C]!=null||l[u]!=null||l[f]!=null)?{mainType:t,index:l[C],id:l[u],name:l[f]}:null}function p(l){return e.filter?i.filter(l,e.filter):l}},o.prototype.eachComponent=function(e,n,t){var r=this._componentsMap;if(i.isFunction(e)){var a=n,c=e;r.each(function(u,f){for(var M=0;u&&M<u.length;M++){var m=u[M];m&&c.call(a,f,m,m.componentIndex)}})}else for(var p=i.isString(e)?r.get(e):i.isObject(e)?this.findComponents(e):null,l=0;p&&l<p.length;l++){var C=p[l];C&&n.call(t,C,C.componentIndex)}},o.prototype.getSeriesByName=function(e){var n=d.convertOptionIdName(e,null);return i.filter(this._componentsMap.get("series"),function(t){return!!t&&n!=null&&t.name===n})},o.prototype.getSeriesByIndex=function(e){return this._componentsMap.get("series")[e]},o.prototype.getSeriesByType=function(e){return i.filter(this._componentsMap.get("series"),function(n){return!!n&&n.subType===e})},o.prototype.getSeries=function(){return i.filter(this._componentsMap.get("series"),function(e){return!!e})},o.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},o.prototype.eachSeries=function(e,n){S(this),i.each(this._seriesIndices,function(t){var r=this._componentsMap.get("series")[t];e.call(n,r,t)},this)},o.prototype.eachRawSeries=function(e,n){i.each(this._componentsMap.get("series"),function(t){t&&e.call(n,t,t.componentIndex)})},o.prototype.eachSeriesByType=function(e,n,t){S(this),i.each(this._seriesIndices,function(r){var a=this._componentsMap.get("series")[r];a.subType===e&&n.call(t,a,r)},this)},o.prototype.eachRawSeriesByType=function(e,n,t){return i.each(this.getSeriesByType(e),n,t)},o.prototype.isSeriesFiltered=function(e){return S(this),this._seriesIndicesMap.get(e.componentIndex)==null},o.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},o.prototype.filterSeries=function(e,n){S(this);var t=[];i.each(this._seriesIndices,function(r){var a=this._componentsMap.get("series")[r];e.call(n,a,r)&&t.push(r)},this),this._seriesIndices=t,this._seriesIndicesMap=i.createHashMap(t)},o.prototype.restoreData=function(e){x(this);var n=this._componentsMap,t=[];n.each(function(r,a){g.default.hasClass(a)&&t.push(a)}),g.default.topologicalTravel(t,g.default.getAllClassMainTypes(),function(r){i.each(n.get(r),function(a){a&&(r!=="series"||!te(a,e))&&a.restoreData()})})},o.internalField=function(){x=v(function(e){var n=e._seriesIndices=[];i.each(e._componentsMap.get("series"),function(t){t&&n.push(t.componentIndex)}),e._seriesIndicesMap=i.createHashMap(n)},"reCreateSeriesIndices"),S=v(function(e){if(process.env.NODE_ENV!=="production"&&!e._seriesIndices)throw new Error("Option should contains series.")},"assertSeriesInitialized"),H=v(function(e,n){e.option={},e.option[T]=G,e._componentsMap=i.createHashMap({series:[]}),e._componentsCount=i.createHashMap();var t=n.aria;i.isObject(t)&&t.enabled==null&&(t.enabled=!0),ne(n,e._theme.option),i.merge(n,Q.default,!1),e._mergeOption(n,null)},"initBase")}(),o}(B.default);function te(s,o){if(o){var e=o.seriesIndex,n=o.seriesId,t=o.seriesName;return e!=null&&s.componentIndex!==e||n!=null&&s.id!==n||t!=null&&s.name!==t}}v(te,"isNotTargetSeries");function ne(s,o){var e=s.color&&!s.colorLayer;i.each(o,function(n,t){t==="colorLayer"&&e||g.default.hasClass(t)||(typeof n=="object"?s[t]=s[t]?i.merge(s[t],n,!1):i.clone(n):s[t]==null&&(s[t]=n))})}v(ne,"mergeTheme");function U(s,o,e){if(i.isArray(o)){var n=i.createHashMap();return i.each(o,function(r){if(r!=null){var a=d.convertOptionIdName(r,null);a!=null&&n.set(r,!0)}}),i.filter(e,function(r){return r&&n.get(r[s])})}else{var t=d.convertOptionIdName(o,null);return i.filter(e,function(r){return r&&t!=null&&r[s]===t})}}v(U,"queryByIdOrName");function V(s,o){return o.hasOwnProperty("subType")?i.filter(s,function(e){return e&&e.subType===o.subType}):s}v(V,"filterBySubType");function z(s){var o=i.createHashMap();return s&&i.each(d.normalizeToArray(s.replaceMerge),function(e){process.env.NODE_ENV!=="production"&&i.assert(g.default.hasClass(e),'"'+e+'" is not valid component main type in "replaceMerge"'),o.set(e,!0)}),{replaceMergeMainTypeMap:o}}v(z,"normalizeSetOptionInput");i.mixin(F,J.PaletteMixin);exports.default=F;
