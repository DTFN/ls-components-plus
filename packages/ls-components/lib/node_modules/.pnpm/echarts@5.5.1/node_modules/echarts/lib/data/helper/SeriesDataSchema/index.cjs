"use strict";var M=Object.defineProperty;var m=(i,t)=>M(i,"name",{value:t,configurable:!0});Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const v=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),N=require("../../../util/model/index.cjs"),_=require("../../Source/index.cjs");var y=N.makeInner(),$={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},S=function(){function i(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return m(i,"SeriesDataSchema"),i.prototype.isDimensionOmitted=function(){return this._dimOmitted},i.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=C(this.source)))},i.prototype.getSourceDimensionIndex=function(t){return v.retrieve2(this._dimNameMap.get(t),-1)},i.prototype.getSourceDimension=function(t){var e=this.source.dimensionsDefine;if(e)return e[t]},i.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,e=_.shouldRetrieveDataByName(this.source),a=!O(t),n="",o=[],r=0,l=0;r<t;r++){var u=void 0,c=void 0,h=void 0,s=this.dimensions[l];if(s&&s.storeDimIndex===r)u=e?s.name:null,c=s.type,h=s.ordinalMeta,l++;else{var d=this.getSourceDimension(r);d&&(u=e?d.name:null,c=d.type)}o.push({property:u,type:c,ordinalMeta:h}),e&&u!=null&&(!s||!s.isCalculationCoord)&&(n+=a?u.replace(/\`/g,"`1").replace(/\$/g,"`2"):u),n+="$",n+=$[c]||"f",h&&(n+=h.uid),n+="$"}var p=this.source,g=[p.seriesLayoutBy,p.startIndex,n].join("$$");return{dimensions:o,hash:g}},i.prototype.makeOutputDimensionNames=function(){for(var t=[],e=0,a=0;e<this._fullDimCount;e++){var n=void 0,o=this.dimensions[a];if(o&&o.storeDimIndex===e)o.isCalculationCoord||(n=o.name),a++;else{var r=this.getSourceDimension(e);r&&(n=r.name)}t.push(n)}return t},i.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},i}();function b(i){return i instanceof S}m(b,"isSeriesDataSchema");function f(i){for(var t=v.createHashMap(),e=0;e<(i||[]).length;e++){var a=i[e],n=v.isObject(a)?a.name:a;n!=null&&t.get(n)==null&&t.set(n,e)}return t}m(f,"createDimNameMap");function C(i){var t=y(i);return t.dimNameMap||(t.dimNameMap=f(i.dimensionsDefine))}m(C,"ensureSourceDimNameMap");function O(i){return i>30}m(O,"shouldOmitUnusedDimensions");exports.SeriesDataSchema=S;exports.createDimNameMap=f;exports.ensureSourceDimNameMap=C;exports.isSeriesDataSchema=b;exports.shouldOmitUnusedDimensions=O;
