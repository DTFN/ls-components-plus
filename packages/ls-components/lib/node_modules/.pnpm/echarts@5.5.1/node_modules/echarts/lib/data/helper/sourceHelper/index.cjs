"use strict";var U=Object.defineProperty;var g=(r,a)=>U(r,"name",{value:a,configurable:!0});Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const M=require("../../../util/model/index.cjs"),N=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),_=require("../../../util/types/index.cjs");var o={Must:1,Might:2,Not:3},T=M.makeInner();function W(r){T(r).datasetMap=N.createHashMap()}g(W,"resetSourceDefaulter");function B(r,a,p){var l={},R=C(a);if(!R||!r)return l;var d=[],n=[],y=a.ecModel,c=T(y).datasetMap,S=R.uid+"_"+p.seriesLayoutBy,t,f;r=r.slice(),N.each(r,function(s,i){var m=N.isObject(s)?s:r[i]={name:s};m.type==="ordinal"&&t==null&&(t=i,f=E(m)),l[m.name]=[]});var v=c.get(S)||c.set(S,{categoryWayDim:f,valueWayDim:0});N.each(r,function(s,i){var m=s.name,u=E(s);if(t==null){var O=v.valueWayDim;e(l[m],O,u),e(n,O,u),v.valueWayDim+=u}else if(t===i)e(l[m],0,u),e(d,0,u);else{var O=v.categoryWayDim;e(l[m],O,u),e(n,O,u),v.categoryWayDim+=u}});function e(s,i,m){for(var u=0;u<m;u++)s.push(i+u)}g(e,"pushDim");function E(s){var i=s.dimsDef;return i?i.length:1}return g(E,"getDataDimCountOnCoordDim"),d.length&&(l.itemName=d),n.length&&(l.seriesName=n),l}g(B,"makeSeriesEncodeForAxisCoordSys");function L(r,a,p){var l={},R=C(r);if(!R)return l;var d=a.sourceFormat,n=a.dimensionsDefine,y;(d===_.SOURCE_FORMAT_OBJECT_ROWS||d===_.SOURCE_FORMAT_KEYED_COLUMNS)&&N.each(n,function(t,f){(N.isObject(t)?t.name:t)==="name"&&(y=f)});var c=function(){for(var t={},f={},v=[],e=0,E=Math.min(5,p);e<E;e++){var s=F(a.data,d,a.seriesLayoutBy,n,a.startIndex,e);v.push(s);var i=s===o.Not;if(i&&t.v==null&&e!==y&&(t.v=e),(t.n==null||t.n===t.v||!i&&v[t.n]===o.Not)&&(t.n=e),m(t)&&v[t.n]!==o.Not)return t;i||(s===o.Might&&f.v==null&&e!==y&&(f.v=e),(f.n==null||f.n===f.v)&&(f.n=e))}function m(u){return u.v!=null&&u.n!=null}return g(m,"fulfilled"),m(t)?t:m(f)?f:null}();if(c){l.value=[c.v];var S=y??c.n;l.itemName=[S],l.seriesName=[S]}return l}g(L,"makeSeriesEncodeForNameBased");function C(r){var a=r.get("data",!0);if(!a)return M.queryReferringComponents(r.ecModel,"dataset",{index:r.get("datasetIndex",!0),id:r.get("datasetId",!0)},M.SINGLE_REFERRING).models[0]}g(C,"querySeriesUpstreamDatasetModel");function q(r){return!r.get("transform",!0)&&!r.get("fromTransformResult",!0)?[]:M.queryReferringComponents(r.ecModel,"dataset",{index:r.get("fromDatasetIndex",!0),id:r.get("fromDatasetId",!0)},M.SINGLE_REFERRING).models}g(q,"queryDatasetUpstreamDatasetModels");function I(r,a){return F(r.data,r.sourceFormat,r.seriesLayoutBy,r.dimensionsDefine,r.startIndex,a)}g(I,"guessOrdinal");function F(r,a,p,l,R,d){var n,y=5;if(N.isTypedArray(r))return o.Not;var c,S;if(l){var t=l[d];N.isObject(t)?(c=t.name,S=t.type):N.isString(t)&&(c=t)}if(S!=null)return S==="ordinal"?o.Must:o.Not;if(a===_.SOURCE_FORMAT_ARRAY_ROWS){var f=r;if(p===_.SERIES_LAYOUT_BY_ROW){for(var v=f[d],e=0;e<(v||[]).length&&e<y;e++)if((n=D(v[R+e]))!=null)return n}else for(var e=0;e<f.length&&e<y;e++){var E=f[R+e];if(E&&(n=D(E[d]))!=null)return n}}else if(a===_.SOURCE_FORMAT_OBJECT_ROWS){var s=r;if(!c)return o.Not;for(var e=0;e<s.length&&e<y;e++){var i=s[e];if(i&&(n=D(i[c]))!=null)return n}}else if(a===_.SOURCE_FORMAT_KEYED_COLUMNS){var m=r;if(!c)return o.Not;var v=m[c];if(!v||N.isTypedArray(v))return o.Not;for(var e=0;e<v.length&&e<y;e++)if((n=D(v[e]))!=null)return n}else if(a===_.SOURCE_FORMAT_ORIGINAL)for(var u=r,e=0;e<u.length&&e<y;e++){var i=u[e],O=M.getDataItemValue(i);if(!N.isArray(O))return o.Not;if((n=D(O[d]))!=null)return n}function D(h){var A=N.isString(h);if(h!=null&&Number.isFinite(Number(h))&&h!=="")return A?o.Might:o.Not;if(A&&h!=="-")return o.Must}return g(D,"detectValue"),o.Not}g(F,"doGuessOrdinal");exports.BE_ORDINAL=o;exports.guessOrdinal=I;exports.makeSeriesEncodeForAxisCoordSys=B;exports.makeSeriesEncodeForNameBased=L;exports.queryDatasetUpstreamDatasetModels=q;exports.querySeriesUpstreamDatasetModel=C;exports.resetSourceDefaulter=W;
