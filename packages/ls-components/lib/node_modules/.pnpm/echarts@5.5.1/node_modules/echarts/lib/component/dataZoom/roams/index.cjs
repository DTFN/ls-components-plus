"use strict";var m=Object.defineProperty;var u=(t,o)=>m(t,"name",{value:o,configurable:!0});Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const y=require("../../helper/RoamController/index.cjs"),h=require("../../../util/throttle/index.cjs"),M=require("../../../util/model/index.cjs"),d=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),g=require("../helper/index.cjs");var p=M.makeInner();function R(t,o,e){p(t).coordSysRecordMap.each(function(c){var a=c.dataZoomInfoMap.get(o.uid);a&&(a.getRange=e)})}u(R,"setViewInfoToCoordSysRecord");function I(t,o){for(var e=p(t).coordSysRecordMap,c=e.keys(),a=0;a<c.length;a++){var n=c[a],i=e.get(n),r=i.dataZoomInfoMap;if(r){var s=o.uid,l=r.get(s);l&&(r.removeKey(s),r.keys().length||v(e,i))}}}u(I,"disposeCoordSysRecordIfNeeded");function v(t,o){if(o){t.removeKey(o.model.uid);var e=o.controller;e&&e.dispose()}}u(v,"disposeCoordSysRecord");function S(t,o){var e={model:o,containsPoint:d.curry(C,o),dispatchAction:d.curry(P,t),dataZoomInfoMap:null,controller:null},c=e.controller=new y.default(t.getZr());return d.each(["pan","zoom","scrollMove"],function(a){c.on(a,function(n){var i=[];e.dataZoomInfoMap.each(function(r){if(n.isAvailableBehavior(r.model.option)){var s=(r.getRange||{})[a],l=s&&s(r.dzReferCoordSysInfo,e.model.mainType,e.controller,n);!r.model.get("disabled",!0)&&l&&i.push({dataZoomId:r.model.id,start:l[0],end:l[1]})}}),i.length&&e.dispatchAction(i)})}),e}u(S,"createCoordSysRecord");function P(t,o){t.isDisposed()||t.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:o})}u(P,"dispatchAction");function C(t,o,e,c){return t.coordinateSystem.containPoint([e,c])}u(C,"containsPoint");function T(t){var o,e="type_",c={type_true:2,type_move:1,type_false:0,type_undefined:-1},a=!0;return t.each(function(n){var i=n.model,r=i.get("disabled",!0)?!1:i.get("zoomLock",!0)?"move":!0;c[e+r]>c[e+o]&&(o=r),a=a&&i.get("preventDefaultMouseMove",!0)}),{controlType:o,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!a}}}u(T,"mergeControllerParams");function Z(t){t.registerProcessor(t.PRIORITY.PROCESSOR.FILTER,function(o,e){var c=p(e),a=c.coordSysRecordMap||(c.coordSysRecordMap=d.createHashMap());a.each(function(n){n.dataZoomInfoMap=null}),o.eachComponent({mainType:"dataZoom",subType:"inside"},function(n){var i=g.collectReferCoordSysModelInfo(n);d.each(i.infoList,function(r){var s=r.model.uid,l=a.get(s)||a.set(s,S(e,r.model)),f=l.dataZoomInfoMap||(l.dataZoomInfoMap=d.createHashMap());f.set(n.uid,{dzReferCoordSysInfo:r,model:n,getRange:null})})}),a.each(function(n){var i=n.controller,r,s=n.dataZoomInfoMap;if(s){var l=s.keys()[0];l!=null&&(r=s.get(l))}if(!r){v(a,n);return}var f=T(s);i.enable(f.controlType,f.opt),i.setPointerChecker(n.containsPoint),h.createOrUpdate(n,"dispatchAction",r.model.get("throttle",!0),"fixRate")})})}u(Z,"installDataZoomRoamProcessor");exports.disposeCoordSysRecordIfNeeded=I;exports.installDataZoomRoamProcessor=Z;exports.setViewInfoToCoordSysRecord=R;
