"use strict";var _=Object.defineProperty;var b=(v,s)=>_(v,"name",{value:s,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const A=require("../../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),h=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),M=require("../../../util/states/index.cjs"),G=require("../../../view/Chart/index.cjs"),w=require("../labelLayout/index.cjs"),x=require("../../../label/labelGuideHelper/index.cjs"),C=require("../../../label/labelStyle/index.cjs"),S=require("../../helper/sectorHelper/index.cjs"),f=require("../../../animation/basicTransition/index.cjs"),T=require("../pieLayout/index.cjs"),D=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Text/index.cjs"),E=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/shape/Polyline/index.cjs"),q=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/shape/Sector/index.cjs");var O=function(v){A.__extends(s,v);function s(t,r,n){var o=v.call(this)||this;o.z2=2;var e=new D.default;return o.setTextContent(e),o.updateData(t,r,n,!0),o}return b(s,"PiePiece"),s.prototype.updateData=function(t,r,n,o){var e=this,l=t.hostModel,i=t.getItemModel(r),u=i.getModel("emphasis"),a=t.getItemLayout(r),c=h.extend(S.getSectorCornerRadius(i.getModel("itemStyle"),a,!0),a);if(isNaN(c.startAngle)){e.setShape(c);return}if(o){e.setShape(c);var m=l.getShallow("animationType");l.ecModel.ssr?(f.initProps(e,{scaleX:0,scaleY:0},l,{dataIndex:r,isFrom:!0}),e.originX=c.cx,e.originY=c.cy):m==="scale"?(e.shape.r=a.r0,f.initProps(e,{shape:{r:a.r}},l,r)):n!=null?(e.setShape({startAngle:n,endAngle:n}),f.initProps(e,{shape:{startAngle:a.startAngle,endAngle:a.endAngle}},l,r)):(e.shape.endAngle=a.startAngle,f.updateProps(e,{shape:{endAngle:a.endAngle}},l,r))}else f.saveOldStyle(e),f.updateProps(e,{shape:c},l,r);e.useStyle(t.getItemVisual(r,"style")),M.setStatesStylesFromModel(e,i);var p=(a.startAngle+a.endAngle)/2,g=l.get("selectedOffset"),d=Math.cos(p)*g,y=Math.sin(p)*g,L=i.getShallow("cursor");L&&e.attr("cursor",L),this._updateLabel(l,t,r),e.ensureState("emphasis").shape=h.extend({r:a.r+(u.get("scale")&&u.get("scaleSize")||0)},S.getSectorCornerRadius(u.getModel("itemStyle"),a)),h.extend(e.ensureState("select"),{x:d,y,shape:S.getSectorCornerRadius(i.getModel(["select","itemStyle"]),a)}),h.extend(e.ensureState("blur"),{shape:S.getSectorCornerRadius(i.getModel(["blur","itemStyle"]),a)});var P=e.getTextGuideLine(),I=e.getTextContent();P&&h.extend(P.ensureState("select"),{x:d,y}),h.extend(I.ensureState("select"),{x:d,y}),M.toggleHoverEmphasis(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},s.prototype._updateLabel=function(t,r,n){var o=this,e=r.getItemModel(n),l=e.getModel("labelLine"),i=r.getItemVisual(n,"style"),u=i&&i.fill,a=i&&i.opacity;C.setLabelStyle(o,C.getLabelStatesModels(e),{labelFetcher:r.hostModel,labelDataIndex:n,inheritColor:u,defaultOpacity:a,defaultText:t.getFormattedLabel(n,"normal")||r.getName(n)});var c=o.getTextContent();o.setTextConfig({position:null,rotation:null}),c.attr({z2:10});var m=t.get(["label","position"]);if(m!=="outside"&&m!=="outer")o.removeTextGuideLine();else{var p=this.getTextGuideLine();p||(p=new E.default,this.setTextGuideLine(p)),x.setLabelLineStyle(this,x.getLabelLineStatesModels(e),{stroke:u,opacity:h.retrieve3(l.get(["lineStyle","opacity"]),a,1)})}},s}(q.default),F=function(v){A.__extends(s,v);function s(){var t=v!==null&&v.apply(this,arguments)||this;return t.ignoreLabelLineUpdate=!0,t}return b(s,"PieView"),s.prototype.render=function(t,r,n,o){var e=t.getData(),l=this._data,i=this.group,u;if(!l&&e.count()>0){for(var a=e.getItemLayout(0),c=1;isNaN(a&&a.startAngle)&&c<e.count();++c)a=e.getItemLayout(c);a&&(u=a.startAngle)}if(this._emptyCircleSector&&i.remove(this._emptyCircleSector),e.count()===0&&t.get("showEmptyCircle")){var m=T.getSeriesLayoutData(t),p=new q.default({shape:h.extend(T.getBasicPieLayout(t,n),m)});p.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=p,i.add(p)}e.diff(l).add(function(g){var d=new O(e,g,u);e.setItemGraphicEl(g,d),i.add(d)}).update(function(g,d){var y=l.getItemGraphicEl(d);y.updateData(e,g,u),y.off("click"),i.add(y),e.setItemGraphicEl(g,y)}).remove(function(g){var d=l.getItemGraphicEl(g);f.removeElementWithFadeOut(d,t,g)}).execute(),w.default(t),t.get("animationTypeUpdate")!=="expansion"&&(this._data=e)},s.prototype.dispose=function(){},s.prototype.containPoint=function(t,r){var n=r.getData(),o=n.getItemLayout(0);if(o){var e=t[0]-o.cx,l=t[1]-o.cy,i=Math.sqrt(e*e+l*l);return i<=o.r&&i>=o.r0}},s.type="pie",s}(G.default);exports.default=F;
