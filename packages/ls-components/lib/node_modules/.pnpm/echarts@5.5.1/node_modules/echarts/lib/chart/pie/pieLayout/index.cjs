"use strict";var U=Object.defineProperty;var q=(c,g)=>U(c,"name",{value:g,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const N=require("../../../util/number/index.cjs"),X=require("../../../util/layout/index.cjs"),O=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),Y=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/PathProxy/index.cjs"),$=require("../../../util/model/index.cjs");var V=Math.PI*2,b=Math.PI/180;function F(c,g){return X.getLayoutRect(c.getBoxLayoutParams(),{width:g.getWidth(),height:g.getHeight()})}q(F,"getViewRect");function G(c,g){var m=F(c,g),e=c.get("center"),a=c.get("radius");O.isArray(a)||(a=[0,a]);var s=N.parsePercent(m.width,g.getWidth()),R=N.parsePercent(m.height,g.getHeight()),A=Math.min(s,R),S=N.parsePercent(a[0],A/2),x=N.parsePercent(a[1],A/2),f,l,t=c.coordinateSystem;if(t){var o=t.dataToPoint(e);f=o[0]||0,l=o[1]||0}else O.isArray(e)||(e=[e,e]),f=N.parsePercent(e[0],s)+m.x,l=N.parsePercent(e[1],R)+m.y;return{cx:f,cy:l,r0:S,r:x}}q(G,"getBasicPieLayout");function E(c,g,m){g.eachSeriesByType(c,function(e){var a=e.getData(),s=a.mapDimension("value"),R=F(e,m),A=G(e,m),S=A.cx,x=A.cy,f=A.r,l=A.r0,t=-e.get("startAngle")*b,o=e.get("endAngle"),L=e.get("padAngle")*b;o=o==="auto"?t-V:-o*b;var K=e.get("minAngle")*b,d=K+L,p=0;a.each(s,function(v){!isNaN(v)&&p++});var Z=a.getSum(s),k=Math.PI/(Z||p)*2,I=e.get("clockwise"),B=e.get("roseType"),Q=e.get("stillShowZeroSum"),j=a.getDataExtent(s);j[0]=0;var u=I?1:-1,z=[t,o],w=u*L/2;Y.normalizeArcAngles(z,!I),t=z[0],o=z[1];var H=J(e);H.startAngle=t,H.endAngle=o,H.clockwise=I;var W=Math.abs(o-t),T=W,C=0,h=t;if(a.setLayout({viewRect:R,r:f}),a.each(s,function(v,y){var r;if(isNaN(v)){a.setItemLayout(y,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:I,cx:S,cy:x,r0:l,r:B?NaN:f});return}B!=="area"?r=Z===0&&Q?k:v*k:r=W/p,r<d?(r=d,T-=d):C+=v;var i=h+u*r,n=0,P=0;L>r?(n=h+u*r/2,P=n):(n=h+w,P=i-w),a.setItemLayout(y,{angle:r,startAngle:n,endAngle:P,clockwise:I,cx:S,cy:x,r0:l,r:B?N.linearMap(v,j,[l,f]):f}),h=i}),T<V&&p)if(T<=.001){var D=W/p;a.each(s,function(v,y){if(!isNaN(v)){var r=a.getItemLayout(y);r.angle=D;var i=0,n=0;D<L?(i=t+u*(y+1/2)*D,n=i):(i=t+u*y*D+w,n=t+u*(y+1)*D-w),r.startAngle=i,r.endAngle=n}})}else k=T/C,h=t,a.each(s,function(v,y){if(!isNaN(v)){var r=a.getItemLayout(y),i=r.angle===d?d:v*k,n=0,P=0;i<L?(n=h+u*i/2,P=n):(n=h+w,P=h+u*i-w),r.startAngle=n,r.endAngle=P,h+=u*i}})})}q(E,"pieLayout");var J=$.makeInner();exports.default=E;exports.getBasicPieLayout=G;exports.getSeriesLayoutData=J;
