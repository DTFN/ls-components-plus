"use strict";var S=Object.defineProperty;var C=(o,t)=>S(o,"name",{value:t,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const M=require("../../../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),A=require("../../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/env/index.cjs"),B=require("../../featureManager/index.cjs");var E=function(o){M.__extends(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return C(t,"SaveAsImage"),t.prototype.onclick=function(n,r){var e=this.model,u=e.get("name")||n.get("title.0.text")||"echarts",c=r.getZr().painter.getType()==="svg",g=c?"svg":e.get("type",!0)||"png",v=r.getConnectedDataURL({type:g,backgroundColor:e.get("backgroundColor",!0)||n.get("backgroundColor")||"#fff",connectedBackgroundColor:e.get("connectedBackgroundColor"),excludeComponents:e.get("excludeComponents"),pixelRatio:e.get("pixelRatio")}),s=A.default.browser;if(typeof MouseEvent=="function"&&(s.newEdge||!s.ie&&!s.edge)){var l=document.createElement("a");l.download=u+"."+g,l.target="_blank",l.href=v;var h=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});l.dispatchEvent(h)}else if(window.navigator.msSaveOrOpenBlob||c){var m=v.split(","),O=m[0].indexOf("base64")>-1,a=c?decodeURIComponent(m[1]):m[1];O&&(a=window.atob(a));var f=u+"."+g;if(window.navigator.msSaveOrOpenBlob){for(var i=a.length,w=new Uint8Array(i);i--;)w[i]=a.charCodeAt(i);var k=new Blob([w]);window.navigator.msSaveOrOpenBlob(k,f)}else{var p=document.createElement("iframe");document.body.appendChild(p);var b=p.contentWindow,d=b.document;d.open("image/svg+xml","replace"),d.write(a),d.close(),b.focus(),d.execCommand("SaveAs",!0,f),document.body.removeChild(p)}}else{var y=e.get("lang"),L='<body style="margin:0;"><img src="'+v+'" style="max-width:100%;" title="'+(y&&y[0]||"")+'" /></body>',x=window.open();x.document.write(L),x.document.title=u}},t.getDefaultOption=function(n){var r={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:n.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:n.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return r},t}(B.ToolboxFeature);exports.default=E;
