"use strict";var Y=Object.defineProperty;var m=(a,e)=>Y(a,"name",{value:e,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const c=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),M=require("../../../util/graphic/index.cjs"),Z=require("../../../util/innerStore/index.cjs"),j=require("../../../label/labelStyle/index.cjs"),$=require("../../../model/Model/index.cjs"),R=require("../../../util/number/index.cjs"),_=require("../../../util/symbol/index.cjs"),D=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/matrix/index.cjs"),O=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/vector/index.cjs"),ee=require("../../../coord/axisHelper/index.cjs"),P=require("../../../label/labelLayoutHelper/index.cjs"),W=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Group/index.cjs"),z=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/shape/Line/index.cjs"),E=require("../../../../../../../zrender@5.6.0/node_modules/zrender/lib/graphic/Text/index.cjs");var A=Math.PI,k=function(){function a(e,t){this.group=new W.default,this.opt=t,this.axisModel=e,c.defaults(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:m(function(){return!0},"handleAutoShown")});var i=new W.default({x:t.position[0],y:t.position[1],rotation:t.rotation});i.updateTransform(),this._transformGroup=i}return m(a,"AxisBuilder"),a.prototype.hasBuilder=function(e){return!!F[e]},a.prototype.add=function(e){F[e](this.opt,this.axisModel,this.group,this._transformGroup)},a.prototype.getGroup=function(){return this.group},a.innerTextLayout=function(e,t,i){var r=R.remRadian(t-e),l,n;return R.isRadianAroundZero(r)?(n=i>0?"top":"bottom",l="center"):R.isRadianAroundZero(r-A)?(n=i>0?"bottom":"top",l="center"):(n="middle",r>0&&r<A?l=i>0?"right":"left":l=i>0?"left":"right"),{rotation:r,textAlign:l,textVerticalAlign:n}},a.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},a.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)},a}(),F={axisLine:m(function(a,e,t,i){var r=e.get(["axisLine","show"]);if(r==="auto"&&a.handleAutoShown&&(r=a.handleAutoShown("axisLine")),!!r){var l=e.axis.getExtent(),n=i.transform,o=[l[0],0],s=[l[1],0],g=o[0]>s[0];n&&(O.applyTransform(o,o,n),O.applyTransform(s,s,n));var u=c.extend({lineCap:"round"},e.getModel(["axisLine","lineStyle"]).getLineStyle()),f=new z.default({shape:{x1:o[0],y1:o[1],x2:s[0],y2:s[1]},style:u,strokeContainThreshold:a.strokeContainThreshold||5,silent:!0,z2:1});M.subPixelOptimizeLine(f.shape,f.style.lineWidth),f.anid="line",t.add(f);var v=e.get(["axisLine","symbol"]);if(v!=null){var h=e.get(["axisLine","symbolSize"]);c.isString(v)&&(v=[v,v]),(c.isString(h)||c.isNumber(h))&&(h=[h,h]);var x=_.normalizeSymbolOffset(e.get(["axisLine","symbolOffset"])||0,h),T=h[0],b=h[1];c.each([{rotate:a.rotation+Math.PI/2,offset:x[0],r:0},{rotate:a.rotation-Math.PI/2,offset:x[1],r:Math.sqrt((o[0]-s[0])*(o[0]-s[0])+(o[1]-s[1])*(o[1]-s[1]))}],function(L,S){if(v[S]!=="none"&&v[S]!=null){var y=_.createSymbol(v[S],-T/2,-b/2,T,b,u.stroke,!0),d=L.r+L.offset,C=g?s:o;y.attr({rotation:L.rotate,x:C[0]+d*Math.cos(a.rotation),y:C[1]-d*Math.sin(a.rotation),silent:!0,z2:11}),t.add(y)}})}}},"axisLine"),axisTickLabel:m(function(a,e,t,i){var r=re(t,i,e,a),l=ie(t,i,e,a);if(ae(e,l,r),ne(t,i,e,a.tickDirection),e.get(["axisLabel","hideOverlap"])){var n=P.prepareLayoutList(c.map(l,function(o){return{label:o,priority:o.z2,defaultAttr:{ignore:o.ignore}}}));P.hideOverlap(n)}},"axisTickLabel"),axisName:m(function(a,e,t,i){var r=c.retrieve(a.axisName,e.get("name"));if(r){var l=e.get("nameLocation"),n=a.nameDirection,o=e.getModel("nameTextStyle"),s=e.get("nameGap")||0,g=e.axis.getExtent(),u=g[0]>g[1]?-1:1,f=[l==="start"?g[0]-u*s:l==="end"?g[1]+u*s:(g[0]+g[1])/2,I(l)?a.labelOffset+n*s:0],v,h=e.get("nameRotate");h!=null&&(h=h*A/180);var x;I(l)?v=k.innerTextLayout(a.rotation,h??a.rotation,n):(v=te(a.rotation,l,h||0,g),x=a.axisNameAvailableWidth,x!=null&&(x=Math.abs(x/Math.sin(v.rotation)),!isFinite(x)&&(x=null)));var T=o.getFont(),b=e.get("nameTruncate",!0)||{},L=b.ellipsis,S=c.retrieve(a.nameTruncateMaxWidth,b.maxWidth,x),y=new E.default({x:f[0],y:f[1],rotation:v.rotation,silent:k.isLabelSilent(e),style:j.createTextStyle(o,{text:r,font:T,overflow:"truncate",width:S,ellipsis:L,fill:o.getTextColor()||e.get(["axisLine","lineStyle","color"]),align:o.get("align")||v.textAlign,verticalAlign:o.get("verticalAlign")||v.textVerticalAlign}),z2:1});if(M.setTooltipConfig({el:y,componentModel:e,itemName:r}),y.__fullText=r,y.anid="name",e.get("triggerEvent")){var d=k.makeAxisEventDataBase(e);d.targetType="axisName",d.name=r,Z.getECData(y).eventData=d}i.add(y),y.updateTransform(),t.add(y),y.decomposeTransform()}},"axisName")};function te(a,e,t,i){var r=R.remRadian(t-a),l,n,o=i[0]>i[1],s=e==="start"&&!o||e!=="start"&&o;return R.isRadianAroundZero(r-A/2)?(n=s?"bottom":"top",l="center"):R.isRadianAroundZero(r-A*1.5)?(n=s?"top":"bottom",l="center"):(n="middle",r<A*1.5&&r>A/2?l=s?"left":"right":l=s?"right":"left"),{rotation:r,textAlign:l,textVerticalAlign:n}}m(te,"endTextLayout");function ae(a,e,t){if(!ee.shouldShowAllLabels(a.axis)){var i=a.get(["axisLabel","showMinLabel"]),r=a.get(["axisLabel","showMaxLabel"]);e=e||[],t=t||[];var l=e[0],n=e[1],o=e[e.length-1],s=e[e.length-2],g=t[0],u=t[1],f=t[t.length-1],v=t[t.length-2];i===!1?(p(l),p(g)):G(l,n)&&(i?(p(n),p(u)):(p(l),p(g))),r===!1?(p(o),p(f)):G(s,o)&&(r?(p(s),p(v)):(p(o),p(f)))}}m(ae,"fixMinMaxLabelShow");function p(a){a&&(a.ignore=!0)}m(p,"ignoreEl");function G(a,e){var t=a&&a.getBoundingRect().clone(),i=e&&e.getBoundingRect().clone();if(!(!t||!i)){var r=D.identity([]);return D.rotate(r,r,-a.rotation),t.applyTransform(D.mul([],r,a.getLocalTransform())),i.applyTransform(D.mul([],r,e.getLocalTransform())),t.intersect(i)}}m(G,"isTwoLabelOverlapped");function I(a){return a==="middle"||a==="center"}m(I,"isNameLocationCenter");function H(a,e,t,i,r){for(var l=[],n=[],o=[],s=0;s<a.length;s++){var g=a[s].coord;n[0]=g,n[1]=0,o[0]=g,o[1]=t,e&&(O.applyTransform(n,n,e),O.applyTransform(o,o,e));var u=new z.default({shape:{x1:n[0],y1:n[1],x2:o[0],y2:o[1]},style:i,z2:2,autoBatch:!0,silent:!0});M.subPixelOptimizeLine(u.shape,u.style.lineWidth),u.anid=r+"_"+a[s].tickValue,l.push(u)}return l}m(H,"createTicks");function re(a,e,t,i){var r=t.axis,l=t.getModel("axisTick"),n=l.get("show");if(n==="auto"&&i.handleAutoShown&&(n=i.handleAutoShown("axisTick")),!(!n||r.scale.isBlank())){for(var o=l.getModel("lineStyle"),s=i.tickDirection*l.get("length"),g=r.getTicksCoords(),u=H(g,e.transform,s,c.defaults(o.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}),"ticks"),f=0;f<u.length;f++)a.add(u[f]);return u}}m(re,"buildAxisMajorTicks");function ne(a,e,t,i){var r=t.axis,l=t.getModel("minorTick");if(!(!l.get("show")||r.scale.isBlank())){var n=r.getMinorTicksCoords();if(n.length)for(var o=l.getModel("lineStyle"),s=i*l.get("length"),g=c.defaults(o.getLineStyle(),c.defaults(t.getModel("axisTick").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})),u=0;u<n.length;u++)for(var f=H(n[u],e.transform,s,g,"minorticks_"+u),v=0;v<f.length;v++)a.add(f[v])}}m(ne,"buildAxisMinorTicks");function ie(a,e,t,i){var r=t.axis,l=c.retrieve(i.axisLabelShow,t.get(["axisLabel","show"]));if(!(!l||r.scale.isBlank())){var n=t.getModel("axisLabel"),o=n.get("margin"),s=r.getViewLabels(),g=(c.retrieve(i.labelRotate,n.get("rotate"))||0)*A/180,u=k.innerTextLayout(i.rotation,g,i.labelDirection),f=t.getCategories&&t.getCategories(!0),v=[],h=k.isLabelSilent(t),x=t.get("triggerEvent");return c.each(s,function(T,b){var L=r.scale.type==="ordinal"?r.scale.getRawOrdinalNumber(T.tickValue):T.tickValue,S=T.formattedLabel,y=T.rawLabel,d=n;if(f&&f[L]){var C=f[L];c.isObject(C)&&C.textStyle&&(d=new $.default(C.textStyle,n,t.ecModel))}var B=d.getTextColor()||t.get(["axisLine","lineStyle","color"]),J=r.dataToCoord(L),V=d.getShallow("align",!0)||u.textAlign,K=c.retrieve2(d.getShallow("alignMinLabel",!0),V),Q=c.retrieve2(d.getShallow("alignMaxLabel",!0),V),N=d.getShallow("verticalAlign",!0)||d.getShallow("baseline",!0)||u.textVerticalAlign,U=c.retrieve2(d.getShallow("verticalAlignMinLabel",!0),N),X=c.retrieve2(d.getShallow("verticalAlignMaxLabel",!0),N),w=new E.default({x:J,y:i.labelOffset+i.labelDirection*o,rotation:u.rotation,silent:h,z2:10+(T.level||0),style:j.createTextStyle(d,{text:S,align:b===0?K:b===s.length-1?Q:V,verticalAlign:b===0?U:b===s.length-1?X:N,fill:c.isFunction(B)?B(r.type==="category"?y:r.type==="value"?L+"":L,b):B})});if(w.anid="label_"+L,x){var q=k.makeAxisEventDataBase(t);q.targetType="axisLabel",q.value=y,q.tickIndex=b,r.type==="category"&&(q.dataIndex=L),Z.getECData(w).eventData=q}e.add(w),w.updateTransform(),v.push(w),a.add(w),w.decomposeTransform()}),v}}m(ie,"buildAxisLabel");exports.default=k;
