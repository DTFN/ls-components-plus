"use strict";var Z=Object.defineProperty;var u=(o,e)=>Z(o,"name",{value:e,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const _=require("../../../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),A=require("../../../../../../../../zrender@5.6.0/node_modules/zrender/lib/core/util/index.cjs"),M=require("../../../helper/BrushController/index.cjs"),g=require("../../../helper/BrushTargetManager/index.cjs"),b=require("../../../dataZoom/history/index.cjs"),C=require("../../../helper/sliderMove/index.cjs"),S=require("../../featureManager/index.cjs"),I=require("../../../../util/model/index.cjs"),k=require("../../../../model/internalComponentCreator/index.cjs");var v=A.each,T=I.makeInternalComponentId("toolbox-dataZoom_"),D=function(o){_.__extends(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return u(e,"DataZoomFeature"),e.prototype.render=function(n,t,r,i){this._brushController||(this._brushController=new M.default(r.getZr()),this._brushController.on("brush",A.bind(this._onBrush,this)).mount()),q(n,t,this,i,r),B(n,t)},e.prototype.onclick=function(n,t,r){O[r].call(this)},e.prototype.remove=function(n,t){this._brushController&&this._brushController.unmount()},e.prototype.dispose=function(n,t){this._brushController&&this._brushController.dispose()},e.prototype._onBrush=function(n){var t=n.areas;if(!n.isEnd||!t.length)return;var r={},i=this.ecModel;this._brushController.updateCovers([]);var x=new g.default(y(this.model),i,{include:["grid"]});x.matchOutputRanges(t,i,function(h,d,a){if(a.type==="cartesian2d"){var l=h.brushType;l==="rect"?(c("x",a,d[0]),c("y",a,d[1])):c({lineX:"x",lineY:"y"}[l],a,d)}}),b.push(i,r),this._dispatchZoomAction(r);function c(h,d,a){var l=d.getAxis(h),m=l.model,p=s(h,m,i),f=p.findRepresentativeAxisProxy(m).getMinMaxSpan();(f.minValueSpan!=null||f.maxValueSpan!=null)&&(a=C.default(0,a.slice(),l.scale.getExtent(),0,f.minValueSpan,f.maxValueSpan)),p&&(r[p.id]={dataZoomId:p.id,startValue:a[0],endValue:a[1]})}u(c,"setBatch");function s(h,d,a){var l;return a.eachComponent({mainType:"dataZoom",subType:"select"},function(m){var p=m.getAxisModel(h,d.componentIndex);p&&(l=m)}),l}u(s,"findDataZoom")},e.prototype._dispatchZoomAction=function(n){var t=[];v(n,function(r,i){t.push(A.clone(r))}),t.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:t})},e.getDefaultOption=function(n){var t={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:n.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return t},e}(S.ToolboxFeature),O={zoom:u(function(){var o=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:o})},"zoom"),back:u(function(){this._dispatchZoomAction(b.pop(this.ecModel))},"back")};function y(o){var e={xAxisIndex:o.get("xAxisIndex",!0),yAxisIndex:o.get("yAxisIndex",!0),xAxisId:o.get("xAxisId",!0),yAxisId:o.get("yAxisId",!0)};return e.xAxisIndex==null&&e.xAxisId==null&&(e.xAxisIndex="all"),e.yAxisIndex==null&&e.yAxisId==null&&(e.yAxisIndex="all"),e}u(y,"makeAxisFinder");function B(o,e){o.setIconStatus("back",b.count(e)>1?"emphasis":"normal")}u(B,"updateBackBtnStatus");function q(o,e,n,t,r){var i=n._isZoomActive;t&&t.type==="takeGlobalCursor"&&(i=t.key==="dataZoomSelect"?t.dataZoomSelectActive:!1),n._isZoomActive=i,o.setIconStatus("zoom",i?"emphasis":"normal");var x=new g.default(y(o),e,{include:["grid"]}),c=x.makePanelOpts(r,function(s){return s.xAxisDeclared&&!s.yAxisDeclared?"lineX":!s.xAxisDeclared&&s.yAxisDeclared?"lineY":"rect"});n._brushController.setPanels(c).enableBrush(i&&c.length?{brushType:"auto",brushStyle:o.getModel("brushStyle").getItemStyle()}:!1)}u(q,"updateZoomBtnStatus");k.registerInternalOptionCreator("dataZoom",function(o){var e=o.getComponent("toolbox",0),n=["feature","dataZoom"];if(!e||e.get(n)==null)return;var t=e.getModel(n),r=[],i=y(t),x=I.parseFinder(o,i);v(x.xAxisModels,function(s){return c(s,"xAxis","xAxisIndex")}),v(x.yAxisModels,function(s){return c(s,"yAxis","yAxisIndex")});function c(s,h,d){var a=s.componentIndex,l={type:"select",$fromToolbox:!0,filterMode:t.get("filterMode",!0)||"filter",id:T+h+a};l[d]=a,r.push(l)}return u(c,"buildInternalOptions"),r});exports.default=D;
