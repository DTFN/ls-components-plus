"use strict";var H=Object.defineProperty;var o=(t,e)=>H(t,"name",{value:e,configurable:!0});Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const p=require("../core/env/index.cjs"),c=require("../core/util/index.cjs"),A=require("../Handler/index.cjs"),D=require("../Storage/index.cjs"),l=require("../animation/Animation/index.cjs"),w=require("../dom/HandlerProxy/index.cjs"),y=require("../tool/color/index.cjs"),v=require("../config/index.cjs"),M=require("../graphic/Group/index.cjs");/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var a={},g={};function k(t){delete g[t]}o(k,"delInstance");function P(t){if(!t)return!1;if(typeof t=="string")return y.lum(t,1)<v.DARK_MODE_THRESHOLD;if(t.colorStops){for(var e=t.colorStops,r=0,i=e.length,s=0;s<i;s++)r+=y.lum(e[s].color,1);return r/=i,r<v.DARK_MODE_THRESHOLD}return!1}o(P,"isDarkMode");var q=function(){function t(e,r,i){var s=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,i=i||{},this.dom=r,this.id=e;var f=new D.default,h=i.renderer||"canvas";if(a[h]||(h=c.keys(a)[0]),process.env.NODE_ENV!=="production"&&!a[h])throw new Error("Renderer '"+h+"' is not imported. Please import it first.");i.useDirtyRect=i.useDirtyRect==null?!1:i.useDirtyRect;var n=new a[h](r,f,i,e),d=i.ssr||n.ssrOnly;this.storage=f,this.painter=n;var m=!p.default.node&&!p.default.worker&&!d?new w.default(n.getViewportRoot(),n.root):null,u=i.useCoarsePointer,R=u==null||u==="auto"?p.default.touchEventsSupported:!!u,S=44,_;R&&(_=c.retrieve2(i.pointerSize,S)),this.handler=new A.default(f,n,m,n.root,_),this.animation=new l.default({stage:{update:d?null:function(){return s._flush(!0)}}}),d||this.animation.start()}return o(t,"ZRender"),t.prototype.add=function(e){this._disposed||!e||(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},t.prototype.remove=function(e){this._disposed||!e||(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},t.prototype.configLayer=function(e,r){this._disposed||(this.painter.configLayer&&this.painter.configLayer(e,r),this.refresh())},t.prototype.setBackgroundColor=function(e){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=P(e))},t.prototype.getBackgroundColor=function(){return this._backgroundColor},t.prototype.setDarkMode=function(e){this._darkMode=e},t.prototype.isDarkMode=function(){return this._darkMode},t.prototype.refreshImmediately=function(e){this._disposed||(e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},t.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},t.prototype.flush=function(){this._disposed||this._flush(!1)},t.prototype._flush=function(e){var r,i=l.getTime();this._needsRefresh&&(r=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(r=!0,this.refreshHoverImmediately());var s=l.getTime();r?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:s-i})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},t.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},t.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},t.prototype.refreshHover=function(){this._needsRefreshHover=!0},t.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},t.prototype.resize=function(e){this._disposed||(e=e||{},this.painter.resize(e.width,e.height),this.handler.resize())},t.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},t.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},t.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},t.prototype.setCursorStyle=function(e){this._disposed||this.handler.setCursorStyle(e)},t.prototype.findHover=function(e,r){if(!this._disposed)return this.handler.findHover(e,r)},t.prototype.on=function(e,r,i){return this._disposed||this.handler.on(e,r,i),this},t.prototype.off=function(e,r){this._disposed||this.handler.off(e,r)},t.prototype.trigger=function(e,r){this._disposed||this.handler.trigger(e,r)},t.prototype.clear=function(){if(!this._disposed){for(var e=this.storage.getRoots(),r=0;r<e.length;r++)e[r]instanceof M.default&&e[r].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},t.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,k(this.id))},t}();function T(t,e){var r=new q(c.guid(),t,e);return g[r.id]=r,r}o(T,"init");function z(t,e){a[t]=e}o(z,"registerPainter");exports.init=T;exports.registerPainter=z;
