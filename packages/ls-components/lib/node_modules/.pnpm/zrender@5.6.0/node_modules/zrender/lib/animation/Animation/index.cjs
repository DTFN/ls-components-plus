"use strict";var l=Object.defineProperty;var o=(s,i)=>l(s,"name",{value:i,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const f=require("../../../../../../tslib@2.3.0/node_modules/tslib/tslib.es6/index.cjs"),_=require("../../core/Eventful/index.cjs"),h=require("../requestAnimationFrame/index.cjs"),d=require("../Animator/index.cjs");function r(){return new Date().getTime()}o(r,"getTime");var m=function(s){f.__extends(i,s);function i(t){var e=s.call(this)||this;return e._running=!1,e._time=0,e._pausedTime=0,e._pauseStart=0,e._paused=!1,t=t||{},e.stage=t.stage||{},e}return o(i,"Animation"),i.prototype.addClip=function(t){t.animation&&this.removeClip(t),this._head?(this._tail.next=t,t.prev=this._tail,t.next=null,this._tail=t):this._head=this._tail=t,t.animation=this},i.prototype.addAnimator=function(t){t.animation=this;var e=t.getClip();e&&this.addClip(e)},i.prototype.removeClip=function(t){if(t.animation){var e=t.prev,n=t.next;e?e.next=n:this._head=n,n?n.prev=e:this._tail=e,t.next=t.prev=t.animation=null}},i.prototype.removeAnimator=function(t){var e=t.getClip();e&&this.removeClip(e),t.animation=null},i.prototype.update=function(t){for(var e=r()-this._pausedTime,n=e-this._time,a=this._head;a;){var u=a.next,p=a.step(e,n);p&&(a.ondestroy(),this.removeClip(a)),a=u}this._time=e,t||(this.trigger("frame",n),this.stage.update&&this.stage.update())},i.prototype._startLoop=function(){var t=this;this._running=!0;function e(){t._running&&(h.default(e),!t._paused&&t.update())}o(e,"step"),h.default(e)},i.prototype.start=function(){this._running||(this._time=r(),this._pausedTime=0,this._startLoop())},i.prototype.stop=function(){this._running=!1},i.prototype.pause=function(){this._paused||(this._pauseStart=r(),this._paused=!0)},i.prototype.resume=function(){this._paused&&(this._pausedTime+=r()-this._pauseStart,this._paused=!1)},i.prototype.clear=function(){for(var t=this._head;t;){var e=t.next;t.prev=t.next=t.animation=null,t=e}this._head=this._tail=null},i.prototype.isFinished=function(){return this._head==null},i.prototype.animate=function(t,e){e=e||{},this.start();var n=new d.default(t,e.loop);return this.addAnimator(n),n},i}(_.default);exports.default=m;exports.getTime=r;
