"use strict";var K=Object.defineProperty;var t=(e,l)=>K(e,"name",{value:l,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const o=require("vue"),N=require("../../../button/index/index.cjs"),M=require("../../../tooltip/index/index.cjs"),G=require("../../../scrollbar/index/index.cjs"),U=require("../../../icon/index/index.cjs"),j=require("@element-plus/icons-vue"),q=require("../dropdown/index.cjs"),J=require("../tokens/index.cjs"),W=require("../../../../_virtual/plugin-vue_export-helper/index.cjs"),Y=require("../../../roving-focus-group/src/roving-focus-group2/index.cjs"),Q=require("../../../slot/src/only-child/index.cjs"),X=require("../../../../hooks/use-namespace/index/index.cjs"),Z=require("../../../../hooks/use-locale/index/index.cjs"),E=require("../../../../constants/aria/index.cjs"),x=require("../../../../utils/dom/style/index.cjs"),ee=require("../../../../hooks/use-id/index/index.cjs"),oe=require("../../../form/src/hooks/use-form-common-props/index.cjs"),ne=require("../../../../../../../../lodash-es@4.17.21/node_modules/lodash-es/castArray/index.cjs"),{ButtonGroup:te}=N.ElButton,re=o.defineComponent({name:"ElDropdown",components:{ElButton:N.ElButton,ElButtonGroup:te,ElScrollbar:G.ElScrollbar,ElDropdownCollection:q.ElCollection,ElTooltip:M.ElTooltip,ElRovingFocusGroup:Y.default,ElOnlyChild:Q.OnlyChild,ElIcon:U.ElIcon,ArrowDown:j.ArrowDown},props:q.dropdownProps,emits:["visible-change","click","command"],setup(e,{emit:l}){const y=o.getCurrentInstance(),g=X.useNamespace("dropdown"),{t:B}=Z.useLocale(),a=o.ref(),p=o.ref(),d=o.ref(null),i=o.ref(null),h=o.ref(null),u=o.ref(null),c=o.ref(!1),f=[E.EVENT_CODE.enter,E.EVENT_CODE.space,E.EVENT_CODE.down],b=o.computed(()=>({maxHeight:x.addUnit(e.maxHeight)})),w=o.computed(()=>[g.m(C.value)]),v=o.computed(()=>ne.default(e.trigger)),_=ee.useId().value,T=o.computed(()=>e.id||_);o.watch([a,v],([n,r],[s])=>{var S,k,I;(S=s==null?void 0:s.$el)!=null&&S.removeEventListener&&s.$el.removeEventListener("pointerenter",m),(k=n==null?void 0:n.$el)!=null&&k.removeEventListener&&n.$el.removeEventListener("pointerenter",m),(I=n==null?void 0:n.$el)!=null&&I.addEventListener&&r.includes("hover")&&n.$el.addEventListener("pointerenter",m)},{immediate:!0}),o.onBeforeUnmount(()=>{var n,r;(r=(n=a.value)==null?void 0:n.$el)!=null&&r.removeEventListener&&a.value.$el.removeEventListener("pointerenter",m)});function R(){$()}t(R,"handleClick");function $(){var n;(n=d.value)==null||n.onClose()}t($,"handleClose");function V(){var n;(n=d.value)==null||n.onOpen()}t(V,"handleOpen");const C=oe.useFormSize();function D(...n){l("command",...n)}t(D,"commandHandler");function m(){var n,r;(r=(n=a.value)==null?void 0:n.$el)==null||r.focus()}t(m,"onAutofocusTriggerEnter");function O(){}t(O,"onItemEnter");function z(){const n=o.unref(i);v.value.includes("hover")&&(n==null||n.focus()),u.value=null}t(z,"onItemLeave");function F(n){u.value=n}t(F,"handleCurrentTabIdChange");function L(n){c.value||(n.preventDefault(),n.stopImmediatePropagation())}t(L,"handleEntryFocus");function P(){l("visible-change",!0)}t(P,"handleBeforeShowTooltip");function H(n){(n==null?void 0:n.type)==="keydown"&&i.value.focus()}t(H,"handleShowTooltip");function A(){l("visible-change",!1)}return t(A,"handleBeforeHideTooltip"),o.provide(J.DROPDOWN_INJECTION_KEY,{contentRef:i,role:o.computed(()=>e.role),triggerId:T,isUsingKeyboard:c,onItemEnter:O,onItemLeave:z}),o.provide("elDropdown",{instance:y,dropdownSize:C,handleClick:R,commandHandler:D,trigger:o.toRef(e,"trigger"),hideOnClick:o.toRef(e,"hideOnClick")}),{t:B,ns:g,scrollbar:h,wrapStyle:b,dropdownTriggerKls:w,dropdownSize:C,triggerId:T,triggerKeys:f,currentTabId:u,handleCurrentTabIdChange:F,handlerMainButtonClick:t(n=>{l("click",n)},"handlerMainButtonClick"),handleEntryFocus:L,handleClose:$,handleOpen:V,handleBeforeShowTooltip:P,handleShowTooltip:H,handleBeforeHideTooltip:A,onFocusAfterTrapped:t(n=>{var r,s;n.preventDefault(),(s=(r=i.value)==null?void 0:r.focus)==null||s.call(r,{preventScroll:!0})},"onFocusAfterTrapped"),popperRef:d,contentRef:i,triggeringElementRef:a,referenceElementRef:p}}});function le(e,l,y,g,B,a){var p;const d=o.resolveComponent("el-dropdown-collection"),i=o.resolveComponent("el-roving-focus-group"),h=o.resolveComponent("el-scrollbar"),u=o.resolveComponent("el-only-child"),c=o.resolveComponent("el-tooltip"),f=o.resolveComponent("el-button"),b=o.resolveComponent("arrow-down"),w=o.resolveComponent("el-icon"),v=o.resolveComponent("el-button-group");return o.openBlock(),o.createElementBlock("div",{class:o.normalizeClass([e.ns.b(),e.ns.is("disabled",e.disabled)])},[o.createVNode(c,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(p=e.referenceElementRef)==null?void 0:p.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},o.createSlots({content:o.withCtx(()=>[o.createVNode(h,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:o.withCtx(()=>[o.createVNode(i,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:o.withCtx(()=>[o.createVNode(d,null,{default:o.withCtx(()=>[o.renderSlot(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:o.withCtx(()=>[o.createVNode(u,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:o.withCtx(()=>[o.renderSlot(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(o.openBlock(),o.createBlock(v,{key:0},{default:o.withCtx(()=>[o.createVNode(f,o.mergeProps({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:o.withCtx(()=>[o.renderSlot(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),o.createVNode(f,o.mergeProps({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:o.withCtx(()=>[o.createVNode(w,{class:o.normalizeClass(e.ns.e("icon"))},{default:o.withCtx(()=>[o.createVNode(b)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):o.createCommentVNode("v-if",!0)],2)}t(le,"_sfc_render");var ie=W.default(re,[["render",le],["__file","dropdown.vue"]]);exports.default=ie;
