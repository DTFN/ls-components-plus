"use strict";var O=Object.defineProperty;var n=(a,o)=>O(a,"name",{value:o,configurable:!0});Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const d=require("vue"),S=require("../../../../../../../../@vueuse_core@9.13.0_vue@3.5.13_typescript@5.5.4_/node_modules/@vueuse/core/index/index.cjs"),v=require("../upload/index.cjs"),f=require("../../../../utils/error/index.cjs"),j=require("../../../../../../../../lodash-es@4.17.21/node_modules/lodash-es/isNil/index.cjs"),b="ElUpload",g=n(a=>{var o;(o=a.url)!=null&&o.startsWith("blob:")&&URL.revokeObjectURL(a.url)},"revokeFileObjectURL"),q=n((a,o)=>{const u=S.useVModel(a,"fileList",void 0,{passive:!0}),l=n(e=>u.value.find(t=>t.uid===e.uid),"getFile");function c(e){var t;(t=o.value)==null||t.abort(e)}n(c,"abort");function h(e=["ready","uploading","success","fail"]){u.value=u.value.filter(t=>!e.includes(t.status))}n(h,"clearFiles");function i(e){u.value=u.value.filter(t=>t!==e)}n(i,"removeFile");const m=n((e,t)=>{const r=l(t);r&&(console.error(e),r.status="fail",i(r),a.onError(e,r,u.value),a.onChange(r,u.value))},"handleError"),y=n((e,t)=>{const r=l(t);r&&(a.onProgress(e,r,u.value),r.status="uploading",r.percentage=Math.round(e.percent))},"handleProgress"),R=n((e,t)=>{const r=l(t);r&&(r.status="success",r.response=e,a.onSuccess(e,r,u.value),a.onChange(r,u.value))},"handleSuccess"),F=n(e=>{j.default(e.uid)&&(e.uid=v.genFileId());const t={name:e.name,percentage:0,status:"ready",size:e.size,raw:e,uid:e.uid};if(a.listType==="picture-card"||a.listType==="picture")try{t.url=URL.createObjectURL(e)}catch(r){f.debugWarn(b,r.message),a.onError(r,t,u.value)}u.value=[...u.value,t],a.onChange(t,u.value)},"handleStart"),E=n(async e=>{const t=e instanceof File?l(e):e;t||f.throwError(b,"file to be removed not found");const r=n(s=>{c(s),i(s),a.onRemove(s,u.value),g(s)},"doRemove");a.beforeRemove?await a.beforeRemove(t,u.value)!==!1&&r(t):r(t)},"handleRemove");function L(){u.value.filter(({status:e})=>e==="ready").forEach(({raw:e})=>{var t;return e&&((t=o.value)==null?void 0:t.upload(e))})}return n(L,"submit"),d.watch(()=>a.listType,e=>{e!=="picture-card"&&e!=="picture"||(u.value=u.value.map(t=>{const{raw:r,url:s}=t;if(!s&&r)try{t.url=URL.createObjectURL(r)}catch(U){a.onError(U,t,u.value)}return t}))}),d.watch(u,e=>{for(const t of e)t.uid||(t.uid=v.genFileId()),t.status||(t.status="success")},{immediate:!0,deep:!0}),{uploadFiles:u,abort:c,clearFiles:h,handleError:m,handleProgress:y,handleStart:F,handleSuccess:R,handleRemove:E,submit:L,revokeFileObjectURL:g}},"useHandlers");exports.useHandlers=q;
