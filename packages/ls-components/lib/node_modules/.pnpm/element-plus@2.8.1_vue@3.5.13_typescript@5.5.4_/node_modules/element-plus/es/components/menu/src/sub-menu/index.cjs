"use strict";var Q=Object.defineProperty;var l=(t,i)=>Q(t,"name",{value:i,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),W=require("../../../collapse-transition/index/index.cjs"),X=require("../../../tooltip/index/index.cjs"),z=require("@element-plus/icons-vue"),Y=require("../../../icon/index/index.cjs"),ee=require("../use-menu/index.cjs"),oe=require("../use-menu-css-var/index.cjs"),ne=require("../../../../utils/vue/props/runtime/index.cjs"),C=require("../../../../utils/vue/icon/index.cjs"),j=require("../../../../hooks/use-namespace/index/index.cjs"),A=require("../../../../utils/error/index.cjs"),te=require("../../../../../../../../@vue_shared@3.5.13/node_modules/@vue/shared/dist/shared.esm-bundler/index.cjs"),B=require("../../../../../../../../@vueuse_shared@9.13.0_vue@3.5.13_typescript@5.5.4_/node_modules/@vueuse/shared/index/index.cjs"),F=ne.buildProps({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:C.iconPropType},expandOpenIcon:{type:C.iconPropType},collapseCloseIcon:{type:C.iconPropType},collapseOpenIcon:{type:C.iconPropType}}),O="ElSubMenu";var ue=e.defineComponent({name:O,props:F,setup(t,{slots:i,expose:R}){const x=e.getCurrentInstance(),{indexPath:f,parentMenu:w}=ee.default(x,e.computed(()=>t.index)),s=j.useNamespace("menu"),p=j.useNamespace("sub-menu"),n=e.inject("rootMenu");n||A.throwError(O,"can not inject root menu");const a=e.inject(`subMenu:${w.value.uid}`);a||A.throwError(O,"can not inject sub menu");const D=e.ref({}),T=e.ref({});let d;const _=e.ref(!1),V=e.ref(),q=e.ref(null),E=e.computed(()=>v.value==="horizontal"&&h.value?"bottom-start":"right-start"),I=e.computed(()=>v.value==="horizontal"&&h.value||v.value==="vertical"&&!n.props.collapse?t.expandCloseIcon&&t.expandOpenIcon?c.value?t.expandOpenIcon:t.expandCloseIcon:z.ArrowDown:t.collapseCloseIcon&&t.collapseOpenIcon?c.value?t.collapseOpenIcon:t.collapseCloseIcon:z.ArrowRight),h=e.computed(()=>a.level===0),g=e.computed(()=>{const o=t.teleported;return o===void 0?h.value:o}),H=e.computed(()=>n.props.collapse?`${s.namespace.value}-zoom-in-left`:`${s.namespace.value}-zoom-in-top`),L=e.computed(()=>v.value==="horizontal"&&h.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),c=e.computed(()=>n.openedMenus.includes(t.index)),y=e.computed(()=>{let o=!1;return Object.values(D.value).forEach(u=>{u.active&&(o=!0)}),Object.values(T.value).forEach(u=>{u.active&&(o=!0)}),o}),v=e.computed(()=>n.props.mode),b=e.reactive({index:t.index,indexPath:f,active:y}),N=oe.useMenuCssVar(n.props,a.level+1),U=e.computed(()=>{var o;return(o=t.popperOffset)!=null?o:n.props.popperOffset}),$=e.computed(()=>{var o;return(o=t.popperClass)!=null?o:n.props.popperClass}),Z=e.computed(()=>{var o;return(o=t.showTimeout)!=null?o:n.props.showTimeout}),G=e.computed(()=>{var o;return(o=t.hideTimeout)!=null?o:n.props.hideTimeout}),J=l(()=>{var o,u,r;return(r=(u=(o=q.value)==null?void 0:o.popperRef)==null?void 0:u.popperInstanceRef)==null?void 0:r.destroy()},"doDestroy"),K=l(o=>{o||J()},"handleCollapseToggle"),k=l(()=>{n.props.menuTrigger==="hover"&&n.props.mode==="horizontal"||n.props.collapse&&n.props.mode==="vertical"||t.disabled||n.handleSubMenuClick({index:t.index,indexPath:f.value,active:y.value})},"handleClick"),M=l((o,u=Z.value)=>{var r;if(o.type!=="focus"){if(n.props.menuTrigger==="click"&&n.props.mode==="horizontal"||!n.props.collapse&&n.props.mode==="vertical"||t.disabled){a.mouseInChild.value=!0;return}a.mouseInChild.value=!0,d==null||d(),{stop:d}=B.useTimeoutFn(()=>{n.openMenu(t.index,f.value)},u),g.value&&((r=w.value.vnode.el)==null||r.dispatchEvent(new MouseEvent("mouseenter")))}},"handleMouseenter"),P=l((o=!1)=>{var u;if(n.props.menuTrigger==="click"&&n.props.mode==="horizontal"||!n.props.collapse&&n.props.mode==="vertical"){a.mouseInChild.value=!1;return}d==null||d(),a.mouseInChild.value=!1,{stop:d}=B.useTimeoutFn(()=>!_.value&&n.closeMenu(t.index,f.value),G.value),g.value&&o&&((u=a.handleMouseleave)==null||u.call(a,!0))},"handleMouseleave");e.watch(()=>n.props.collapse,o=>K(!!o));{const o=l(r=>{T.value[r.index]=r},"addSubMenu"),u=l(r=>{delete T.value[r.index]},"removeSubMenu");e.provide(`subMenu:${x.uid}`,{addSubMenu:o,removeSubMenu:u,handleMouseleave:P,mouseInChild:_,level:a.level+1})}return R({opened:c}),e.onMounted(()=>{n.addSubMenu(b),a.addSubMenu(b)}),e.onBeforeUnmount(()=>{a.removeSubMenu(b),n.removeSubMenu(b)}),()=>{var o;const u=[(o=i.title)==null?void 0:o.call(i),e.h(Y.ElIcon,{class:p.e("icon-arrow"),style:{transform:c.value?t.expandCloseIcon&&t.expandOpenIcon||t.collapseCloseIcon&&t.collapseOpenIcon&&n.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:l(()=>te.isString(I.value)?e.h(x.appContext.components[I.value]):e.h(I.value),"default")})],r=n.isMenuPopup?e.h(X.ElTooltip,{ref:q,visible:c.value,effect:"light",pure:!0,offset:U.value,showArrow:!1,persistent:!0,popperClass:$.value,placement:E.value,teleported:g.value,fallbackPlacements:L.value,transition:H.value,gpuAcceleration:!1},{content:l(()=>{var m;return e.h("div",{class:[s.m(v.value),s.m("popup-container"),$.value],onMouseenter:l(S=>M(S,100),"onMouseenter"),onMouseleave:l(()=>P(!0),"onMouseleave"),onFocus:l(S=>M(S,100),"onFocus")},[e.h("ul",{class:[s.b(),s.m("popup"),s.m(`popup-${E.value}`)],style:N.value},[(m=i.default)==null?void 0:m.call(i)])])},"content"),default:l(()=>e.h("div",{class:p.e("title"),onClick:k},u),"default")}):e.h(e.Fragment,{},[e.h("div",{class:p.e("title"),ref:V,onClick:k},u),e.h(W.ElCollapseTransition,{},{default:l(()=>{var m;return e.withDirectives(e.h("ul",{role:"menu",class:[s.b(),s.m("inline")],style:N.value},[(m=i.default)==null?void 0:m.call(i)]),[[e.vShow,c.value]])},"default")})]);return e.h("li",{class:[p.b(),p.is("active",y.value),p.is("opened",c.value),p.is("disabled",t.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:c.value,onMouseenter:M,onMouseleave:l(()=>P(),"onMouseleave"),onFocus:M},[r])}}});exports.default=ue;exports.subMenuProps=F;
