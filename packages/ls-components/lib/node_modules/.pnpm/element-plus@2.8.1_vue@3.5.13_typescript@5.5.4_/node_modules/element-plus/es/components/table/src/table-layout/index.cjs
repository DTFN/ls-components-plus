"use strict";var p=Object.defineProperty;var g=(v,e)=>p(v,"name",{value:e,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const l=require("vue"),w=require("../util/index.cjs"),y=require("../../../../../../../../@vue_shared@3.5.13/node_modules/@vue/shared/dist/shared.esm-bundler/index.cjs"),m=require("../../../../../../../../@vueuse_shared@9.13.0_vue@3.5.13_typescript@5.5.4_/node_modules/@vueuse/shared/index/index.cjs"),u=class u{constructor(e){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=l.ref(null),this.scrollX=l.ref(!1),this.scrollY=l.ref(!1),this.bodyWidth=l.ref(null),this.fixedWidth=l.ref(null),this.rightFixedWidth=l.ref(null),this.gutterWidth=0;for(const t in e)y.hasOwn(e,t)&&(l.isRef(this[t])?this[t].value=e[t]:this[t]=e[t]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const t=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(t!=null&&t.wrapRef)){let s=!0;const h=this.scrollY.value;return s=t.wrapRef.scrollHeight>t.wrapRef.clientHeight,this.scrollY.value=s,h!==s}return!1}setHeight(e,t="height"){if(!m.isClient)return;const s=this.table.vnode.el;if(e=w.parseHeight(e),this.height.value=Number(e),!s&&(e||e===0))return l.nextTick(()=>this.setHeight(e,t));typeof e=="number"?(s.style[t]=`${e}px`,this.updateElsHeight()):typeof e=="string"&&(s.style[t]=e,this.updateElsHeight())}setMaxHeight(e){this.setHeight(e,"max-height")}getFlattenColumns(){const e=[];return this.table.store.states.columns.value.forEach(s=>{s.isColumnGroup?e.push.apply(e,s.columns):e.push(s)}),e}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(e){if(!e)return!0;let t=e;for(;t.tagName!=="DIV";){if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}updateColumnsWidth(){if(!m.isClient)return;const e=this.fit,t=this.table.vnode.el.clientWidth;let s=0;const h=this.getFlattenColumns(),r=h.filter(i=>typeof i.width!="number");if(h.forEach(i=>{typeof i.width=="number"&&i.realWidth&&(i.realWidth=null)}),r.length>0&&e){if(h.forEach(i=>{s+=Number(i.width||i.minWidth||80)}),s<=t){this.scrollX.value=!1;const i=t-s;if(r.length===1)r[0].realWidth=Number(r[0].minWidth||80)+i;else{const a=r.reduce((o,n)=>o+Number(n.minWidth||80),0),x=i/a;let b=0;r.forEach((o,n)=>{if(n===0)return;const W=Math.floor(Number(o.minWidth||80)*x);b+=W,o.realWidth=Number(o.minWidth||80)+W}),r[0].realWidth=Number(r[0].minWidth||80)+i-b}}else this.scrollX.value=!0,r.forEach(i=>{i.realWidth=Number(i.minWidth)});this.bodyWidth.value=Math.max(s,t),this.table.state.resizeState.value.width=this.bodyWidth.value}else h.forEach(i=>{!i.width&&!i.minWidth?i.realWidth=80:i.realWidth=Number(i.width||i.minWidth),s+=i.realWidth}),this.scrollX.value=s>t,this.bodyWidth.value=s;const f=this.store.states.fixedColumns.value;if(f.length>0){let i=0;f.forEach(a=>{i+=Number(a.realWidth||a.width)}),this.fixedWidth.value=i}const c=this.store.states.rightFixedColumns.value;if(c.length>0){let i=0;c.forEach(a=>{i+=Number(a.realWidth||a.width)}),this.rightFixedWidth.value=i}this.notifyObservers("columns")}addObserver(e){this.observers.push(e)}removeObserver(e){const t=this.observers.indexOf(e);t!==-1&&this.observers.splice(t,1)}notifyObservers(e){this.observers.forEach(s=>{var h,r;switch(e){case"columns":(h=s.state)==null||h.onColumnsChange(this);break;case"scrollable":(r=s.state)==null||r.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${e}.`)}})}};g(u,"TableLayout");let d=u;exports.default=d;
