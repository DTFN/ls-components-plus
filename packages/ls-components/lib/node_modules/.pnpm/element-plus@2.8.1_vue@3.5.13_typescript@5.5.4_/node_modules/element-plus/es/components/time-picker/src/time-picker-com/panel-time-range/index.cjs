"use strict";var pe=Object.defineProperty;var r=(V,l)=>pe(V,"name",{value:l,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),k=require("../../../../../../../../../dayjs@1.11.13/node_modules/dayjs/dayjs.min/index.cjs"),me=require("../../props/panel-time-range/index.cjs"),fe=require("../../composables/use-time-panel/index.cjs"),I=require("../../composables/use-time-picker/index.cjs"),$=require("../basic-time-spinner/index.cjs"),be=require("../../../../../_virtual/plugin-vue_export-helper/index.cjs"),ge=require("../../../../../hooks/use-locale/index/index.cjs"),j=require("../../../../../hooks/use-namespace/index/index.cjs"),ve=require("../../../../../constants/aria/index.cjs"),R=require("../../../../../../../../../@vue_shared@3.5.13/node_modules/@vue/shared/dist/shared.esm-bundler/index.cjs"),x=require("../../../../../../../../../lodash-es@4.17.21/node_modules/lodash-es/union/index.cjs"),ke=e.defineComponent({__name:"panel-time-range",props:me.panelTimeRangeProps,emits:["pick","select-range","set-picker-option"],setup(V,{emit:l}){const u=V,b=r((n,t)=>{const a=[];for(let o=n;o<=t;o++)a.push(o);return a},"makeSelectRange"),{t:S,lang:v}=ge.useLocale(),s=j.useNamespace("time"),U=j.useNamespace("picker"),G=e.inject("EP_PICKER_BASE"),{arrowControl:h,disabledHours:A,disabledMinutes:q,disabledSeconds:M,defaultValue:D}=G.props,L=e.computed(()=>[s.be("range-picker","body"),s.be("panel","content"),s.is("arrow",h),f.value?"has-seconds":""]),F=e.computed(()=>[s.be("range-picker","body"),s.be("panel","content"),s.is("arrow",h),f.value?"has-seconds":""]),p=e.computed(()=>u.parsedValue[0]),m=e.computed(()=>u.parsedValue[1]),J=I.useOldValue(u),Q=r(()=>{l("pick",J.value,!1)},"handleCancel"),f=e.computed(()=>u.format.includes("ss")),y=e.computed(()=>u.format.includes("A")?"A":u.format.includes("a")?"a":""),W=r((n=!1)=>{l("pick",[p.value,m.value],n)},"handleConfirm"),X=r(n=>{z(n.millisecond(0),m.value)},"handleMinChange"),Y=r(n=>{z(p.value,n.millisecond(0))},"handleMaxChange"),Z=r(n=>{const t=n.map(o=>k.default(o).locale(v.value)),a=O(t);return t[0].isSame(a[0])&&t[1].isSame(a[1])},"isValidValue"),z=r((n,t)=>{l("pick",[n,t],!0)},"handleChange"),ee=e.computed(()=>p.value>m.value),C=e.ref([0,2]),ne=r((n,t)=>{l("select-range",n,t,"min"),C.value=[n,t]},"setMinSelectionRange"),P=e.computed(()=>f.value?11:8),te=r((n,t)=>{l("select-range",n,t,"max");const a=e.unref(P);C.value=[n+a,t+a]},"setMaxSelectionRange"),ae=r(n=>{const t=f.value?[0,3,6,11,14,17]:[0,3,8,11],a=["hours","minutes"].concat(f.value?["seconds"]:[]),c=(t.indexOf(C.value[0])+n+t.length)%t.length,i=t.length/2;c<i?w.start_emitSelectRange(a[c]):w.end_emitSelectRange(a[c-i])},"changeSelectionRange"),re=r(n=>{const t=n.code,{left:a,right:o,up:c,down:i}=ve.EVENT_CODE;if([a,o].includes(t)){ae(t===a?-1:1),n.preventDefault();return}if([c,i].includes(t)){const d=t===c?-1:1,g=C.value[0]<P.value?"start":"end";w[`${g}_scrollDown`](d),n.preventDefault();return}},"handleKeydown"),_=r((n,t)=>{const a=A?A(n):[],o=n==="start",i=(t||(o?m.value:p.value)).hour(),d=o?b(i+1,23):b(0,i-1);return x.default(a,d)},"disabledHours_"),T=r((n,t,a)=>{const o=q?q(n,t):[],c=t==="start",i=a||(c?m.value:p.value),d=i.hour();if(n!==d)return o;const g=i.minute(),N=c?b(g+1,59):b(0,g-1);return x.default(o,N)},"disabledMinutes_"),E=r((n,t,a,o)=>{const c=M?M(n,t,a):[],i=a==="start",d=o||(i?m.value:p.value),g=d.hour(),N=d.minute();if(n!==g||t!==N)return c;const K=d.second(),de=i?b(K+1,59):b(0,K-1);return x.default(c,de)},"disabledSeconds_"),O=r(([n,t])=>[H(n,"start",!0,t),H(t,"end",!1,n)],"getRangeAvailableTime"),{getAvailableHours:oe,getAvailableMinutes:se,getAvailableSeconds:le}=I.buildAvailableTimeSlotGetter(_,T,E),{timePickerOptions:w,getAvailableTime:H,onSetOption:B}=fe.useTimePanel({getAvailableHours:oe,getAvailableMinutes:se,getAvailableSeconds:le}),ce=r(n=>n?R.isArray(n)?n.map(t=>k.default(t,u.format).locale(v.value)):k.default(n,u.format).locale(v.value):null,"parseUserInput"),ie=r(n=>n?R.isArray(n)?n.map(t=>t.format(u.format)):n.format(u.format):null,"formatToString"),ue=r(()=>{if(R.isArray(D))return D.map(t=>k.default(t).locale(v.value));const n=k.default(D).locale(v.value);return[n,n.add(60,"m")]},"getDefaultValue");return l("set-picker-option",["formatToString",ie]),l("set-picker-option",["parseUserInput",ce]),l("set-picker-option",["isValidValue",Z]),l("set-picker-option",["handleKeydownInput",re]),l("set-picker-option",["getDefaultValue",ue]),l("set-picker-option",["getRangeAvailableTime",O]),(n,t)=>n.actualVisible?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass([e.unref(s).b("range-picker"),e.unref(U).b("panel")])},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).be("range-picker","content"))},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).be("range-picker","cell"))},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).be("range-picker","header"))},e.toDisplayString(e.unref(S)("el.datepicker.startTime")),3),e.createElementVNode("div",{class:e.normalizeClass(e.unref(L))},[e.createVNode($.default,{ref:"minSpinner",role:"start","show-seconds":e.unref(f),"am-pm-mode":e.unref(y),"arrow-control":e.unref(h),"spinner-date":e.unref(p),"disabled-hours":_,"disabled-minutes":T,"disabled-seconds":E,onChange:X,onSetOption:e.unref(B),onSelectRange:ne},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).be("range-picker","cell"))},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).be("range-picker","header"))},e.toDisplayString(e.unref(S)("el.datepicker.endTime")),3),e.createElementVNode("div",{class:e.normalizeClass(e.unref(F))},[e.createVNode($.default,{ref:"maxSpinner",role:"end","show-seconds":e.unref(f),"am-pm-mode":e.unref(y),"arrow-control":e.unref(h),"spinner-date":e.unref(m),"disabled-hours":_,"disabled-minutes":T,"disabled-seconds":E,onChange:Y,onSetOption:e.unref(B),onSelectRange:te},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).be("panel","footer"))},[e.createElementVNode("button",{type:"button",class:e.normalizeClass([e.unref(s).be("panel","btn"),"cancel"]),onClick:r(a=>Q(),"onClick")},e.toDisplayString(e.unref(S)("el.datepicker.cancel")),11,["onClick"]),e.createElementVNode("button",{type:"button",class:e.normalizeClass([e.unref(s).be("panel","btn"),"confirm"]),disabled:e.unref(ee),onClick:r(a=>W(),"onClick")},e.toDisplayString(e.unref(S)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):e.createCommentVNode("v-if",!0)}});var Se=be.default(ke,[["__file","panel-time-range.vue"]]);exports.default=Se;
