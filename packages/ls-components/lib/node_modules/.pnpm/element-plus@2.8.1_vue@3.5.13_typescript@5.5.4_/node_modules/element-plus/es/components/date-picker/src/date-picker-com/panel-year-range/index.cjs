"use strict";var Z=Object.defineProperty;var s=(y,u)=>Z(y,"name",{value:u,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),d=require("../../../../../../../../../dayjs@1.11.13/node_modules/dayjs/dayjs.min/index.cjs"),V=require("@element-plus/icons-vue"),N=require("../../../../icon/index/index.cjs"),q=require("../../props/panel-year-range/index.cjs"),ee=require("../../composables/use-shortcut/index.cjs"),ae=require("../../composables/use-year-range-header/index.cjs"),z=require("../../utils/index.cjs"),te=require("../../constants/index.cjs"),A=require("../basic-year-table/index.cjs"),ne=require("../../../../../_virtual/plugin-vue_export-helper/index.cjs"),re=require("../../../../../hooks/use-locale/index/index.cjs"),le=require("../../../../../hooks/use-namespace/index/index.cjs"),R=require("../../../../../../../../../@vue_shared@3.5.13/node_modules/@vue/shared/dist/shared.esm-bundler/index.cjs"),I="year",oe=e.defineComponent({name:"DatePickerYearRange"}),se=e.defineComponent({...oe,props:q.panelYearRangeProps,emits:q.panelYearRangeEmits,setup(y,{emit:u}){const m=y,{lang:p}=re.useLocale(),i=e.ref(d.default().locale(p.value)),c=e.ref(i.value.add(10,"year")),{pickerNs:n}=e.inject(te.ROOT_PICKER_INJECTION_KEY),g=le.useNamespace("date-range-picker"),w=e.computed(()=>!!x.length),L=e.computed(()=>[n.b(),g.b(),{"has-sidebar":!!e.useSlots().sidebar||w.value}]),E=e.computed(()=>({content:[n.e("content"),g.e("content"),"is-left"],arrowLeftBtn:[n.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[n.e("icon-btn"),{[n.is("disabled")]:!C.value},"d-arrow-right"]})),D=e.computed(()=>({content:[n.e("content"),g.e("content"),"is-right"],arrowLeftBtn:[n.e("icon-btn"),{"is-disabled":!C.value},"d-arrow-left"],arrowRightBtn:[n.e("icon-btn"),"d-arrow-right"]})),$=ee.useShortcut(p),{leftPrevYear:K,rightNextYear:T,leftNextYear:j,rightPrevYear:O,leftLabel:H,rightLabel:M,leftYear:U,rightYear:F}=ae.useYearRangeHeader({unlinkPanels:e.toRef(m,"unlinkPanels"),leftDate:i,rightDate:c}),C=e.computed(()=>m.unlinkPanels&&F.value>U.value+1),l=e.ref(),r=e.ref(),k=e.ref({endDate:null,selecting:!1}),S=s(a=>{k.value=a},"handleChangeRange"),_=s((a,t=!0)=>{const o=a.minDate,v=a.maxDate;r.value===v&&l.value===o||(u("calendar-change",[o.toDate(),v&&v.toDate()]),r.value=v,l.value=o,t&&J())},"handleRangePick"),J=s((a=!1)=>{z.isValidRange([l.value,r.value])&&u("pick",[l.value,r.value],a)},"handleConfirm"),Y=s(a=>{k.value.selecting=a,a||(k.value.endDate=null)},"onSelect"),B=e.inject("EP_PICKER_BASE"),{shortcuts:x,disabledDate:h}=B.props,b=e.toRef(B.props,"format"),f=e.toRef(B.props,"defaultValue"),P=s(()=>{let a;if(R.isArray(f.value)){const t=d.default(f.value[0]);let o=d.default(f.value[1]);return m.unlinkPanels||(o=t.add(10,I)),[t,o]}else f.value?a=d.default(f.value):a=d.default();return a=a.locale(p.value),[a,a.add(10,I)]},"getDefaultValue");e.watch(()=>f.value,a=>{if(a){const t=P();i.value=t[0],c.value=t[1]}},{immediate:!0}),e.watch(()=>m.parsedValue,a=>{if(a&&a.length===2)if(l.value=a[0],r.value=a[1],i.value=l.value,m.unlinkPanels&&r.value){const t=l.value.year(),o=r.value.year();c.value=t===o?r.value.add(10,"year"):r.value}else c.value=i.value.add(10,"year");else{const t=P();l.value=void 0,r.value=void 0,i.value=t[0],c.value=t[1]}},{immediate:!0});const G=s(a=>R.isArray(a)?a.map(t=>d.default(t,b.value).locale(p.value)):d.default(a,b.value).locale(p.value),"parseUserInput"),Q=s(a=>R.isArray(a)?a.map(t=>t.format(b.value)):a.format(b.value),"formatToString"),W=s(a=>z.isValidRange(a)&&(h?!h(a[0].toDate())&&!h(a[1].toDate()):!0),"isValidValue"),X=s(()=>{const a=P();i.value=a[0],c.value=a[1],r.value=void 0,l.value=void 0,u("pick",null)},"handleClear");return u("set-picker-option",["isValidValue",W]),u("set-picker-option",["parseUserInput",G]),u("set-picker-option",["formatToString",Q]),u("set-picker-option",["handleClear",X]),(a,t)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(L))},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(n).e("body-wrapper"))},[e.renderSlot(a.$slots,"sidebar",{class:e.normalizeClass(e.unref(n).e("sidebar"))}),e.unref(w)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(n).e("sidebar"))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(x),(o,v)=>(e.openBlock(),e.createElementBlock("button",{key:v,type:"button",class:e.normalizeClass(e.unref(n).e("shortcut")),onClick:s(ie=>e.unref($)(o),"onClick")},e.toDisplayString(o.text),11,["onClick"]))),128))],2)):e.createCommentVNode("v-if",!0),e.createElementVNode("div",{class:e.normalizeClass(e.unref(n).e("body"))},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(E).content)},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(g).e("header"))},[e.createElementVNode("button",{type:"button",class:e.normalizeClass(e.unref(E).arrowLeftBtn),onClick:e.unref(K)},[e.renderSlot(a.$slots,"prev-year",{},()=>[e.createVNode(e.unref(N.ElIcon),null,{default:e.withCtx(()=>[e.createVNode(e.unref(V.DArrowLeft))]),_:1})])],10,["onClick"]),a.unlinkPanels?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",disabled:!e.unref(C),class:e.normalizeClass(e.unref(E).arrowRightBtn),onClick:e.unref(j)},[e.renderSlot(a.$slots,"next-year",{},()=>[e.createVNode(e.unref(N.ElIcon),null,{default:e.withCtx(()=>[e.createVNode(e.unref(V.DArrowRight))]),_:1})])],10,["disabled","onClick"])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",null,e.toDisplayString(e.unref(H)),1)],2),e.createVNode(A.default,{"selection-mode":"range",date:i.value,"min-date":l.value,"max-date":r.value,"range-state":k.value,"disabled-date":e.unref(h),onChangerange:S,onPick:_,onSelect:Y},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),e.createElementVNode("div",{class:e.normalizeClass(e.unref(D).content)},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(g).e("header"))},[a.unlinkPanels?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",disabled:!e.unref(C),class:e.normalizeClass(e.unref(D).arrowLeftBtn),onClick:e.unref(O)},[e.renderSlot(a.$slots,"prev-year",{},()=>[e.createVNode(e.unref(N.ElIcon),null,{default:e.withCtx(()=>[e.createVNode(e.unref(V.DArrowLeft))]),_:1})])],10,["disabled","onClick"])):e.createCommentVNode("v-if",!0),e.createElementVNode("button",{type:"button",class:e.normalizeClass(e.unref(D).arrowRightBtn),onClick:e.unref(T)},[e.renderSlot(a.$slots,"next-year",{},()=>[e.createVNode(e.unref(N.ElIcon),null,{default:e.withCtx(()=>[e.createVNode(e.unref(V.DArrowRight))]),_:1})])],10,["onClick"]),e.createElementVNode("div",null,e.toDisplayString(e.unref(M)),1)],2),e.createVNode(A.default,{"selection-mode":"range",date:c.value,"min-date":l.value,"max-date":r.value,"range-state":k.value,"disabled-date":e.unref(h),onChangerange:S,onPick:_,onSelect:Y},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var ue=ne.default(se,[["__file","panel-year-range.vue"]]);exports.default=ue;
