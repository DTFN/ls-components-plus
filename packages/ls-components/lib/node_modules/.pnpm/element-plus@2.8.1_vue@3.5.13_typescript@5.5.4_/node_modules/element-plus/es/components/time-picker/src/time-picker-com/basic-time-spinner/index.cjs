"use strict";var W=Object.defineProperty;var t=(g,m)=>W(g,"name",{value:m,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),X=require("../../../../scrollbar/index/index.cjs"),x=require("../../../../icon/index/index.cjs"),_=require("@element-plus/icons-vue"),F=require("../../constants/index.cjs"),E=require("../../utils/index.cjs"),Y=require("../../props/basic-time-spinner/index.cjs"),Z=require("../../composables/use-time-picker/index.cjs"),ee=require("../../../../../_virtual/plugin-vue_export-helper/index.cjs"),ne=require("../../../../../hooks/use-namespace/index/index.cjs"),re=require("../../../../../utils/dom/style/index.cjs"),L=require("../../../../../directives/repeat-click/index/index.cjs"),se=require("../../../../../../../../../lodash-es@4.17.21/node_modules/lodash-es/debounce/index.cjs"),oe=e.defineComponent({__name:"basic-time-spinner",props:Y.basicTimeSpinnerProps,emits:["change","select-range","set-option"],setup(g,{emit:m}){const l=g,i=ne.useNamespace("time"),{getHoursList:N,getMinutesList:P,getSecondsList:V}=Z.getTimeLists(l.disabledHours,l.disabledMinutes,l.disabledSeconds);let w=!1;const h=e.ref(),R=e.ref(),z=e.ref(),H=e.ref(),d={hours:R,minutes:z,seconds:H},M=e.computed(()=>l.showSeconds?F.timeUnits:F.timeUnits.slice(0,2)),a=e.computed(()=>{const{spinnerDate:n}=l,s=n.hour(),r=n.minute(),o=n.second();return{hours:s,minutes:r,seconds:o}}),k=e.computed(()=>{const{hours:n,minutes:s}=e.unref(a);return{hours:N(l.role),minutes:P(n,l.role),seconds:V(n,s,l.role)}}),I=e.computed(()=>{const{hours:n,minutes:s,seconds:r}=e.unref(a);return{hours:E.buildTimeList(n,23),minutes:E.buildTimeList(s,59),seconds:E.buildTimeList(r,59)}}),A=se.default(n=>{w=!1,f(n)},200),T=t(n=>{if(!!!l.amPmMode)return"";const r=l.amPmMode==="A";let o=n<12?" am":" pm";return r&&(o=o.toUpperCase()),o},"getAmPmFlag"),u=t(n=>{let s;switch(n){case"hours":s=[0,2];break;case"minutes":s=[3,5];break;case"seconds":s=[6,8];break}const[r,o]=s;m("select-range",r,o),h.value=n},"emitSelectRange"),f=t(n=>{S(n,e.unref(a)[n])},"adjustCurrentSpinner"),$=t(()=>{f("hours"),f("minutes"),f("seconds")},"adjustSpinners"),B=t(n=>n.querySelector(`.${i.namespace.value}-scrollbar__wrap`),"getScrollbarElement"),S=t((n,s)=>{if(l.arrowControl)return;const r=e.unref(d[n]);r&&r.$el&&(B(r.$el).scrollTop=Math.max(0,s*v(n)))},"adjustSpinner"),v=t(n=>{const s=e.unref(d[n]),r=s==null?void 0:s.$el.querySelector("li");return r&&Number.parseFloat(re.getStyle(r,"height"))||0},"typeItemHeight"),y=t(()=>{C(1)},"onIncrement"),U=t(()=>{C(-1)},"onDecrement"),C=t(n=>{h.value||u("hours");const s=h.value,r=e.unref(a)[s],o=h.value==="hours"?24:60,c=j(s,r,n,o);D(s,c),S(s,c),e.nextTick(()=>u(s))},"scrollDown"),j=t((n,s,r,o)=>{let c=(s+r+o)%o;const p=e.unref(k)[n];for(;p[c]&&c!==s;)c=(c+r+o)%o;return c},"findNextUnDisabled"),D=t((n,s)=>{if(e.unref(k)[n][s])return;const{hours:c,minutes:p,seconds:q}=e.unref(a);let b;switch(n){case"hours":b=l.spinnerDate.hour(s).minute(p).second(q);break;case"minutes":b=l.spinnerDate.hour(c).minute(s).second(q);break;case"seconds":b=l.spinnerDate.hour(c).minute(p).second(s);break}m("change",b)},"modifyDateField"),O=t((n,{value:s,disabled:r})=>{r||(D(n,s),u(n),S(n,s))},"handleClick"),G=t(n=>{w=!0,A(n);const s=Math.min(Math.round((B(e.unref(d[n]).$el).scrollTop-(J(n)*.5-10)/v(n)+3)/v(n)),n==="hours"?23:59);D(n,s)},"handleScroll"),J=t(n=>e.unref(d[n]).$el.offsetHeight,"scrollBarHeight"),K=t(()=>{const n=t(s=>{const r=e.unref(d[s]);r&&r.$el&&(B(r.$el).onscroll=()=>{G(s)})},"bindFunction");n("hours"),n("minutes"),n("seconds")},"bindScrollEvent");e.onMounted(()=>{e.nextTick(()=>{!l.arrowControl&&K(),$(),l.role==="start"&&u("hours")})});const Q=t((n,s)=>{d[s].value=n},"setRef");return m("set-option",[`${l.role}_scrollDown`,C]),m("set-option",[`${l.role}_emitSelectRange`,u]),e.watch(()=>l.spinnerDate,()=>{w||$()}),(n,s)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([e.unref(i).b("spinner"),{"has-seconds":n.showSeconds}])},[n.arrowControl?e.createCommentVNode("v-if",!0):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(M),r=>(e.openBlock(),e.createBlock(e.unref(X.ElScrollbar),{key:r,ref_for:!0,ref:t(o=>Q(o,r),"ref"),class:e.normalizeClass(e.unref(i).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":e.unref(i).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:t(o=>u(r),"onMouseenter"),onMousemove:t(o=>f(r),"onMousemove")},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(k)[r],(o,c)=>(e.openBlock(),e.createElementBlock("li",{key:c,class:e.normalizeClass([e.unref(i).be("spinner","item"),e.unref(i).is("active",c===e.unref(a)[r]),e.unref(i).is("disabled",o)]),onClick:t(p=>O(r,{value:c,disabled:o}),"onClick")},[r==="hours"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(("0"+(n.amPmMode?c%12||12:c)).slice(-2))+e.toDisplayString(T(c)),1)],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(("0"+c).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),n.arrowControl?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(e.unref(M),r=>(e.openBlock(),e.createElementBlock("div",{key:r,class:e.normalizeClass([e.unref(i).be("spinner","wrapper"),e.unref(i).is("arrow")]),onMouseenter:t(o=>u(r),"onMouseenter")},[e.withDirectives((e.openBlock(),e.createBlock(e.unref(x.ElIcon),{class:e.normalizeClass(["arrow-up",e.unref(i).be("spinner","arrow")])},{default:e.withCtx(()=>[e.createVNode(e.unref(_.ArrowUp))]),_:1},8,["class"])),[[e.unref(L.vRepeatClick),U]]),e.withDirectives((e.openBlock(),e.createBlock(e.unref(x.ElIcon),{class:e.normalizeClass(["arrow-down",e.unref(i).be("spinner","arrow")])},{default:e.withCtx(()=>[e.createVNode(e.unref(_.ArrowDown))]),_:1},8,["class"])),[[e.unref(L.vRepeatClick),y]]),e.createElementVNode("ul",{class:e.normalizeClass(e.unref(i).be("spinner","list"))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(I)[r],(o,c)=>(e.openBlock(),e.createElementBlock("li",{key:c,class:e.normalizeClass([e.unref(i).be("spinner","item"),e.unref(i).is("active",o===e.unref(a)[r]),e.unref(i).is("disabled",e.unref(k)[r][o])])},[typeof o=="number"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[r==="hours"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(("0"+(n.amPmMode?o%12||12:o)).slice(-2))+e.toDisplayString(T(o)),1)],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(("0"+o).slice(-2)),1)],64))],64)):e.createCommentVNode("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):e.createCommentVNode("v-if",!0)],2))}});var te=ee.default(oe,[["__file","basic-time-spinner.vue"]]);exports.default=te;
