"use strict";var ze=Object.defineProperty;var o=($,S)=>ze($,"name",{value:S,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),Ie=require("../../../../../../../../@vue_shared@3.5.13/node_modules/@vue/shared/dist/shared.esm-bundler/index.cjs"),ue=require("../../../../../../../../@vueuse_core@9.13.0_vue@3.5.13_typescript@5.5.4_/node_modules/@vueuse/core/index/index.cjs"),Me=require("../../../cascader-panel/index/index.cjs"),Fe=require("../../../input/index/index.cjs"),ie=require("../../../tooltip/index/index.cjs"),Oe=require("../../../scrollbar/index/index.cjs"),de=require("../../../tag/index/index.cjs"),j=require("../../../icon/index/index.cjs"),G=require("@element-plus/icons-vue"),pe=require("../cascader/index.cjs"),Ke=require("../../../../_virtual/plugin-vue_export-helper/index.cjs"),fe=require("../../../../hooks/use-namespace/index/index.cjs"),Ae=require("../../../../hooks/use-locale/index/index.cjs"),He=require("../../../form/src/hooks/use-form-item/index.cjs"),Le=require("../../../../hooks/use-empty-values/index/index.cjs"),Re=require("../../../../hooks/use-composition/index/index.cjs"),Ue=require("../../../form/src/hooks/use-form-common-props/index.cjs"),ve=require("../../../../constants/event/index.cjs"),We=require("../../../../utils/error/index.cjs"),C=require("../../../../constants/aria/index.cjs"),me=require("../../../../utils/dom/aria/index.cjs"),je=require("../../../../directives/click-outside/index/index.cjs"),Ge=require("../../../../../../../../lodash-es@4.17.21/node_modules/lodash-es/cloneDeep/index.cjs"),Je=require("../../../../../../../../lodash-es@4.17.21/node_modules/lodash-es/debounce/index.cjs"),Qe=require("../../../../../../../../@vueuse_shared@9.13.0_vue@3.5.13_typescript@5.5.4_/node_modules/@vueuse/shared/index/index.cjs"),Xe="ElCascader",Ye=e.defineComponent({name:Xe}),Ze=e.defineComponent({...Ye,props:pe.cascaderProps,emits:pe.cascaderEmits,setup($,{expose:S,emit:v}){const s=$,he={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:o(({state:t})=>{const{modifiersData:l,placement:n}=t;["right","left","bottom","top"].includes(n)||(l.arrow.x=35)},"fn"),requires:["arrow"]}]},J=e.useAttrs();let y=0,D=0;const r=fe.useNamespace("cascader"),q=fe.useNamespace("input"),{t:Q}=Ae.useLocale(),{form:X,formItem:x}=He.useFormItem(),{valueOnClear:ge}=Le.useEmptyValues(s),{isComposing:Y,handleComposition:b}=Re.useComposition({afterComposition(t){var l;const n=(l=t.target)==null?void 0:l.value;W(n)}}),P=e.ref(null),w=e.ref(null),Z=e.ref(null),u=e.ref(null),V=e.ref(null),i=e.ref(!1),z=e.ref(!1),m=e.ref(!1),I=e.ref(!1),N=e.ref(""),k=e.ref(""),E=e.ref([]),M=e.ref([]),F=e.ref([]),Ce=e.computed(()=>J.style),h=e.computed(()=>s.disabled||(X==null?void 0:X.disabled)),ee=e.computed(()=>s.placeholder||Q("el.cascader.placeholder")),ke=e.computed(()=>k.value||E.value.length>0||Y.value?"":ee.value),B=Ue.useFormSize(),te=e.computed(()=>["small"].includes(B.value)?"small":"default"),g=e.computed(()=>!!s.props.multiple),le=e.computed(()=>!s.filterable||g.value),ne=e.computed(()=>g.value?k.value:N.value),_=e.computed(()=>{var t;return((t=u.value)==null?void 0:t.checkedNodes)||[]}),Ee=e.computed(()=>!s.clearable||h.value||m.value||!z.value?!1:!!_.value.length),O=e.computed(()=>{const{showAllLevels:t,separator:l}=s,n=_.value;return n.length?g.value?"":n[0].calcText(t,l):""}),be=e.computed(()=>(x==null?void 0:x.validateState)||""),K=e.computed({get(){return Ge.default(s.modelValue)},set(t){const l=t??ge.value;v(ve.UPDATE_MODEL_EVENT,l),v(ve.CHANGE_EVENT,l),s.validateEvent&&(x==null||x.validate("change").catch(n=>We.debugWarn(n)))}}),ye=e.computed(()=>[r.b(),r.m(B.value),r.is("disabled",h.value),J.class]),we=e.computed(()=>[q.e("icon"),"icon-arrow-down",r.is("reverse",i.value)]),Te=e.computed(()=>r.is("focus",i.value||I.value)),oe=e.computed(()=>{var t,l;return(l=(t=P.value)==null?void 0:t.popperRef)==null?void 0:l.contentRef}),c=o(t=>{var l,n,a;h.value||(t=t??!i.value,t!==i.value&&(i.value=t,(n=(l=w.value)==null?void 0:l.input)==null||n.setAttribute("aria-expanded",`${t}`),t?(T(),e.nextTick((a=u.value)==null?void 0:a.scrollToExpandingNode)):s.filterable&&U(),v("visibleChange",t)))},"togglePopperVisible"),T=o(()=>{e.nextTick(()=>{var t;(t=P.value)==null||t.updatePopper()})},"updatePopperPosition"),A=o(()=>{m.value=!1},"hideSuggestionPanel"),H=o(t=>{const{showAllLevels:l,separator:n}=s;return{node:t,key:t.uid,text:t.calcText(l,n),hitState:!1,closable:!h.value&&!t.isDisabled,isCollapseTag:!1}},"genTag"),L=o(t=>{var l;const n=t.node;n.doCheck(!1),(l=u.value)==null||l.calculateCheckedValue(),v("removeTag",n.valueByOption)},"deleteTag"),xe=o(()=>{if(!g.value)return;const t=_.value,l=[],n=[];if(t.forEach(a=>n.push(H(a))),M.value=n,t.length){t.slice(0,s.maxCollapseTags).forEach(d=>l.push(H(d)));const a=t.slice(s.maxCollapseTags),p=a.length;p&&(s.collapseTags?l.push({key:-1,text:`+ ${p}`,closable:!1,isCollapseTag:!0}):a.forEach(d=>l.push(H(d))))}E.value=l},"calculatePresentTags"),ae=o(()=>{var t,l;const{filterMethod:n,showAllLevels:a,separator:p}=s,d=(l=(t=u.value)==null?void 0:t.getFlattedNodes(!s.props.checkStrictly))==null?void 0:l.filter(f=>f.isDisabled?!1:(f.calcText(a,p),n(f,ne.value)));g.value&&(E.value.forEach(f=>{f.hitState=!1}),M.value.forEach(f=>{f.hitState=!1})),m.value=!0,F.value=d,T()},"calculateSuggestions"),Ve=o(()=>{var t;let l;m.value&&V.value?l=V.value.$el.querySelector(`.${r.e("suggestion-item")}`):l=(t=u.value)==null?void 0:t.$el.querySelector(`.${r.b("node")}[tabindex="-1"]`),l&&(l.focus(),!m.value&&l.click())},"focusFirstNode"),R=o(()=>{var t,l;const n=(t=w.value)==null?void 0:t.input,a=Z.value,p=(l=V.value)==null?void 0:l.$el;if(!(!Qe.isClient||!n)){if(p){const d=p.querySelector(`.${r.e("suggestion-list")}`);d.style.minWidth=`${n.offsetWidth}px`}if(a){const{offsetHeight:d}=a,f=E.value.length>0?`${Math.max(d+6,y)}px`:`${y}px`;n.style.height=f,T()}}},"updateStyle"),Ne=o(t=>{var l;return(l=u.value)==null?void 0:l.getCheckedNodes(t)},"getCheckedNodes"),Be=o(t=>{T(),v("expandChange",t)},"handleExpandChange"),_e=o(t=>{if(!Y.value)switch(t.code){case C.EVENT_CODE.enter:c();break;case C.EVENT_CODE.down:c(!0),e.nextTick(Ve),t.preventDefault();break;case C.EVENT_CODE.esc:i.value===!0&&(t.preventDefault(),t.stopPropagation(),c(!1));break;case C.EVENT_CODE.tab:c(!1);break}},"handleKeyDown"),$e=o(()=>{var t;(t=u.value)==null||t.clearCheckedNodes(),!i.value&&s.filterable&&U(),c(!1),v("clear")},"handleClear"),U=o(()=>{const{value:t}=O;N.value=t,k.value=t},"syncPresentTextValue"),Se=o(t=>{var l,n;const{checked:a}=t;g.value?(l=u.value)==null||l.handleCheckChange(t,!a,!1):(!a&&((n=u.value)==null||n.handleCheckChange(t,!0,!1)),c(!1))},"handleSuggestionClick"),De=o(t=>{const l=t.target,{code:n}=t;switch(n){case C.EVENT_CODE.up:case C.EVENT_CODE.down:{const a=n===C.EVENT_CODE.up?-1:1;me.focusNode(me.getSibling(l,a,`.${r.e("suggestion-item")}[tabindex="-1"]`));break}case C.EVENT_CODE.enter:l.click();break}},"handleSuggestionKeyDown"),qe=o(()=>{const t=E.value,l=t[t.length-1];D=k.value?0:D+1,!(!l||!D||s.collapseTags&&t.length>1)&&(l.hitState?L(l):l.hitState=!0)},"handleDelete"),se=o(t=>{const l=t.target,n=r.e("search-input");l.className===n&&(I.value=!0),v("focus",t)},"handleFocus"),re=o(t=>{I.value=!1,v("blur",t)},"handleBlur"),Pe=Je.default(()=>{const{value:t}=ne;if(!t)return;const l=s.beforeFilter(t);Ie.isPromise(l)?l.then(ae).catch(()=>{}):l!==!1?ae():A()},s.debounce),W=o((t,l)=>{!i.value&&c(!0),!(l!=null&&l.isComposing)&&(t?Pe():A())},"handleInput"),ce=o(t=>Number.parseFloat(ue.useCssVar(q.cssVarName("input-height"),t).value)-2,"getInputInnerHeight");return e.watch(m,T),e.watch([_,h,()=>s.collapseTags],xe),e.watch(E,()=>{e.nextTick(()=>R())}),e.watch(B,async()=>{await e.nextTick();const t=w.value.input;y=ce(t)||y,R()}),e.watch(O,U,{immediate:!0}),e.onMounted(()=>{const t=w.value.input,l=ce(t);y=t.offsetHeight||l,ue.useResizeObserver(t,R)}),S({getCheckedNodes:Ne,cascaderPanelRef:u,togglePopperVisible:c,contentRef:oe}),(t,l)=>(e.openBlock(),e.createBlock(e.unref(ie.ElTooltip),{ref_key:"tooltipRef",ref:P,visible:i.value,teleported:t.teleported,"popper-class":[e.unref(r).e("dropdown"),t.popperClass],"popper-options":he,"fallback-placements":t.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:t.placement,transition:`${e.unref(r).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:t.persistent,onHide:A},{default:e.withCtx(()=>[e.withDirectives((e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(ye)),style:e.normalizeStyle(e.unref(Ce)),onClick:o(()=>c(e.unref(le)?void 0:!0),"onClick"),onKeydown:_e,onMouseenter:o(n=>z.value=!0,"onMouseenter"),onMouseleave:o(n=>z.value=!1,"onMouseleave")},[e.createVNode(e.unref(Fe.ElInput),{ref_key:"input",ref:w,modelValue:N.value,"onUpdate:modelValue":o(n=>N.value=n,"onUpdate:modelValue"),placeholder:e.unref(ke),readonly:e.unref(le),disabled:e.unref(h),"validate-event":!1,size:e.unref(B),class:e.normalizeClass(e.unref(Te)),tabindex:e.unref(g)&&t.filterable&&!e.unref(h)?-1:void 0,onCompositionstart:e.unref(b),onCompositionupdate:e.unref(b),onCompositionend:e.unref(b),onFocus:se,onBlur:re,onInput:W},{suffix:e.withCtx(()=>[e.unref(Ee)?(e.openBlock(),e.createBlock(e.unref(j.ElIcon),{key:"clear",class:e.normalizeClass([e.unref(q).e("icon"),"icon-circle-close"]),onClick:e.withModifiers($e,["stop"])},{default:e.withCtx(()=>[e.createVNode(e.unref(G.CircleClose))]),_:1},8,["class","onClick"])):(e.openBlock(),e.createBlock(e.unref(j.ElIcon),{key:"arrow-down",class:e.normalizeClass(e.unref(we)),onClick:e.withModifiers(n=>c(),["stop"])},{default:e.withCtx(()=>[e.createVNode(e.unref(G.ArrowDown))]),_:1},8,["class","onClick"]))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),e.unref(g)?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"tagWrapper",ref:Z,class:e.normalizeClass([e.unref(r).e("tags"),e.unref(r).is("validate",!!e.unref(be))])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E.value,n=>(e.openBlock(),e.createBlock(e.unref(de.ElTag),{key:n.key,type:t.tagType,size:e.unref(te),effect:t.tagEffect,hit:n.hitState,closable:n.closable,"disable-transitions":"",onClose:o(a=>L(n),"onClose")},{default:e.withCtx(()=>[n.isCollapseTag===!1?(e.openBlock(),e.createElementBlock("span",{key:0},e.toDisplayString(n.text),1)):(e.openBlock(),e.createBlock(e.unref(ie.ElTooltip),{key:1,disabled:i.value||!t.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:e.withCtx(()=>[e.createElementVNode("span",null,e.toDisplayString(n.text),1)]),content:e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(e.unref(r).e("collapse-tags"))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(M.value.slice(t.maxCollapseTags),(a,p)=>(e.openBlock(),e.createElementBlock("div",{key:p,class:e.normalizeClass(e.unref(r).e("collapse-tag"))},[(e.openBlock(),e.createBlock(e.unref(de.ElTag),{key:a.key,class:"in-tooltip",type:t.tagType,size:e.unref(te),effect:t.tagEffect,hit:a.hitState,closable:a.closable,"disable-transitions":"",onClose:o(d=>L(a),"onClose")},{default:e.withCtx(()=>[e.createElementVNode("span",null,e.toDisplayString(a.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),t.filterable&&!e.unref(h)?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,"onUpdate:modelValue":o(n=>k.value=n,"onUpdate:modelValue"),type:"text",class:e.normalizeClass(e.unref(r).e("search-input")),placeholder:e.unref(O)?"":e.unref(ee),onInput:o(n=>W(k.value,n),"onInput"),onClick:e.withModifiers(n=>c(!0),["stop"]),onKeydown:e.withKeys(qe,["delete"]),onCompositionstart:e.unref(b),onCompositionupdate:e.unref(b),onCompositionend:e.unref(b),onFocus:se,onBlur:re},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[e.vModelText,k.value]]):e.createCommentVNode("v-if",!0)],2)):e.createCommentVNode("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[e.unref(je.default),()=>c(!1),e.unref(oe)]])]),content:e.withCtx(()=>[e.withDirectives(e.createVNode(e.unref(Me.ElCascaderPanel),{ref_key:"cascaderPanelRef",ref:u,modelValue:e.unref(K),"onUpdate:modelValue":o(n=>e.isRef(K)?K.value=n:null,"onUpdate:modelValue"),options:t.options,props:s.props,border:!1,"render-label":t.$slots.default,onExpandChange:Be,onClose:o(n=>t.$nextTick(()=>c(!1)),"onClose")},null,8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[e.vShow,!m.value]]),t.filterable?e.withDirectives((e.openBlock(),e.createBlock(e.unref(Oe.ElScrollbar),{key:0,ref_key:"suggestionPanel",ref:V,tag:"ul",class:e.normalizeClass(e.unref(r).e("suggestion-panel")),"view-class":e.unref(r).e("suggestion-list"),onKeydown:De},{default:e.withCtx(()=>[F.value.length?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(F.value,n=>(e.openBlock(),e.createElementBlock("li",{key:n.uid,class:e.normalizeClass([e.unref(r).e("suggestion-item"),e.unref(r).is("checked",n.checked)]),tabindex:-1,onClick:o(a=>Se(n),"onClick")},[e.createElementVNode("span",null,e.toDisplayString(n.text),1),n.checked?(e.openBlock(),e.createBlock(e.unref(j.ElIcon),{key:0},{default:e.withCtx(()=>[e.createVNode(e.unref(G.Check))]),_:1})):e.createCommentVNode("v-if",!0)],10,["onClick"]))),128)):e.renderSlot(t.$slots,"empty",{key:1},()=>[e.createElementVNode("li",{class:e.normalizeClass(e.unref(r).e("empty-text"))},e.toDisplayString(e.unref(Q)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[e.vShow,m.value]]):e.createCommentVNode("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var et=Ke.default(Ze,[["__file","cascader.vue"]]);exports.default=et;
