"use strict";var I=Object.defineProperty;var s=(f,m)=>I(f,"name",{value:m,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const y=require("vue"),O=require("../../tokens/index.cjs"),c=require("../../../../../utils/dom/style/index.cjs"),R=require("../../../../../utils/types/index.cjs"),k=require("../../../../../../../../../@vueuse_shared@9.13.0_vue@3.5.13_typescript@5.5.4_/node_modules/@vueuse/shared/index/index.cjs");function N(f,m){const P=y.getCurrentInstance(),i=y.inject(O.TABLE_INJECTION_KEY),M=s(t=>{t.stopPropagation()},"handleFilterClick"),q=s((t,e)=>{!e.filters&&e.sortable?E(t,e,!1):e.filterable&&!e.sortable&&M(t),i==null||i.emit("header-click",e,t)},"handleHeaderClick"),S=s((t,e)=>{i==null||i.emit("header-contextmenu",e,t)},"handleHeaderContextMenu"),L=y.ref(null),C=y.ref(!1),g=y.ref({}),T=s((t,e)=>{if(k.isClient&&!(e.children&&e.children.length>0)&&L.value&&f.border){C.value=!0;const r=i;m("set-drag-visible",!0);const n=(r==null?void 0:r.vnode.el).getBoundingClientRect().left,l=P.vnode.el.querySelector(`th.${e.id}`),b=l.getBoundingClientRect(),u=b.left-n+30;c.addClass(l,"noclick"),g.value={startMouseLeft:t.clientX,startLeft:b.right-n,startColumnLeft:b.left-n,tableLeft:n};const v=r==null?void 0:r.refs.resizeProxy;v.style.left=`${g.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const h=s(d=>{const p=d.clientX-g.value.startMouseLeft,x=g.value.startLeft+p;v.style.left=`${Math.max(u,x)}px`},"handleMouseMove2"),a=s(()=>{if(C.value){const{startColumnLeft:d,startLeft:p}=g.value,B=Number.parseInt(v.style.left,10)-d;e.width=e.realWidth=B,r==null||r.emit("header-dragend",e.width,p-d,e,t),requestAnimationFrame(()=>{f.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",C.value=!1,L.value=null,g.value={},m("set-drag-visible",!1)}document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",a),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{c.removeClass(l,"noclick")},0)},"handleMouseUp");document.addEventListener("mousemove",h),document.addEventListener("mouseup",a)}},"handleMouseDown"),z=s((t,e)=>{if(e.children&&e.children.length>0)return;const r=t.target;if(!R.isElement(r))return;const o=r==null?void 0:r.closest("th");if(!(!e||!e.resizable)&&!C.value&&f.border){const n=o.getBoundingClientRect(),l=document.body.style;n.width>12&&n.right-t.pageX<8?(l.cursor="col-resize",c.hasClass(o,"is-sortable")&&(o.style.cursor="col-resize"),L.value=e):C.value||(l.cursor="",c.hasClass(o,"is-sortable")&&(o.style.cursor="pointer"),L.value=null)}},"handleMouseMove"),_=s(()=>{k.isClient&&(document.body.style.cursor="")},"handleMouseOut"),w=s(({order:t,sortOrders:e})=>{if(t==="")return e[0];const r=e.indexOf(t||null);return e[r>e.length-2?0:r+1]},"toggleOrder"),E=s((t,e,r)=>{var o;t.stopPropagation();const n=e.order===r?null:r||w(e),l=(o=t.target)==null?void 0:o.closest("th");if(l&&c.hasClass(l,"noclick")){c.removeClass(l,"noclick");return}if(!e.sortable)return;const b=t.currentTarget;if(["ascending","descending"].some(d=>c.hasClass(b,d)&&!e.sortOrders.includes(d)))return;const u=f.store.states;let v=u.sortProp.value,h;const a=u.sortingColumn.value;(a!==e||a===e&&a.order===null)&&(a&&(a.order=null),u.sortingColumn.value=e,v=e.property),n?h=e.order=n:h=e.order=null,u.sortProp.value=v,u.sortOrder.value=h,i==null||i.store.commit("changeSortCondition")},"handleSortClick");return{handleHeaderClick:q,handleHeaderContextMenu:S,handleMouseDown:T,handleMouseMove:z,handleMouseOut:_,handleSortClick:E,handleFilterClick:M}}s(N,"useEvent");exports.default=N;
