"use strict";var S=Object.defineProperty;var a=(e,C)=>S(e,"name",{value:C,configurable:!0});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const n=require("vue"),b=require("../../../../../../../../@vue_shared@3.5.13/node_modules/@vue/shared/dist/shared.esm-bundler/index.cjs"),M=require("../../../collapse-transition/index/index.cjs"),$=require("../../../checkbox/index/index.cjs"),V=require("../../../icon/index/index.cjs"),E=require("@element-plus/icons-vue"),I=require("../tree-node-content/index.cjs"),D=require("../model/util/index.cjs"),T=require("../model/useNodeExpandEventBroadcast/index.cjs"),O=require("../model/useDragNode/index.cjs"),x=require("../model/node/index.cjs"),L=require("../../../../_virtual/plugin-vue_export-helper/index.cjs"),R=require("../../../../hooks/use-namespace/index/index.cjs"),z=require("../../../../utils/error/index.cjs"),j=n.defineComponent({name:"ElTreeNode",components:{ElCollapseTransition:M.ElCollapseTransition,ElCheckbox:$.ElCheckbox,NodeContent:I.default,ElIcon:V.ElIcon,Loading:E.Loading},props:{node:{type:x.default,default:a(()=>({}),"default")},props:{type:Object,default:a(()=>({}),"default")},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,C){const f=R.useNamespace("tree"),{broadcastExpanded:m}=T.useNodeExpandEventBroadcast(e),d=n.inject("RootTree"),s=n.ref(!1),i=n.ref(!1),c=n.ref(null),h=n.ref(null),p=n.ref(null),u=n.inject(O.dragEventsKey),l=n.getCurrentInstance();n.provide("NodeInstance",l),d||z.debugWarn("Tree","Can not find node's tree."),e.node.expanded&&(s.value=!0,i.value=!0);const g=d.props.props.children||"children";n.watch(()=>{const o=e.node.data[g];return o&&[...o]},()=>{e.node.updateChildren()}),n.watch(()=>e.node.indeterminate,o=>{k(e.node.checked,o)}),n.watch(()=>e.node.checked,o=>{k(o,e.node.indeterminate)}),n.watch(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),n.watch(()=>e.node.expanded,o=>{n.nextTick(()=>s.value=o),o&&(i.value=!0)});const y=a(o=>D.getNodeKey(d.props.nodeKey,o.data),"getNodeKey$1"),w=a(o=>{const t=e.props.class;if(!t)return{};let r;if(b.isFunction(t)){const{data:K}=o;r=t(K,o)}else r=t;return b.isString(r)?{[r]:!0}:r},"getNodeClass"),k=a((o,t)=>{(c.value!==o||h.value!==t)&&d.ctx.emit("check-change",e.node.data,o,t),c.value=o,h.value=t},"handleSelectChange"),B=a(o=>{D.handleCurrentChange(d.store,d.ctx.emit,()=>d.store.value.setCurrentNode(e.node)),d.currentNode.value=e.node,d.props.expandOnClickNode&&v(),d.props.checkOnClickNode&&!e.node.disabled&&N(null,{target:{checked:!e.node.checked}}),d.ctx.emit("node-click",e.node.data,e.node,l,o)},"handleClick"),q=a(o=>{d.instance.vnode.props.onNodeContextmenu&&(o.stopPropagation(),o.preventDefault()),d.ctx.emit("node-contextmenu",o,e.node.data,e.node,l)},"handleContextMenu"),v=a(()=>{e.node.isLeaf||(s.value?(d.ctx.emit("node-collapse",e.node.data,e.node,l),e.node.collapse()):(e.node.expand(),C.emit("node-expand",e.node.data,e.node,l)))},"handleExpandIconClick"),N=a((o,t)=>{e.node.setChecked(t.target.checked,!d.props.checkStrictly),n.nextTick(()=>{const r=d.store.value;d.ctx.emit("check",e.node.data,{checkedNodes:r.getCheckedNodes(),checkedKeys:r.getCheckedKeys(),halfCheckedNodes:r.getHalfCheckedNodes(),halfCheckedKeys:r.getHalfCheckedKeys()})})},"handleCheckChange");return{ns:f,node$:p,tree:d,expanded:s,childNodeRendered:i,oldChecked:c,oldIndeterminate:h,getNodeKey:y,getNodeClass:w,handleSelectChange:k,handleClick:B,handleContextMenu:q,handleExpandIconClick:v,handleCheckChange:N,handleChildNodeExpand:a((o,t,r)=>{m(t),d.ctx.emit("node-expand",o,t,r)},"handleChildNodeExpand"),handleDragStart:a(o=>{d.props.draggable&&u.treeNodeDragStart({event:o,treeNode:e})},"handleDragStart"),handleDragOver:a(o=>{o.preventDefault(),d.props.draggable&&u.treeNodeDragOver({event:o,treeNode:{$el:p.value,node:e.node}})},"handleDragOver"),handleDrop:a(o=>{o.preventDefault()},"handleDrop"),handleDragEnd:a(o=>{d.props.draggable&&u.treeNodeDragEnd(o)},"handleDragEnd"),CaretRight:E.CaretRight}}});function F(e,C,f,m,d,s){const i=n.resolveComponent("el-icon"),c=n.resolveComponent("el-checkbox"),h=n.resolveComponent("loading"),p=n.resolveComponent("node-content"),u=n.resolveComponent("el-tree-node"),l=n.resolveComponent("el-collapse-transition");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{ref:"node$",class:n.normalizeClass([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:n.withModifiers(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:n.withModifiers(e.handleDragStart,["stop"]),onDragover:n.withModifiers(e.handleDragOver,["stop"]),onDragend:n.withModifiers(e.handleDragEnd,["stop"]),onDrop:n.withModifiers(e.handleDrop,["stop"])},[n.createElementVNode("div",{class:n.normalizeClass(e.ns.be("node","content")),style:n.normalizeStyle({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(n.openBlock(),n.createBlock(i,{key:0,class:n.normalizeClass([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:n.withModifiers(e.handleExpandIconClick,["stop"])},{default:n.withCtx(()=>[(n.openBlock(),n.createBlock(n.resolveDynamicComponent(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):n.createCommentVNode("v-if",!0),e.showCheckbox?(n.openBlock(),n.createBlock(c,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:n.withModifiers(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):n.createCommentVNode("v-if",!0),e.node.loading?(n.openBlock(),n.createBlock(i,{key:2,class:n.normalizeClass([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:n.withCtx(()=>[n.createVNode(h)]),_:1},8,["class"])):n.createCommentVNode("v-if",!0),n.createVNode(p,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),n.createVNode(l,null,{default:n.withCtx(()=>[!e.renderAfterExpand||e.childNodeRendered?n.withDirectives((n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(e.node.childNodes,g=>(n.openBlock(),n.createBlock(u,{key:e.getNodeKey(g),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:g,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[n.vShow,e.expanded]]):n.createCommentVNode("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[n.vShow,e.node.visible]])}a(F,"_sfc_render");var A=L.default(j,[["render",F],["__file","tree-node.vue"]]);exports.default=A;
